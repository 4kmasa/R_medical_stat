<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>39 R语言多项式拟合及样条回归 | R语言实战医学统计</title>
  <meta name="description" content="39 R语言多项式拟合及样条回归 | R语言实战医学统计" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="39 R语言多项式拟合及样条回归 | R语言实战医学统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="39 R语言多项式拟合及样条回归 | R语言实战医学统计" />
  <meta name="github-repo" content="ayueme/ayueme.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="39 R语言多项式拟合及样条回归 | R语言实战医学统计" />
  
  <meta name="twitter:description" content="39 R语言多项式拟合及样条回归 | R语言实战医学统计" />
  

<meta name="author" content="阿越就是我" />


<meta name="date" content="2023-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1038-p4trend.html"/>
<link rel="next" href="1040-appendix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R语言实战医学统计</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本书缘起"><i class="fa fa-check"></i>本书缘起</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#作者简介"><i class="fa fa-check"></i>作者简介</a></li>
</ul></li>
<li class="part"><span><b>I 基础统计分析</b></span></li>
<li class="chapter" data-level="1" data-path="1001-ttest.html"><a href="1001-ttest.html"><i class="fa fa-check"></i><b>1</b> t检验</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1001-ttest.html"><a href="1001-ttest.html#单样本t检验"><i class="fa fa-check"></i><b>1.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="1.2" data-path="1001-ttest.html"><a href="1001-ttest.html#配对样本t检验"><i class="fa fa-check"></i><b>1.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="1.3" data-path="1001-ttest.html"><a href="1001-ttest.html#两样本t检验"><i class="fa fa-check"></i><b>1.3</b> 两样本t检验</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="1002-anova.html"><a href="1002-anova.html"><i class="fa fa-check"></i><b>2</b> 多样本均数比较的方差分析</a>
<ul>
<li class="chapter" data-level="2.1" data-path="1002-anova.html"><a href="1002-anova.html#完全随机设计资料的方差分析"><i class="fa fa-check"></i><b>2.1</b> 完全随机设计资料的方差分析</a></li>
<li class="chapter" data-level="2.2" data-path="1002-anova.html"><a href="1002-anova.html#随机区组设计资料的方差分析"><i class="fa fa-check"></i><b>2.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="2.3" data-path="1002-anova.html"><a href="1002-anova.html#拉丁方设计方差分析"><i class="fa fa-check"></i><b>2.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="2.4" data-path="1002-anova.html"><a href="1002-anova.html#两阶段交叉设计资料方差分析"><i class="fa fa-check"></i><b>2.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="2.5" data-path="1002-anova.html"><a href="1002-anova.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>2.5</b> 多个样本均数间的多重比较</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="1002-anova.html"><a href="1002-anova.html#lsd-t检验"><i class="fa fa-check"></i><b>2.5.1</b> LSD-t检验</a></li>
<li class="chapter" data-level="2.5.2" data-path="1002-anova.html"><a href="1002-anova.html#tukeyhsd"><i class="fa fa-check"></i><b>2.5.2</b> TukeyHSD</a></li>
<li class="chapter" data-level="2.5.3" data-path="1002-anova.html"><a href="1002-anova.html#dunnett-t检验"><i class="fa fa-check"></i><b>2.5.3</b> Dunnett-t检验</a></li>
<li class="chapter" data-level="2.5.4" data-path="1002-anova.html"><a href="1002-anova.html#snk-q检验"><i class="fa fa-check"></i><b>2.5.4</b> SNK-q检验</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的bartlett检验和levene检验"><i class="fa fa-check"></i><b>2.6</b> 多样本方差比较的Bartlett检验和Levene检验</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的bartlett检验"><i class="fa fa-check"></i><b>2.6.1</b> 多样本方差比较的Bartlett检验</a></li>
<li class="chapter" data-level="2.6.2" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的levene检验"><i class="fa fa-check"></i><b>2.6.2</b> 多样本方差比较的Levene检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="1003-dysanova.html"><a href="1003-dysanova.html"><i class="fa fa-check"></i><b>3</b> 多因素方差分析</a>
<ul>
<li class="chapter" data-level="3.1" data-path="1003-dysanova.html"><a href="1003-dysanova.html#x-2-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.1</b> 2 x 2 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.2" data-path="1003-dysanova.html"><a href="1003-dysanova.html#i-x-j-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.2</b> I x J 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.3" data-path="1003-dysanova.html"><a href="1003-dysanova.html#i-x-j-x-k-三因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.3</b> I x J x K 三因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.4" data-path="1003-dysanova.html"><a href="1003-dysanova.html#正交设计资料的方差分析"><i class="fa fa-check"></i><b>3.4</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="3.5" data-path="1003-dysanova.html"><a href="1003-dysanova.html#嵌套设计资料的方差分析"><i class="fa fa-check"></i><b>3.5</b> 嵌套设计资料的方差分析</a></li>
<li class="chapter" data-level="3.6" data-path="1003-dysanova.html"><a href="1003-dysanova.html#裂区设计资料的方差分析"><i class="fa fa-check"></i><b>3.6</b> 裂区设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html"><i class="fa fa-check"></i><b>4</b> 重复测量方差分析</a>
<ul>
<li class="chapter" data-level="4.1" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据两因素两水平的方差分析"><i class="fa fa-check"></i><b>4.1</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="4.2" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据两因素多水平的分析"><i class="fa fa-check"></i><b>4.2</b> 重复测量数据两因素多水平的分析</a></li>
<li class="chapter" data-level="4.3" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据的多重比较"><i class="fa fa-check"></i><b>4.3</b> 重复测量数据的多重比较</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#组间差别多重比较"><i class="fa fa-check"></i><b>4.3.1</b> 组间差别多重比较</a></li>
<li class="chapter" data-level="4.3.2" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#时间趋势比较"><i class="fa fa-check"></i><b>4.3.2</b> 时间趋势比较</a></li>
<li class="chapter" data-level="4.3.3" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#时间点比较"><i class="fa fa-check"></i><b>4.3.3</b> 时间点比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="1005-ancova.html"><a href="1005-ancova.html"><i class="fa fa-check"></i><b>5</b> 协方差分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="1005-ancova.html"><a href="1005-ancova.html#完全随机设计资料的协方差分析"><i class="fa fa-check"></i><b>5.1</b> 完全随机设计资料的协方差分析</a></li>
<li class="chapter" data-level="5.2" data-path="1005-ancova.html"><a href="1005-ancova.html#使用rstatix进行优雅的协方差分析"><i class="fa fa-check"></i><b>5.2</b> 使用rstatix进行优雅的协方差分析</a></li>
<li class="chapter" data-level="5.3" data-path="1005-ancova.html"><a href="1005-ancova.html#随机区组设计资料的协方差分析"><i class="fa fa-check"></i><b>5.3</b> 随机区组设计资料的协方差分析</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="1006-chisq.html"><a href="1006-chisq.html"><i class="fa fa-check"></i><b>6</b> 卡方检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="1006-chisq.html"><a href="1006-chisq.html#不同类型卡方检验的选择"><i class="fa fa-check"></i><b>6.1</b> 不同类型卡方检验的选择</a></li>
<li class="chapter" data-level="6.2" data-path="1006-chisq.html"><a href="1006-chisq.html#四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.2</b> 四格表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="1006-chisq.html"><a href="1006-chisq.html#方法1"><i class="fa fa-check"></i><b>6.2.1</b> 方法1</a></li>
<li class="chapter" data-level="6.2.2" data-path="1006-chisq.html"><a href="1006-chisq.html#方法2"><i class="fa fa-check"></i><b>6.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="1006-chisq.html"><a href="1006-chisq.html#配对四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.3</b> 配对四格表资料的卡方检验</a></li>
<li class="chapter" data-level="6.4" data-path="1006-chisq.html"><a href="1006-chisq.html#四格表资料的-fisher-确切概率法"><i class="fa fa-check"></i><b>6.4</b> 四格表资料的 Fisher 确切概率法</a></li>
<li class="chapter" data-level="6.5" data-path="1006-chisq.html"><a href="1006-chisq.html#行-x-列表资料的卡方检验"><i class="fa fa-check"></i><b>6.5</b> 行 x 列表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="1006-chisq.html"><a href="1006-chisq.html#多个样本率的比较"><i class="fa fa-check"></i><b>6.5.1</b> 多个样本率的比较</a></li>
<li class="chapter" data-level="6.5.2" data-path="1006-chisq.html"><a href="1006-chisq.html#样本构成比的比较"><i class="fa fa-check"></i><b>6.5.2</b> 样本构成比的比较</a></li>
<li class="chapter" data-level="6.5.3" data-path="1006-chisq.html"><a href="1006-chisq.html#双向无序分类资料的关联性检验"><i class="fa fa-check"></i><b>6.5.3</b> 双向无序分类资料的关联性检验</a></li>
<li class="chapter" data-level="6.5.4" data-path="1006-chisq.html"><a href="1006-chisq.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>6.5.4</b> 双向有序分组资料的线性趋势检验</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="1006-chisq.html"><a href="1006-chisq.html#多个样本率间的多重比较"><i class="fa fa-check"></i><b>6.6</b> 多个样本率间的多重比较</a></li>
<li class="chapter" data-level="6.7" data-path="1006-chisq.html"><a href="1006-chisq.html#cochran-mantel-haenszel-卡方统计量检验"><i class="fa fa-check"></i><b>6.7</b> Cochran-Mantel-Haenszel 卡方统计量检验</a></li>
<li class="chapter" data-level="6.8" data-path="1006-chisq.html"><a href="1006-chisq.html#频数分布拟合优度卡方检验"><i class="fa fa-check"></i><b>6.8</b> 频数分布拟合优度卡方检验</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html"><i class="fa fa-check"></i><b>7</b> 秩和检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#配对样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.1</b> 配对样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#两独立样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.2</b> 两独立样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.3" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#完全随机设计多个样本比较的-kruskal-wallis-h-检验"><i class="fa fa-check"></i><b>7.3</b> 完全随机设计多个样本比较的 Kruskal-Wallis H 检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多样本比较的kruskal-wallis-h检验"><i class="fa fa-check"></i><b>7.3.1</b> 多样本比较的kruskal-wallis H检验</a></li>
<li class="chapter" data-level="7.3.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#kruskal-wallis-h检验后的多重比较"><i class="fa fa-check"></i><b>7.3.2</b> kruskal-Wallis H检验后的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#随记区组设计多个样本比较的-friedman-m-检验"><i class="fa fa-check"></i><b>7.4</b> 随记区组设计多个样本比较的 Friedman M 检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多个相关样本比较的friedman-m检验"><i class="fa fa-check"></i><b>7.4.1</b> 多个相关样本比较的Friedman M检验</a></li>
<li class="chapter" data-level="7.4.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多个相关样本两两比较的q检验"><i class="fa fa-check"></i><b>7.4.2</b> 多个相关样本两两比较的q检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html"><i class="fa fa-check"></i><b>8</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#球对称检验"><i class="fa fa-check"></i><b>8.1</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#使用课本表12-3的数据"><i class="fa fa-check"></i><b>8.1.1</b> 使用课本<strong>表12-3</strong>的数据</a></li>
<li class="chapter" data-level="8.1.2" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#使用课本例12-3的数据"><i class="fa fa-check"></i><b>8.1.2</b> 使用课本<strong>例12-3</strong>的数据</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="1009-cochranarmitage.html"><a href="1009-cochranarmitage.html"><i class="fa fa-check"></i><b>9</b> R语言Cochran Armitage检验</a></li>
<li class="chapter" data-level="10" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html"><i class="fa fa-check"></i><b>10</b> R语言方差分析注意事项</a>
<ul>
<li class="chapter" data-level="10.1" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#均衡设计和非均衡设计"><i class="fa fa-check"></i><b>10.1</b> 均衡设计和非均衡设计</a></li>
<li class="chapter" data-level="10.2" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#方差分析的3种类型"><i class="fa fa-check"></i><b>10.2</b> 方差分析的3种类型</a></li>
<li class="chapter" data-level="10.3" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#示例"><i class="fa fa-check"></i><b>10.3</b> 示例</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#one-way-anova"><i class="fa fa-check"></i><b>10.3.1</b> one-way anova</a></li>
<li class="chapter" data-level="10.3.2" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#two-way-anova"><i class="fa fa-check"></i><b>10.3.2</b> two-way anova</a></li>
<li class="chapter" data-level="10.3.3" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#协方差分析"><i class="fa fa-check"></i><b>10.3.3</b> 协方差分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="1011-samplesize.html"><a href="1011-samplesize.html"><i class="fa fa-check"></i><b>11</b> 样本量计算</a>
<ul>
<li class="chapter" data-level="11.1" data-path="1011-samplesize.html"><a href="1011-samplesize.html#t检验的样本量计算"><i class="fa fa-check"></i><b>11.1</b> t检验的样本量计算</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="1011-samplesize.html"><a href="1011-samplesize.html#单样本t检验样本均数和已知总体均数比较"><i class="fa fa-check"></i><b>11.1.1</b> 单样本t检验（样本均数和已知总体均数比较）</a></li>
<li class="chapter" data-level="11.1.2" data-path="1011-samplesize.html"><a href="1011-samplesize.html#两样本t检验两样本均数比较"><i class="fa fa-check"></i><b>11.1.2</b> 两样本t检验（两样本均数比较）</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="1011-samplesize.html"><a href="1011-samplesize.html#多样本均数比较"><i class="fa fa-check"></i><b>11.2</b> 多样本均数比较</a></li>
<li class="chapter" data-level="11.3" data-path="1011-samplesize.html"><a href="1011-samplesize.html#样本率和已知总体率的比较"><i class="fa fa-check"></i><b>11.3</b> 样本率和已知总体率的比较</a></li>
<li class="chapter" data-level="11.4" data-path="1011-samplesize.html"><a href="1011-samplesize.html#两独立样本率的比较"><i class="fa fa-check"></i><b>11.4</b> 两独立样本率的比较</a></li>
<li class="chapter" data-level="11.5" data-path="1011-samplesize.html"><a href="1011-samplesize.html#多样本率的比较"><i class="fa fa-check"></i><b>11.5</b> 多样本率的比较</a></li>
<li class="chapter" data-level="11.6" data-path="1011-samplesize.html"><a href="1011-samplesize.html#直线相关分析"><i class="fa fa-check"></i><b>11.6</b> 直线相关分析</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html"><i class="fa fa-check"></i><b>12</b> 随机分组</a>
<ul>
<li class="chapter" data-level="12.1" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#简单随机"><i class="fa fa-check"></i><b>12.1</b> 简单随机</a></li>
<li class="chapter" data-level="12.2" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#区组随机"><i class="fa fa-check"></i><b>12.2</b> 区组随机</a></li>
<li class="chapter" data-level="12.3" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#分层随机"><i class="fa fa-check"></i><b>12.3</b> 分层随机</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="1013-rstastix.html"><a href="1013-rstastix.html"><i class="fa fa-check"></i><b>13</b> R语言tidy风格医学统计学</a>
<ul>
<li class="chapter" data-level="13.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#主要函数"><i class="fa fa-check"></i><b>13.1</b> 主要函数</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#描述性统计"><i class="fa fa-check"></i><b>13.1.1</b> 描述性统计</a></li>
<li class="chapter" data-level="13.1.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较均值"><i class="fa fa-check"></i><b>13.1.2</b> 比较均值</a></li>
<li class="chapter" data-level="13.1.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#增强r中的anova"><i class="fa fa-check"></i><b>13.1.3</b> 增强R中的ANOVA</a></li>
<li class="chapter" data-level="13.1.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#事后检验post-hoc"><i class="fa fa-check"></i><b>13.1.4</b> 事后检验（post-hoc）</a></li>
<li class="chapter" data-level="13.1.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较比例"><i class="fa fa-check"></i><b>13.1.5</b> 比较比例</a></li>
<li class="chapter" data-level="13.1.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较方差"><i class="fa fa-check"></i><b>13.1.6</b> 比较方差</a></li>
<li class="chapter" data-level="13.1.7" data-path="1013-rstastix.html"><a href="1013-rstastix.html#计算效应量"><i class="fa fa-check"></i><b>13.1.7</b> 计算效应量</a></li>
<li class="chapter" data-level="13.1.8" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关性分析"><i class="fa fa-check"></i><b>13.1.8</b> 相关性分析</a></li>
<li class="chapter" data-level="13.1.9" data-path="1013-rstastix.html"><a href="1013-rstastix.html#添加p值和显著性标记"><i class="fa fa-check"></i><b>13.1.9</b> 添加P值和显著性标记</a></li>
<li class="chapter" data-level="13.1.10" data-path="1013-rstastix.html"><a href="1013-rstastix.html#提取统计信息"><i class="fa fa-check"></i><b>13.1.10</b> 提取统计信息</a></li>
<li class="chapter" data-level="13.1.11" data-path="1013-rstastix.html"><a href="1013-rstastix.html#数据处理辅助函数"><i class="fa fa-check"></i><b>13.1.11</b> 数据处理辅助函数</a></li>
<li class="chapter" data-level="13.1.12" data-path="1013-rstastix.html"><a href="1013-rstastix.html#其他"><i class="fa fa-check"></i><b>13.1.12</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#安装和加载"><i class="fa fa-check"></i><b>13.2</b> 安装和加载</a></li>
<li class="chapter" data-level="13.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#描述性统计-1"><i class="fa fa-check"></i><b>13.3</b> 描述性统计</a></li>
<li class="chapter" data-level="13.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#t检验"><i class="fa fa-check"></i><b>13.4</b> t检验</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#单样本t检验-1"><i class="fa fa-check"></i><b>13.4.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="13.4.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#配对t检验"><i class="fa fa-check"></i><b>13.4.2</b> 配对t检验</a></li>
<li class="chapter" data-level="13.4.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两样本t检验-1"><i class="fa fa-check"></i><b>13.4.3</b> 两样本t检验</a></li>
<li class="chapter" data-level="13.4.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#分组后进行比较"><i class="fa fa-check"></i><b>13.4.4</b> 分组后进行比较</a></li>
<li class="chapter" data-level="13.4.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#多组间的两两比较"><i class="fa fa-check"></i><b>13.4.5</b> 多组间的两两比较</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#方差分析"><i class="fa fa-check"></i><b>13.5</b> 方差分析</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#完全随机设计方差分析"><i class="fa fa-check"></i><b>13.5.1</b> 完全随机设计方差分析</a></li>
<li class="chapter" data-level="13.5.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#随机区组设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#拉丁方设计方差分析-1"><i class="fa fa-check"></i><b>13.5.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="13.5.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两阶段交叉设计资料方差分析-1"><i class="fa fa-check"></i><b>13.5.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="13.5.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#析因设计资料的方差分析"><i class="fa fa-check"></i><b>13.5.5</b> 析因设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#正交设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.6</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.7" data-path="1013-rstastix.html"><a href="1013-rstastix.html#重复测量数据两因素两水平的方差分析-1"><i class="fa fa-check"></i><b>13.5.7</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="13.5.8" data-path="1013-rstastix.html"><a href="1013-rstastix.html#重复测量数据两因素多水平的分析-1"><i class="fa fa-check"></i><b>13.5.8</b> 重复测量数据两因素多水平的分析</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关分析"><i class="fa fa-check"></i><b>13.6</b> 相关分析</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两个变量"><i class="fa fa-check"></i><b>13.6.1</b> 两个变量</a></li>
<li class="chapter" data-level="13.6.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#一个变量和其他所有变量"><i class="fa fa-check"></i><b>13.6.2</b> 一个变量和其他所有变量</a></li>
<li class="chapter" data-level="13.6.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#所有变量间两两相关性"><i class="fa fa-check"></i><b>13.6.3</b> 所有变量间两两相关性</a></li>
<li class="chapter" data-level="13.6.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关矩阵"><i class="fa fa-check"></i><b>13.6.4</b> 相关矩阵</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html"><i class="fa fa-check"></i><b>14</b> R语言多个变量同时进行t检验</a>
<ul>
<li class="chapter" data-level="14.1" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html#简介"><i class="fa fa-check"></i><b>14.1</b> 简介</a></li>
<li class="chapter" data-level="14.2" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html#实战"><i class="fa fa-check"></i><b>14.2</b> 实战</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="1015-twocorrelation.html"><a href="1015-twocorrelation.html"><i class="fa fa-check"></i><b>15</b> 双变量回归与相关</a>
<ul>
<li class="chapter" data-level="15.1" data-path="1015-twocorrelation.html"><a href="1015-twocorrelation.html#两样本相关"><i class="fa fa-check"></i><b>15.1</b> 两样本相关</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html"><i class="fa fa-check"></i><b>16</b> 偏相关和典型相关</a>
<ul>
<li class="chapter" data-level="16.1" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#偏相关partial-correlation"><i class="fa fa-check"></i><b>16.1</b> 偏相关（partial correlation）</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#偏相关散点图"><i class="fa fa-check"></i><b>16.1.1</b> 偏相关散点图</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#典型相关canonical-correlation"><i class="fa fa-check"></i><b>16.2</b> 典型相关（Canonical Correlation）</a></li>
</ul></li>
<li class="part"><span><b>II 高级统计分析</b></span></li>
<li class="chapter" data-level="17" data-path="1017-multiregression.html"><a href="1017-multiregression.html"><i class="fa fa-check"></i><b>17</b> 多元线性回归</a>
<ul>
<li class="chapter" data-level="17.1" data-path="1017-multiregression.html"><a href="1017-multiregression.html#多元线性回归"><i class="fa fa-check"></i><b>17.1</b> 多元线性回归</a></li>
<li class="chapter" data-level="17.2" data-path="1017-multiregression.html"><a href="1017-multiregression.html#回归诊断"><i class="fa fa-check"></i><b>17.2</b> 回归诊断</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="1017-multiregression.html"><a href="1017-multiregression.html#可以通过看图来判断"><i class="fa fa-check"></i><b>17.2.1</b> 可以通过看图来判断</a></li>
<li class="chapter" data-level="17.2.2" data-path="1017-multiregression.html"><a href="1017-multiregression.html#也可以通过统计方法验证"><i class="fa fa-check"></i><b>17.2.2</b> 也可以通过统计方法验证</a></li>
<li class="chapter" data-level="17.2.3" data-path="1017-multiregression.html"><a href="1017-multiregression.html#多重共线性的检验"><i class="fa fa-check"></i><b>17.2.3</b> 多重共线性的检验</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="1017-multiregression.html"><a href="1017-multiregression.html#逐步选择法"><i class="fa fa-check"></i><b>17.3</b> 逐步选择法</a></li>
<li class="chapter" data-level="17.4" data-path="1017-multiregression.html"><a href="1017-multiregression.html#全局择优法"><i class="fa fa-check"></i><b>17.4</b> 全局择优法</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="1018-logistic.html"><a href="1018-logistic.html"><i class="fa fa-check"></i><b>18</b> Logistic回归</a>
<ul>
<li class="chapter" data-level="18.1" data-path="1018-logistic.html"><a href="1018-logistic.html#二项logistic回归"><i class="fa fa-check"></i><b>18.1</b> 二项logistic回归</a></li>
<li class="chapter" data-level="18.2" data-path="1018-logistic.html"><a href="1018-logistic.html#多项逻辑回归"><i class="fa fa-check"></i><b>18.2</b> 多项逻辑回归</a></li>
<li class="chapter" data-level="18.3" data-path="1018-logistic.html"><a href="1018-logistic.html#有序逻辑回归"><i class="fa fa-check"></i><b>18.3</b> 有序逻辑回归</a></li>
<li class="chapter" data-level="18.4" data-path="1018-logistic.html"><a href="1018-logistic.html#条件逻辑回归"><i class="fa fa-check"></i><b>18.4</b> 条件逻辑回归</a></li>
<li class="chapter" data-level="18.5" data-path="1018-logistic.html"><a href="1018-logistic.html#参考资料"><i class="fa fa-check"></i><b>18.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html"><i class="fa fa-check"></i><b>19</b> 分类变量进行回归分析时的编码方案</a>
<ul>
<li class="chapter" data-level="19.1" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#演示数据"><i class="fa fa-check"></i><b>19.1</b> 演示数据</a></li>
<li class="chapter" data-level="19.2" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#dummy-coding"><i class="fa fa-check"></i><b>19.2</b> Dummy Coding</a></li>
<li class="chapter" data-level="19.3" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#simple-coding"><i class="fa fa-check"></i><b>19.3</b> simple coding</a></li>
<li class="chapter" data-level="19.4" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#deviation-coding"><i class="fa fa-check"></i><b>19.4</b> Deviation coding</a></li>
<li class="chapter" data-level="19.5" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#orthogonal-polynomial-coding"><i class="fa fa-check"></i><b>19.5</b> Orthogonal Polynomial Coding</a></li>
<li class="chapter" data-level="19.6" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#helmert-coding"><i class="fa fa-check"></i><b>19.6</b> Helmert Coding</a></li>
<li class="chapter" data-level="19.7" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#reverse-helmert-coding"><i class="fa fa-check"></i><b>19.7</b> Reverse Helmert Coding</a></li>
<li class="chapter" data-level="19.8" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#forward-difference-coding"><i class="fa fa-check"></i><b>19.8</b> Forward Difference Coding</a></li>
<li class="chapter" data-level="19.9" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#backward-difference-coding"><i class="fa fa-check"></i><b>19.9</b> Backward Difference Coding</a></li>
<li class="chapter" data-level="19.10" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#参考资料-1"><i class="fa fa-check"></i><b>19.10</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="1020-discriminant.html"><a href="1020-discriminant.html"><i class="fa fa-check"></i><b>20</b> R语言判别分析</a>
<ul>
<li class="chapter" data-level="20.1" data-path="1020-discriminant.html"><a href="1020-discriminant.html#fisher判别分析"><i class="fa fa-check"></i><b>20.1</b> Fisher判别分析</a></li>
<li class="chapter" data-level="20.2" data-path="1020-discriminant.html"><a href="1020-discriminant.html#bayes判别分析"><i class="fa fa-check"></i><b>20.2</b> Bayes判别分析</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="1021-cluster.html"><a href="1021-cluster.html"><i class="fa fa-check"></i><b>21</b> R语言聚类分析</a>
<ul>
<li class="chapter" data-level="21.1" data-path="1021-cluster.html"><a href="1021-cluster.html#系统聚类层次聚类hierarchical-clustering"><i class="fa fa-check"></i><b>21.1</b> 系统聚类（层次聚类,Hierarchical clustering）</a></li>
<li class="chapter" data-level="21.2" data-path="1021-cluster.html"><a href="1021-cluster.html#聚类分析可视化"><i class="fa fa-check"></i><b>21.2</b> 聚类分析可视化</a></li>
<li class="chapter" data-level="21.3" data-path="1021-cluster.html"><a href="1021-cluster.html#快速聚类划分聚类partitioning-clustering"><i class="fa fa-check"></i><b>21.3</b> 快速聚类（划分聚类,partitioning clustering）</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="1021-cluster.html"><a href="1021-cluster.html#k-means聚类"><i class="fa fa-check"></i><b>21.3.1</b> K-means聚类</a></li>
<li class="chapter" data-level="21.3.2" data-path="1021-cluster.html"><a href="1021-cluster.html#围绕中心点的划分pam"><i class="fa fa-check"></i><b>21.3.2</b> 围绕中心点的划分PAM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="1022-pca.html"><a href="1022-pca.html"><i class="fa fa-check"></i><b>22</b> R语言主成分分析</a>
<ul>
<li class="chapter" data-level="22.1" data-path="1022-pca.html"><a href="1022-pca.html#加载数据"><i class="fa fa-check"></i><b>22.1</b> 加载数据</a></li>
<li class="chapter" data-level="22.2" data-path="1022-pca.html"><a href="1022-pca.html#相关性检验"><i class="fa fa-check"></i><b>22.2</b> 相关性检验</a></li>
<li class="chapter" data-level="22.3" data-path="1022-pca.html"><a href="1022-pca.html#kmo和bartlett球形检验"><i class="fa fa-check"></i><b>22.3</b> KMO和Bartlett球形检验</a></li>
<li class="chapter" data-level="22.4" data-path="1022-pca.html"><a href="1022-pca.html#r自带的pca"><i class="fa fa-check"></i><b>22.4</b> R自带的PCA</a></li>
<li class="chapter" data-level="22.5" data-path="1022-pca.html"><a href="1022-pca.html#结果可视化"><i class="fa fa-check"></i><b>22.5</b> 结果可视化</a></li>
<li class="chapter" data-level="22.6" data-path="1022-pca.html"><a href="1022-pca.html#主成分分析可视化超详细"><i class="fa fa-check"></i><b>22.6</b> 主成分分析可视化(超详细)</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="1022-pca.html"><a href="1022-pca.html#进行pca分析"><i class="fa fa-check"></i><b>22.6.1</b> 进行PCA分析</a></li>
<li class="chapter" data-level="22.6.2" data-path="1022-pca.html"><a href="1022-pca.html#特征值可视化"><i class="fa fa-check"></i><b>22.6.2</b> 特征值可视化</a></li>
<li class="chapter" data-level="22.6.3" data-path="1022-pca.html"><a href="1022-pca.html#提取变量结果"><i class="fa fa-check"></i><b>22.6.3</b> 提取变量结果</a></li>
<li class="chapter" data-level="22.6.4" data-path="1022-pca.html"><a href="1022-pca.html#变量结果可视化"><i class="fa fa-check"></i><b>22.6.4</b> 变量结果可视化</a></li>
<li class="chapter" data-level="22.6.5" data-path="1022-pca.html"><a href="1022-pca.html#dimension-description"><i class="fa fa-check"></i><b>22.6.5</b> Dimension description</a></li>
<li class="chapter" data-level="22.6.6" data-path="1022-pca.html"><a href="1022-pca.html#提取样本结果"><i class="fa fa-check"></i><b>22.6.6</b> 提取样本结果</a></li>
<li class="chapter" data-level="22.6.7" data-path="1022-pca.html"><a href="1022-pca.html#样本结果可视化"><i class="fa fa-check"></i><b>22.6.7</b> 样本结果可视化</a></li>
<li class="chapter" data-level="22.6.8" data-path="1022-pca.html"><a href="1022-pca.html#biplot"><i class="fa fa-check"></i><b>22.6.8</b> biplot</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="1022-pca.html"><a href="1022-pca.html#主成分分析可视化3d版"><i class="fa fa-check"></i><b>22.7</b> 主成分分析可视化3d版</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="1022-pca.html"><a href="1022-pca.html#提取数据"><i class="fa fa-check"></i><b>22.7.1</b> 提取数据</a></li>
<li class="chapter" data-level="22.7.2" data-path="1022-pca.html"><a href="1022-pca.html#d版"><i class="fa fa-check"></i><b>22.7.2</b> 3d版</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html"><i class="fa fa-check"></i><b>23</b> R语言因子分析</a>
<ul>
<li class="chapter" data-level="23.1" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#演示数据-1"><i class="fa fa-check"></i><b>23.1</b> 演示数据</a></li>
<li class="chapter" data-level="23.2" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#判断需要提取的因子个数"><i class="fa fa-check"></i><b>23.2</b> 判断需要提取的因子个数</a></li>
<li class="chapter" data-level="23.3" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#进行因子分析"><i class="fa fa-check"></i><b>23.3</b> 进行因子分析</a></li>
<li class="chapter" data-level="23.4" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#因子旋转"><i class="fa fa-check"></i><b>23.4</b> 因子旋转</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html"><i class="fa fa-check"></i><b>24</b> 二分类资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="24.1" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法1-1"><i class="fa fa-check"></i><b>24.1</b> 方法1</a></li>
<li class="chapter" data-level="24.2" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法2-1"><i class="fa fa-check"></i><b>24.2</b> 方法2</a></li>
<li class="chapter" data-level="24.3" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法3"><i class="fa fa-check"></i><b>24.3</b> 方法3</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html"><i class="fa fa-check"></i><b>25</b> 生存资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="25.1" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#加载r包和数据"><i class="fa fa-check"></i><b>25.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="25.2" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#多个时间点roc"><i class="fa fa-check"></i><b>25.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="25.3" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#多指标roc"><i class="fa fa-check"></i><b>25.3</b> 多指标ROC</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html"><i class="fa fa-check"></i><b>26</b> 生存资料ROC曲线的最佳截点和平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#平滑曲线"><i class="fa fa-check"></i><b>26.1</b> 平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#加载r包和数据-1"><i class="fa fa-check"></i><b>26.1.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="26.1.2" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#多个时间点roc-1"><i class="fa fa-check"></i><b>26.1.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="26.1.3" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#画平滑曲线"><i class="fa fa-check"></i><b>26.1.3</b> 画平滑曲线</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#找最佳截点"><i class="fa fa-check"></i><b>26.2</b> 找最佳截点</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="1027-roccompare.html"><a href="1027-roccompare.html"><i class="fa fa-check"></i><b>27</b> ROC曲线的显著性检验</a>
<ul>
<li class="chapter" data-level="27.1" data-path="1027-roccompare.html"><a href="1027-roccompare.html#二分类资料的roc比较"><i class="fa fa-check"></i><b>27.1</b> 二分类资料的ROC比较</a></li>
<li class="chapter" data-level="27.2" data-path="1027-roccompare.html"><a href="1027-roccompare.html#生存资料roc的比较"><i class="fa fa-check"></i><b>27.2</b> 生存资料ROC的比较</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html"><i class="fa fa-check"></i><b>28</b> ROC阴性结果还是阳性结果</a>
<ul>
<li class="chapter" data-level="28.1" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html#探索roc曲线"><i class="fa fa-check"></i><b>28.1</b> 探索ROC曲线</a></li>
<li class="chapter" data-level="28.2" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html#反过来可以吗"><i class="fa fa-check"></i><b>28.2</b> 反过来可以吗？</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html"><i class="fa fa-check"></i><b>29</b> ROC曲线ggplot2绘制</a>
<ul>
<li class="chapter" data-level="29.1" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#准备数据"><i class="fa fa-check"></i><b>29.1</b> 准备数据</a></li>
<li class="chapter" data-level="29.2" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#计算"><i class="fa fa-check"></i><b>29.2</b> 计算</a></li>
<li class="chapter" data-level="29.3" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#画图"><i class="fa fa-check"></i><b>29.3</b> 画图</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="1030-rocattention.html"><a href="1030-rocattention.html"><i class="fa fa-check"></i><b>30</b> R语言计算AUC(ROC)注意事项</a>
<ul>
<li class="chapter" data-level="30.1" data-path="1030-rocattention.html"><a href="1030-rocattention.html#准备数据-1"><i class="fa fa-check"></i><b>30.1</b> 准备数据</a></li>
<li class="chapter" data-level="30.2" data-path="1030-rocattention.html"><a href="1030-rocattention.html#rocr"><i class="fa fa-check"></i><b>30.2</b> ROCR</a></li>
<li class="chapter" data-level="30.3" data-path="1030-rocattention.html"><a href="1030-rocattention.html#proc"><i class="fa fa-check"></i><b>30.3</b> pROC</a></li>
<li class="chapter" data-level="30.4" data-path="1030-rocattention.html"><a href="1030-rocattention.html#yardstick"><i class="fa fa-check"></i><b>30.4</b> yardstick</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="1031-rocmany.html"><a href="1031-rocmany.html"><i class="fa fa-check"></i><b>31</b> 多指标联合诊断的ROC曲线</a>
<ul>
<li class="chapter" data-level="31.1" data-path="1031-rocmany.html"><a href="1031-rocmany.html#准备数据-2"><i class="fa fa-check"></i><b>31.1</b> 准备数据</a></li>
<li class="chapter" data-level="31.2" data-path="1031-rocmany.html"><a href="1031-rocmany.html#多指标联合诊断的roc"><i class="fa fa-check"></i><b>31.2</b> 多指标联合诊断的ROC</a></li>
<li class="chapter" data-level="31.3" data-path="1031-rocmany.html"><a href="1031-rocmany.html#测试集怎么办"><i class="fa fa-check"></i><b>31.3</b> 测试集怎么办？</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html"><i class="fa fa-check"></i><b>32</b> R语言生存分析</a>
<ul>
<li class="chapter" data-level="32.1" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#生存过程的描述"><i class="fa fa-check"></i><b>32.1</b> 生存过程的描述</a></li>
<li class="chapter" data-level="32.2" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#生存过程的比较"><i class="fa fa-check"></i><b>32.2</b> 生存过程的比较</a></li>
<li class="chapter" data-level="32.3" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#cox回归"><i class="fa fa-check"></i><b>32.3</b> Cox回归</a></li>
<li class="chapter" data-level="32.4" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#时间依存协变量的cox回归和时间依存系数cox回归"><i class="fa fa-check"></i><b>32.4</b> 时间依存协变量的Cox回归和时间依存系数Cox回归</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#对时间分层"><i class="fa fa-check"></i><b>32.4.1</b> 对时间分层</a></li>
<li class="chapter" data-level="32.4.2" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#连续性时依系数变换"><i class="fa fa-check"></i><b>32.4.2</b> 连续性时依系数变换</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#参考资料-2"><i class="fa fa-check"></i><b>32.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html"><i class="fa fa-check"></i><b>33</b> R语言超详细的生存曲线可视化</a>
<ul>
<li class="chapter" data-level="33.1" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#演示数据-2"><i class="fa fa-check"></i><b>33.1</b> 演示数据</a></li>
<li class="chapter" data-level="33.2" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#基本的生存曲线"><i class="fa fa-check"></i><b>33.2</b> 基本的生存曲线</a></li>
<li class="chapter" data-level="33.3" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#增加-risk-table"><i class="fa fa-check"></i><b>33.3</b> 增加 risk table</a></li>
<li class="chapter" data-level="33.4" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#增加删失时间表ncensor-plot"><i class="fa fa-check"></i><b>33.4</b> 增加删失时间表ncensor plot</a></li>
<li class="chapter" data-level="33.5" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#超级无敌精细化自定设置"><i class="fa fa-check"></i><b>33.5</b> 超级无敌精细化自定设置</a></li>
<li class="chapter" data-level="33.6" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个组的生存曲线"><i class="fa fa-check"></i><b>33.6</b> 多个组的生存曲线</a></li>
<li class="chapter" data-level="33.7" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个分类变量分面绘制"><i class="fa fa-check"></i><b>33.7</b> 多个分类变量分面绘制</a></li>
<li class="chapter" data-level="33.8" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#同时绘制多个生存函数"><i class="fa fa-check"></i><b>33.8</b> 同时绘制多个生存函数</a></li>
<li class="chapter" data-level="33.9" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#根据某一个变量分组绘制"><i class="fa fa-check"></i><b>33.9</b> 根据某一个变量分组绘制</a></li>
<li class="chapter" data-level="33.10" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#在原有生存曲线的基础上增加"><i class="fa fa-check"></i><b>33.10</b> 在原有生存曲线的基础上增加</a></li>
<li class="chapter" data-level="33.11" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个生存函数画在一起"><i class="fa fa-check"></i><b>33.11</b> 多个生存函数画在一起</a></li>
<li class="chapter" data-level="33.12" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#参考资料-3"><i class="fa fa-check"></i><b>33.12</b> 参考资料</a></li>
</ul></li>
<li class="part"><span><b>III 文献中常用的统计方法</b></span></li>
<li class="chapter" data-level="34" data-path="1034-finygray.html"><a href="1034-finygray.html"><i class="fa fa-check"></i><b>34</b> Fine-Gray检验、竞争风险模型列线图绘制</a>
<ul>
<li class="chapter" data-level="34.1" data-path="1034-finygray.html"><a href="1034-finygray.html#加载数据和r包"><i class="fa fa-check"></i><b>34.1</b> 加载数据和R包</a></li>
<li class="chapter" data-level="34.2" data-path="1034-finygray.html"><a href="1034-finygray.html#fine-gray检验单因素分析"><i class="fa fa-check"></i><b>34.2</b> Fine-Gray检验（单因素分析）</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="1034-finygray.html"><a href="1034-finygray.html#图形展示结果"><i class="fa fa-check"></i><b>34.2.1</b> 图形展示结果</a></li>
<li class="chapter" data-level="34.2.2" data-path="1034-finygray.html"><a href="1034-finygray.html#ggplot2"><i class="fa fa-check"></i><b>34.2.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="1034-finygray.html"><a href="1034-finygray.html#竞争风险模型多因素分析"><i class="fa fa-check"></i><b>34.3</b> 竞争风险模型（多因素分析）</a></li>
<li class="chapter" data-level="34.4" data-path="1034-finygray.html"><a href="1034-finygray.html#列线图"><i class="fa fa-check"></i><b>34.4</b> 列线图</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="1035-psm.html"><a href="1035-psm.html"><i class="fa fa-check"></i><b>35</b> R语言倾向性评分：匹配</a>
<ul>
<li class="chapter" data-level="35.1" data-path="1035-psm.html"><a href="1035-psm.html#准备数据-3"><i class="fa fa-check"></i><b>35.1</b> 准备数据</a></li>
<li class="chapter" data-level="35.2" data-path="1035-psm.html"><a href="1035-psm.html#matchit包进行psm"><i class="fa fa-check"></i><b>35.2</b> matchIt包进行PSM</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="1035-psm.html"><a href="1035-psm.html#使用随机森林计算ps"><i class="fa fa-check"></i><b>35.2.1</b> 使用随机森林计算PS</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="1035-psm.html"><a href="1035-psm.html#主要匹配方法选择"><i class="fa fa-check"></i><b>35.3</b> 主要匹配方法选择</a></li>
<li class="chapter" data-level="35.4" data-path="1035-psm.html"><a href="1035-psm.html#匹配后数据的平衡性检验"><i class="fa fa-check"></i><b>35.4</b> 匹配后数据的平衡性检验</a>
<ul>
<li class="chapter" data-level="35.4.1" data-path="1035-psm.html"><a href="1035-psm.html#cobalt包"><i class="fa fa-check"></i><b>35.4.1</b> cobalt包</a></li>
<li class="chapter" data-level="35.4.2" data-path="1035-psm.html"><a href="1035-psm.html#统计检验衡量均衡性"><i class="fa fa-check"></i><b>35.4.2</b> 统计检验衡量均衡性</a></li>
</ul></li>
<li class="chapter" data-level="35.5" data-path="1035-psm.html"><a href="1035-psm.html#结果可视化-1"><i class="fa fa-check"></i><b>35.5</b> 结果可视化</a></li>
<li class="chapter" data-level="35.6" data-path="1035-psm.html"><a href="1035-psm.html#不平衡怎么办"><i class="fa fa-check"></i><b>35.6</b> 不平衡怎么办？</a></li>
<li class="chapter" data-level="35.7" data-path="1035-psm.html"><a href="1035-psm.html#其他问题"><i class="fa fa-check"></i><b>35.7</b> 其他问题</a></li>
<li class="chapter" data-level="35.8" data-path="1035-psm.html"><a href="1035-psm.html#参考资料-4"><i class="fa fa-check"></i><b>35.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="1036-pssc.html"><a href="1036-pssc.html"><i class="fa fa-check"></i><b>36</b> R语言倾向性评分：回归和分层</a>
<ul>
<li class="chapter" data-level="36.1" data-path="1036-pssc.html"><a href="1036-pssc.html#演示数据-3"><i class="fa fa-check"></i><b>36.1</b> 演示数据</a></li>
<li class="chapter" data-level="36.2" data-path="1036-pssc.html"><a href="1036-pssc.html#原始数据的概况"><i class="fa fa-check"></i><b>36.2</b> 原始数据的概况</a></li>
<li class="chapter" data-level="36.3" data-path="1036-pssc.html"><a href="1036-pssc.html#计算倾向性评分"><i class="fa fa-check"></i><b>36.3</b> 计算倾向性评分</a></li>
<li class="chapter" data-level="36.4" data-path="1036-pssc.html"><a href="1036-pssc.html#倾向性评分回归"><i class="fa fa-check"></i><b>36.4</b> 倾向性评分回归</a></li>
<li class="chapter" data-level="36.5" data-path="1036-pssc.html"><a href="1036-pssc.html#倾向性评分分层"><i class="fa fa-check"></i><b>36.5</b> 倾向性评分分层</a></li>
<li class="chapter" data-level="36.6" data-path="1036-pssc.html"><a href="1036-pssc.html#分层后的数据"><i class="fa fa-check"></i><b>36.6</b> 分层后的数据</a></li>
<li class="chapter" data-level="36.7" data-path="1036-pssc.html"><a href="1036-pssc.html#总结"><i class="fa fa-check"></i><b>36.7</b> 总结</a></li>
<li class="chapter" data-level="36.8" data-path="1036-pssc.html"><a href="1036-pssc.html#参考资料-5"><i class="fa fa-check"></i><b>36.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="1037-psw.html"><a href="1037-psw.html"><i class="fa fa-check"></i><b>37</b> R语言倾向性评分：加权</a>
<ul>
<li class="chapter" data-level="37.1" data-path="1037-psw.html"><a href="1037-psw.html#演示数据-4"><i class="fa fa-check"></i><b>37.1</b> 演示数据</a></li>
<li class="chapter" data-level="37.2" data-path="1037-psw.html"><a href="1037-psw.html#iptw"><i class="fa fa-check"></i><b>37.2</b> IPTW</a></li>
<li class="chapter" data-level="37.3" data-path="1037-psw.html"><a href="1037-psw.html#重叠加权"><i class="fa fa-check"></i><b>37.3</b> 重叠加权</a></li>
<li class="chapter" data-level="37.4" data-path="1037-psw.html"><a href="1037-psw.html#参考资料-6"><i class="fa fa-check"></i><b>37.4</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="1038-p4trend.html"><a href="1038-p4trend.html"><i class="fa fa-check"></i><b>38</b> p for trend/ p for interaction/ per 1 sd 的R语言实现</a>
<ul>
<li class="chapter" data-level="38.1" data-path="1038-p4trend.html"><a href="1038-p4trend.html#p-for-trend"><i class="fa fa-check"></i><b>38.1</b> P for trend</a></li>
<li class="chapter" data-level="38.2" data-path="1038-p4trend.html"><a href="1038-p4trend.html#p-for-interaction"><i class="fa fa-check"></i><b>38.2</b> p for interaction</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="1038-p4trend.html"><a href="1038-p4trend.html#方法1-2"><i class="fa fa-check"></i><b>38.2.1</b> 方法1</a></li>
<li class="chapter" data-level="38.2.2" data-path="1038-p4trend.html"><a href="1038-p4trend.html#方法2-2"><i class="fa fa-check"></i><b>38.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="1038-p4trend.html"><a href="1038-p4trend.html#per-1-sd"><i class="fa fa-check"></i><b>38.3</b> per 1 sd</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html"><i class="fa fa-check"></i><b>39</b> R语言多项式拟合及样条回归</a>
<ul>
<li class="chapter" data-level="39.1" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#多项式拟合"><i class="fa fa-check"></i><b>39.1</b> 多项式拟合</a></li>
<li class="chapter" data-level="39.2" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#样条回归"><i class="fa fa-check"></i><b>39.2</b> 样条回归</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#线性的立方样条"><i class="fa fa-check"></i><b>39.2.1</b> 线性的立方样条</a></li>
<li class="chapter" data-level="39.2.2" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#逻辑回归的立方样条"><i class="fa fa-check"></i><b>39.2.2</b> 逻辑回归的立方样条</a></li>
<li class="chapter" data-level="39.2.3" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#cox回归的立方样条"><i class="fa fa-check"></i><b>39.2.3</b> cox回归的立方样条</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 附录</b></span></li>
<li class="chapter" data-level="40" data-path="1040-appendix.html"><a href="1040-appendix.html"><i class="fa fa-check"></i><b>40</b> R语言和R包安装</a>
<ul>
<li class="chapter" data-level="40.1" data-path="1040-appendix.html"><a href="1040-appendix.html#r语言rtoolsrstudio的安装"><i class="fa fa-check"></i><b>40.1</b> R语言、Rtools、Rstudio的安装</a></li>
<li class="chapter" data-level="40.2" data-path="1040-appendix.html"><a href="1040-appendix.html#r包安装"><i class="fa fa-check"></i><b>40.2</b> R包安装</a></li>
<li class="chapter" data-level="40.3" data-path="1040-appendix.html"><a href="1040-appendix.html#pass软件链接"><i class="fa fa-check"></i><b>40.3</b> PASS软件链接</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由bookdown强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言实战医学统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="jddsfsdf" class="section level1 hasAnchor" number="39">
<h1><span class="header-section-number">39</span> R语言多项式拟合及样条回归<a href="1039-nonlinearfit.html#jddsfsdf" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>前面用了2篇推文，帮大家梳理了<strong>从线性拟合到非线性拟合</strong>的常用方法，包括<strong>多项式回归、分段回归、样条回归、限制性立方样条回归</strong>，以及它们之间的区别和联系，详情请看：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/BMnJRg3XPM6mEwqiz3NoDQ">多项式回归和样条回归1</a></li>
<li><a href="https://mp.weixin.qq.com/s/hvj5bnlRs2cYeZ-I9QcHvQ">多项式回归和样条回归2</a></li>
</ul>
<p>今天用R语言实操。</p>
<div id="多项式拟合" class="section level2 hasAnchor" number="39.1">
<h2><span class="header-section-number">39.1</span> 多项式拟合<a href="1039-nonlinearfit.html#多项式拟合" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>我们用<code>car</code>包里面的<code>USPop</code>数据集进行演示。这个数据集一共两列，一列是年份，另一列是美国每一年的人口数量，数据一共22行。</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="1039-nonlinearfit.html#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载数据</span></span>
<span id="cb625-2"><a href="1039-nonlinearfit.html#cb625-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb625-3"><a href="1039-nonlinearfit.html#cb625-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: carData</span></span>
<span id="cb625-4"><a href="1039-nonlinearfit.html#cb625-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;USPop&quot;</span>)</span>
<span id="cb625-5"><a href="1039-nonlinearfit.html#cb625-5" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">headTail</span>(USPop)</span>
<span id="cb625-6"><a href="1039-nonlinearfit.html#cb625-6" aria-hidden="true" tabindex="-1"></a><span class="do">##     year population</span></span>
<span id="cb625-7"><a href="1039-nonlinearfit.html#cb625-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 1   1790       3.93</span></span>
<span id="cb625-8"><a href="1039-nonlinearfit.html#cb625-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 2   1800       5.31</span></span>
<span id="cb625-9"><a href="1039-nonlinearfit.html#cb625-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 3   1810       7.24</span></span>
<span id="cb625-10"><a href="1039-nonlinearfit.html#cb625-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 4   1820       9.64</span></span>
<span id="cb625-11"><a href="1039-nonlinearfit.html#cb625-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ...  ...        ...</span></span>
<span id="cb625-12"><a href="1039-nonlinearfit.html#cb625-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 19  1970      203.3</span></span>
<span id="cb625-13"><a href="1039-nonlinearfit.html#cb625-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 20  1980     226.54</span></span>
<span id="cb625-14"><a href="1039-nonlinearfit.html#cb625-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 21  1990     248.71</span></span>
<span id="cb625-15"><a href="1039-nonlinearfit.html#cb625-15" aria-hidden="true" tabindex="-1"></a><span class="do">## 22  2000     281.42</span></span></code></pre></div>
<p>我们首先画图看看两列数据的情况：</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb626-1"><a href="1039-nonlinearfit.html#cb626-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(population <span class="sc">~</span> year, <span class="at">data =</span> USPop)</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>这个数据很明显是曲线的形状，并不是一条直线，所以此时我们直接用线性回归（直线）拟合这样的数据是不合适的。不信我们可以画图看看。</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="1039-nonlinearfit.html#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 拟合线性回归</span></span>
<span id="cb627-2"><a href="1039-nonlinearfit.html#cb627-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">lm</span>(population <span class="sc">~</span> year, <span class="at">data =</span> USPop)</span>
<span id="cb627-3"><a href="1039-nonlinearfit.html#cb627-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-4"><a href="1039-nonlinearfit.html#cb627-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出原来的数据</span></span>
<span id="cb627-5"><a href="1039-nonlinearfit.html#cb627-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(population <span class="sc">~</span> year, <span class="at">data =</span> USPop)</span>
<span id="cb627-6"><a href="1039-nonlinearfit.html#cb627-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb627-7"><a href="1039-nonlinearfit.html#cb627-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加拟合线</span></span>
<span id="cb627-8"><a href="1039-nonlinearfit.html#cb627-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(USPop<span class="sc">$</span>year, <span class="fu">fitted</span>(f), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>图中这条蓝色的线就是线性拟合的线，很明显，对数据的拟合很差。</p>
<p>那我们应该<strong>用什么方法拟合这个关系</strong>呢？</p>
<p>根据之前的两篇推文，拟合非线性关系有非常多的方法，至少有3种：</p>
<ul>
<li>多项式回归</li>
<li>分段回归</li>
<li>样条回归</li>
</ul>
<p>我们这里先介绍多项式回归。</p>
<p>多项式回归非常简单，就是个高中学过的高次方程的曲线。</p>
<p>现在我们先拟合一个<strong>二次项的多项式回归</strong>：</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="1039-nonlinearfit.html#cb628-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2次项，注意用法</span></span>
<span id="cb628-2"><a href="1039-nonlinearfit.html#cb628-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(population <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> USPop)</span>
<span id="cb628-3"><a href="1039-nonlinearfit.html#cb628-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-4"><a href="1039-nonlinearfit.html#cb628-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出拟合线</span></span>
<span id="cb628-5"><a href="1039-nonlinearfit.html#cb628-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(population <span class="sc">~</span> year, <span class="at">data =</span> USPop)</span>
<span id="cb628-6"><a href="1039-nonlinearfit.html#cb628-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(USPop<span class="sc">$</span>year, <span class="fu">fitted</span>(f1))</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>结果拟合很好，二次项就已经拟合效果非常好了，如果你还想看一下更高次项拟合，可以继续试试，比如3次项：</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="1039-nonlinearfit.html#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3次项，注意用法</span></span>
<span id="cb629-2"><a href="1039-nonlinearfit.html#cb629-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(population <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(year<span class="sc">^</span><span class="dv">3</span>), <span class="at">data =</span> USPop)</span>
<span id="cb629-3"><a href="1039-nonlinearfit.html#cb629-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-4"><a href="1039-nonlinearfit.html#cb629-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出拟合线</span></span>
<span id="cb629-5"><a href="1039-nonlinearfit.html#cb629-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(population <span class="sc">~</span> year, <span class="at">data =</span> USPop)</span>
<span id="cb629-6"><a href="1039-nonlinearfit.html#cb629-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(USPop<span class="sc">$</span>year, <span class="fu">fitted</span>(f2))</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>结果可见增加了一个3次项，结果并没有好很多。所以我们可以就选2次项即可。</p>
<p>当然也有一些统计方法可以检验，加了2次项、3次项之后是不是有统计学意义，可以用似然比检验，比如<code>anova</code>：</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="1039-nonlinearfit.html#cb630-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 线性回归和2次项比较</span></span>
<span id="cb630-2"><a href="1039-nonlinearfit.html#cb630-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(f, f1)</span>
<span id="cb630-3"><a href="1039-nonlinearfit.html#cb630-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb630-4"><a href="1039-nonlinearfit.html#cb630-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb630-5"><a href="1039-nonlinearfit.html#cb630-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: population ~ year</span></span>
<span id="cb630-6"><a href="1039-nonlinearfit.html#cb630-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: population ~ year + I(year^2)</span></span>
<span id="cb630-7"><a href="1039-nonlinearfit.html#cb630-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span></span>
<span id="cb630-8"><a href="1039-nonlinearfit.html#cb630-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     20 12819.0                                  </span></span>
<span id="cb630-9"><a href="1039-nonlinearfit.html#cb630-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     19   170.7  1     12648 1408.1 &lt; 2.2e-16 ***</span></span>
<span id="cb630-10"><a href="1039-nonlinearfit.html#cb630-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb630-11"><a href="1039-nonlinearfit.html#cb630-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb630-12"><a href="1039-nonlinearfit.html#cb630-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-13"><a href="1039-nonlinearfit.html#cb630-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2次项和3次项比较</span></span>
<span id="cb630-14"><a href="1039-nonlinearfit.html#cb630-14" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(f1, f2)</span>
<span id="cb630-15"><a href="1039-nonlinearfit.html#cb630-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Analysis of Variance Table</span></span>
<span id="cb630-16"><a href="1039-nonlinearfit.html#cb630-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb630-17"><a href="1039-nonlinearfit.html#cb630-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 1: population ~ year + I(year^2)</span></span>
<span id="cb630-18"><a href="1039-nonlinearfit.html#cb630-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Model 2: population ~ year + I(year^2) + I(year^3)</span></span>
<span id="cb630-19"><a href="1039-nonlinearfit.html#cb630-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  </span></span>
<span id="cb630-20"><a href="1039-nonlinearfit.html#cb630-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     19 170.66                              </span></span>
<span id="cb630-21"><a href="1039-nonlinearfit.html#cb630-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     18 143.64  1    27.027 3.3868 0.08227 .</span></span>
<span id="cb630-22"><a href="1039-nonlinearfit.html#cb630-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb630-23"><a href="1039-nonlinearfit.html#cb630-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>结果很明显，加入2次项之后，P值是小于0.05的，说明是有统计学意义的，但是2次项和3次项比较，就没有统计学意义了，说明我们只要用到2次项即可。</p>
<p>在写论文的时候应该如何描述这些方法呢？请多看文献，这不在本文的讨论范围。</p>
<p>为了加深理解，下面再给大家举一个例子。</p>
<p>首先是构造一个数据，构造数据的过程不需要看。</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="1039-nonlinearfit.html#cb631-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>         </span>
<span id="cb631-2"><a href="1039-nonlinearfit.html#cb631-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>) </span>
<span id="cb631-3"><a href="1039-nonlinearfit.html#cb631-3" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, x, <span class="dv">0</span>)</span>
<span id="cb631-4"><a href="1039-nonlinearfit.html#cb631-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">1</span>])</span>
<span id="cb631-5"><a href="1039-nonlinearfit.html#cb631-5" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">2</span>])</span>
<span id="cb631-6"><a href="1039-nonlinearfit.html#cb631-6" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">3</span>])</span>
<span id="cb631-7"><a href="1039-nonlinearfit.html#cb631-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb631-8"><a href="1039-nonlinearfit.html#cb631-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>x <span class="sc">+</span> <span class="sc">-</span><span class="fl">1.2</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fl">1.4</span><span class="sc">*</span>x3 <span class="sc">+</span> <span class="sc">-</span><span class="fl">1.6</span><span class="sc">*</span>x4 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">sd =</span> <span class="fl">2.2</span>)</span>
<span id="cb631-9"><a href="1039-nonlinearfit.html#cb631-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>这样的一个数据，很明显也不是线性的，所以此时线性回归肯定不合适。我们尝试用多项式回归来拟合这个数据。</p>
<p>这个数据，我已经帮大家试好了，需要拟合6次项才会比较完美。</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="1039-nonlinearfit.html#cb632-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 拟合6次项</span></span>
<span id="cb632-2"><a href="1039-nonlinearfit.html#cb632-2" aria-hidden="true" tabindex="-1"></a>f<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">5</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">6</span>))</span>
<span id="cb632-3"><a href="1039-nonlinearfit.html#cb632-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-4"><a href="1039-nonlinearfit.html#cb632-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出拟合线</span></span>
<span id="cb632-5"><a href="1039-nonlinearfit.html#cb632-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb632-6"><a href="1039-nonlinearfit.html#cb632-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">fitted</span>(f<span class="fl">.6</span>))</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>可以看到拟合线比较贴合数据。但是在拟合线的<strong>开头和末尾可以发现有点上翘的趋势</strong>，这也是多项式拟合的缺点，如果此时在两头多点数据，可能拟合效果就不是很好了。解决方法也很简单，就是我们下次要介绍的<strong>样条回归</strong>。</p>
<p>多项式回归的公式写法像上面这样略显复杂，如果是更高次的项，岂不是更复杂？当然是有简便写法的。可以使用<code>poly()</code>函数。</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="1039-nonlinearfit.html#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 多项式拟合的简便写法，拟合6次项，和上面结果完全一样</span></span>
<span id="cb633-2"><a href="1039-nonlinearfit.html#cb633-2" aria-hidden="true" tabindex="-1"></a>f<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">6</span>))</span>
<span id="cb633-3"><a href="1039-nonlinearfit.html#cb633-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb633-4"><a href="1039-nonlinearfit.html#cb633-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出拟合线</span></span>
<span id="cb633-5"><a href="1039-nonlinearfit.html#cb633-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb633-6"><a href="1039-nonlinearfit.html#cb633-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">fitted</span>(f<span class="fl">.6</span>))</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>可以看到使用<code>poly()</code>函数极大的简化了公式写法，而且很好理解，后面的数字就代表了次方。看到这里，不知道你有没有想起重复测量数据的多重比较中用过的正交多项式呢？没有印象的赶紧去复习下：<a href="https://mp.weixin.qq.com/s/0NykxN3Ub2haUce5pSydCA">重复测量数据的多重比较</a></p>
<p>这样的拟合线，当然也是可以用<code>ggplot2</code>画的。</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="1039-nonlinearfit.html#cb634-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb634-2"><a href="1039-nonlinearfit.html#cb634-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb634-3"><a href="1039-nonlinearfit.html#cb634-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb634-4"><a href="1039-nonlinearfit.html#cb634-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x,y),<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb634-5"><a href="1039-nonlinearfit.html#cb634-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(x, <span class="fu">fitted</span>(f<span class="fl">.6</span>)), <span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb634-6"><a href="1039-nonlinearfit.html#cb634-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>或者下面这样，好理解，还可以添加可信区间：</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="1039-nonlinearfit.html#cb635-1" aria-hidden="true" tabindex="-1"></a>df.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y=</span> y)</span>
<span id="cb635-2"><a href="1039-nonlinearfit.html#cb635-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb635-3"><a href="1039-nonlinearfit.html#cb635-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.tmp, <span class="fu">aes</span>(x,y))<span class="sc">+</span></span>
<span id="cb635-4"><a href="1039-nonlinearfit.html#cb635-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb635-5"><a href="1039-nonlinearfit.html#cb635-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb635-6"><a href="1039-nonlinearfit.html#cb635-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x,<span class="dv">6</span>),</span>
<span id="cb635-7"><a href="1039-nonlinearfit.html#cb635-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="st">&quot;red&quot;</span>,</span>
<span id="cb635-8"><a href="1039-nonlinearfit.html#cb635-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">2</span>,</span>
<span id="cb635-9"><a href="1039-nonlinearfit.html#cb635-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> T, <span class="co"># 可信区间</span></span>
<span id="cb635-10"><a href="1039-nonlinearfit.html#cb635-10" aria-hidden="true" tabindex="-1"></a>              )<span class="sc">+</span></span>
<span id="cb635-11"><a href="1039-nonlinearfit.html#cb635-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>最后一个问题：<strong>多项式能用于逻辑回归吗？Cox回归呢？</strong></p>
<p>当然可以了，只是把自变量变成多次项而已，和<code>lm</code>用法一模一样，函数使用<code>glm()/coxph()</code>等即可！</p>
</div>
<div id="样条回归" class="section level2 hasAnchor" number="39.2">
<h2><span class="header-section-number">39.2</span> 样条回归<a href="1039-nonlinearfit.html#样条回归" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>前面用了2篇推文，帮大家梳理了<strong>从线性拟合到非线性拟合</strong>的常用方法，包括<strong>多项式回归、分段回归、样条回归、限制性立方样条回归</strong>，以及它们之间的区别和联系，详情请看：</p>
<ul>
<li><a href="https://mp.weixin.qq.com/s/BMnJRg3XPM6mEwqiz3NoDQ">多项式回归和样条回归1</a></li>
<li><a href="https://mp.weixin.qq.com/s/hvj5bnlRs2cYeZ-I9QcHvQ">多项式回归和样条回归2</a></li>
</ul>
<p>并且上一篇推文已经介绍了R语言实现多项式回归的内容：<a href="https://mp.weixin.qq.com/s/DTaEQv_WGOYBp3UOzy7h1w">R语言非线性拟合：多项式回归</a></p>
<p>今天主要介绍R语言实现<strong>立方样条回归</strong>。</p>
<p>读过上面几篇推文的朋友想必已经知道了（没看过的建议先看看），样条回归包括很多种，限制性立方样条只是其中一种，更多的大家可以自己了解。</p>
<div id="线性的立方样条" class="section level3 hasAnchor" number="39.2.1">
<h3><span class="header-section-number">39.2.1</span> 线性的立方样条<a href="1039-nonlinearfit.html#线性的立方样条" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>演示所用数据还是用上一篇的数据：</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="1039-nonlinearfit.html#cb636-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb636-2"><a href="1039-nonlinearfit.html#cb636-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>         </span>
<span id="cb636-3"><a href="1039-nonlinearfit.html#cb636-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>) </span>
<span id="cb636-4"><a href="1039-nonlinearfit.html#cb636-4" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="cf">function</span>(x)<span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, x, <span class="dv">0</span>)</span>
<span id="cb636-5"><a href="1039-nonlinearfit.html#cb636-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">1</span>])</span>
<span id="cb636-6"><a href="1039-nonlinearfit.html#cb636-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">2</span>])</span>
<span id="cb636-7"><a href="1039-nonlinearfit.html#cb636-7" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">u</span>(x <span class="sc">-</span> k[<span class="dv">3</span>])</span>
<span id="cb636-8"><a href="1039-nonlinearfit.html#cb636-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb636-9"><a href="1039-nonlinearfit.html#cb636-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.8</span> <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span>x <span class="sc">+</span> <span class="sc">-</span><span class="fl">1.2</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fl">1.4</span><span class="sc">*</span>x3 <span class="sc">+</span> <span class="sc">-</span><span class="fl">1.6</span><span class="sc">*</span>x4 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="at">sd =</span> <span class="fl">2.2</span>)</span>
<span id="cb636-10"><a href="1039-nonlinearfit.html#cb636-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>假设我们有这样一个数据，很明显这不是一个直线的关系，这时候再用直线回归就不适合了。但是为了演示，这里还是给大家用直线回归方法拟合一下看看效果。</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="1039-nonlinearfit.html#cb637-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb637-2"><a href="1039-nonlinearfit.html#cb637-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y)</span>
<span id="cb637-3"><a href="1039-nonlinearfit.html#cb637-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">fitted</span>(f),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>很明显，直线回归是不可能有很好的拟合效果的。这时候我们应该用什么方法拟合这个关系呢？</p>
<p>根据之前的3篇推文，拟合非线性关系有非常多的方法，至少有3种：</p>
<ul>
<li>多项式回归</li>
<li>分段回归</li>
<li>样条回归</li>
</ul>
<p>多项式回归在上一篇推文中已经介绍过了，效果不错，但是有一个小小的缺点，在<strong>数据两端有上翘趋势</strong>，具体可参考之前的推文。</p>
<p>今天给大家演示限制性立方样条回归。做限制性立方样条回归的R包很多，这里以<code>rms</code>为例，以后有机会再介绍其他R包，比如<code>splines</code>。</p>
<p>rms做限制性立方样条回归很简单，对需要使用的变量使用<code>rcs()</code>函数即可。</p>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="1039-nonlinearfit.html#cb638-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载R包</span></span>
<span id="cb638-2"><a href="1039-nonlinearfit.html#cb638-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb638-3"><a href="1039-nonlinearfit.html#cb638-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: Hmisc</span></span>
<span id="cb638-4"><a href="1039-nonlinearfit.html#cb638-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: lattice</span></span>
<span id="cb638-5"><a href="1039-nonlinearfit.html#cb638-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: survival</span></span>
<span id="cb638-6"><a href="1039-nonlinearfit.html#cb638-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: Formula</span></span>
<span id="cb638-7"><a href="1039-nonlinearfit.html#cb638-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-8"><a href="1039-nonlinearfit.html#cb638-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;Hmisc&#39;</span></span>
<span id="cb638-9"><a href="1039-nonlinearfit.html#cb638-9" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb638-10"><a href="1039-nonlinearfit.html#cb638-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-11"><a href="1039-nonlinearfit.html#cb638-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     format.pval, units</span></span>
<span id="cb638-12"><a href="1039-nonlinearfit.html#cb638-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: SparseM</span></span>
<span id="cb638-13"><a href="1039-nonlinearfit.html#cb638-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-14"><a href="1039-nonlinearfit.html#cb638-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;SparseM&#39;</span></span>
<span id="cb638-15"><a href="1039-nonlinearfit.html#cb638-15" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:base&#39;:</span></span>
<span id="cb638-16"><a href="1039-nonlinearfit.html#cb638-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-17"><a href="1039-nonlinearfit.html#cb638-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     backsolve</span></span>
<span id="cb638-18"><a href="1039-nonlinearfit.html#cb638-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-19"><a href="1039-nonlinearfit.html#cb638-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;rms&#39;</span></span>
<span id="cb638-20"><a href="1039-nonlinearfit.html#cb638-20" aria-hidden="true" tabindex="-1"></a><span class="do">## The following objects are masked from &#39;package:car&#39;:</span></span>
<span id="cb638-21"><a href="1039-nonlinearfit.html#cb638-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb638-22"><a href="1039-nonlinearfit.html#cb638-22" aria-hidden="true" tabindex="-1"></a><span class="do">##     Predict, vif</span></span>
<span id="cb638-23"><a href="1039-nonlinearfit.html#cb638-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-24"><a href="1039-nonlinearfit.html#cb638-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 拟合限制性立方样条，这里对变量x使用，跟多项式回归差不多</span></span>
<span id="cb638-25"><a href="1039-nonlinearfit.html#cb638-25" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">rcs</span>(x,<span class="dv">5</span>))</span>
<span id="cb638-26"><a href="1039-nonlinearfit.html#cb638-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb638-27"><a href="1039-nonlinearfit.html#cb638-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 画出原数据</span></span>
<span id="cb638-28"><a href="1039-nonlinearfit.html#cb638-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb638-29"><a href="1039-nonlinearfit.html#cb638-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">fitted</span>(f),<span class="at">col=</span><span class="st">&quot;red&quot;</span>) <span class="co"># 画出拟合线</span></span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>可以看到，拟合结果非常完美，甚至比我们的6次多项式拟合还要好一点！</p>
<p>下面解释下上述代码中的意思。<code>rcs</code>是我们的立方样条函数，其中的数字5表示我们要用5个节点（不理解这里的节点啥意思的请去看开头的两篇推文）。</p>
<p>默认节点是4，一般建议选3-6个左右，可以分别试试效果，选择拟合较好的那一个，参考文献是这篇：F. Harrell. Regression Modeling Strategies: With Applications to Linear Models, Logistic and Ordinal Regression, and Survival Analysis.</p>
<p>我们可以自己指定，比如根据分位数、中位数、平均数等，都可以作为我们的节点。</p>
<p>下面用<code>ggplot2</code>画图。</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="1039-nonlinearfit.html#cb639-1" aria-hidden="true" tabindex="-1"></a>df.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)</span>
<span id="cb639-2"><a href="1039-nonlinearfit.html#cb639-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb639-3"><a href="1039-nonlinearfit.html#cb639-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df.tmp, <span class="fu">aes</span>(x,y))<span class="sc">+</span></span>
<span id="cb639-4"><a href="1039-nonlinearfit.html#cb639-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb639-5"><a href="1039-nonlinearfit.html#cb639-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb639-6"><a href="1039-nonlinearfit.html#cb639-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">rcs</span>(x,<span class="dv">5</span>),</span>
<span id="cb639-7"><a href="1039-nonlinearfit.html#cb639-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">se =</span> T,</span>
<span id="cb639-8"><a href="1039-nonlinearfit.html#cb639-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">color=</span><span class="st">&quot;red&quot;</span></span>
<span id="cb639-9"><a href="1039-nonlinearfit.html#cb639-9" aria-hidden="true" tabindex="-1"></a>              )<span class="sc">+</span></span>
<span id="cb639-10"><a href="1039-nonlinearfit.html#cb639-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>此方法同样也是适用于logistic回归和cox回归的，建议使用<code>rms</code>包中的<code>lrm</code>函数和<code>cph</code>进行拟合。</p>
</div>
<div id="逻辑回归的立方样条" class="section level3 hasAnchor" number="39.2.2">
<h3><span class="header-section-number">39.2.2</span> 逻辑回归的立方样条<a href="1039-nonlinearfit.html#逻辑回归的立方样条" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>逻辑回归和cox回归就不展开讲了，用法一模一样。</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="1039-nonlinearfit.html#cb640-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb640-2"><a href="1039-nonlinearfit.html#cb640-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 逻辑回归数据</span></span>
<span id="cb640-3"><a href="1039-nonlinearfit.html#cb640-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getHdata</span>(titanic3)</span>
<span id="cb640-4"><a href="1039-nonlinearfit.html#cb640-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-5"><a href="1039-nonlinearfit.html#cb640-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用rms前先把数据打包</span></span>
<span id="cb640-6"><a href="1039-nonlinearfit.html#cb640-6" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(titanic3); <span class="fu">options</span>(<span class="at">datadist=</span><span class="st">&#39;dd&#39;</span>)</span>
<span id="cb640-7"><a href="1039-nonlinearfit.html#cb640-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb640-8"><a href="1039-nonlinearfit.html#cb640-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 逻辑回归的立方样条</span></span>
<span id="cb640-9"><a href="1039-nonlinearfit.html#cb640-9" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">lrm</span>(survived <span class="sc">~</span> <span class="fu">rcs</span>(<span class="fu">sqrt</span>(age),<span class="dv">5</span>) <span class="sc">+</span> sex, <span class="at">data=</span>titanic3)</span>
<span id="cb640-10"><a href="1039-nonlinearfit.html#cb640-10" aria-hidden="true" tabindex="-1"></a>f</span>
<span id="cb640-11"><a href="1039-nonlinearfit.html#cb640-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Frequencies of Missing Values Due to Each Variable</span></span>
<span id="cb640-12"><a href="1039-nonlinearfit.html#cb640-12" aria-hidden="true" tabindex="-1"></a><span class="do">## survived      age      sex </span></span>
<span id="cb640-13"><a href="1039-nonlinearfit.html#cb640-13" aria-hidden="true" tabindex="-1"></a><span class="do">##        0      263        0 </span></span>
<span id="cb640-14"><a href="1039-nonlinearfit.html#cb640-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb640-15"><a href="1039-nonlinearfit.html#cb640-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Logistic Regression Model</span></span>
<span id="cb640-16"><a href="1039-nonlinearfit.html#cb640-16" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb640-17"><a href="1039-nonlinearfit.html#cb640-17" aria-hidden="true" tabindex="-1"></a><span class="do">## lrm(formula = survived ~ rcs(sqrt(age), 5) + sex, data = titanic3)</span></span>
<span id="cb640-18"><a href="1039-nonlinearfit.html#cb640-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb640-19"><a href="1039-nonlinearfit.html#cb640-19" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb640-20"><a href="1039-nonlinearfit.html#cb640-20" aria-hidden="true" tabindex="-1"></a><span class="do">##                        Model Likelihood      Discrimination    Rank Discrim.    </span></span>
<span id="cb640-21"><a href="1039-nonlinearfit.html#cb640-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                              Ratio Test             Indexes          Indexes    </span></span>
<span id="cb640-22"><a href="1039-nonlinearfit.html#cb640-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Obs          1046    LR chi2     328.06      R2       0.363    C       0.794    </span></span>
<span id="cb640-23"><a href="1039-nonlinearfit.html#cb640-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  0            619    d.f.             5     R2(5,1046)0.266    Dxy     0.587    </span></span>
<span id="cb640-24"><a href="1039-nonlinearfit.html#cb640-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  1            427    Pr(&gt; chi2) &lt;0.0001    R2(5,758.1)0.347    gamma   0.593    </span></span>
<span id="cb640-25"><a href="1039-nonlinearfit.html#cb640-25" aria-hidden="true" tabindex="-1"></a><span class="do">## max |deriv| 2e-07                            Brier    0.168    tau-a   0.284    </span></span>
<span id="cb640-26"><a href="1039-nonlinearfit.html#cb640-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb640-27"><a href="1039-nonlinearfit.html#cb640-27" aria-hidden="true" tabindex="-1"></a><span class="do">##           Coef     S.E.    Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb640-28"><a href="1039-nonlinearfit.html#cb640-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Intercept   3.0936  0.5428   5.70 &lt;0.0001 </span></span>
<span id="cb640-29"><a href="1039-nonlinearfit.html#cb640-29" aria-hidden="true" tabindex="-1"></a><span class="do">## age        -0.6383  0.1771  -3.60 0.0003  </span></span>
<span id="cb640-30"><a href="1039-nonlinearfit.html#cb640-30" aria-hidden="true" tabindex="-1"></a><span class="do">## age&#39;        1.5544  0.6527   2.38 0.0172  </span></span>
<span id="cb640-31"><a href="1039-nonlinearfit.html#cb640-31" aria-hidden="true" tabindex="-1"></a><span class="do">## age&#39;&#39;     -12.1583  8.8925  -1.37 0.1715  </span></span>
<span id="cb640-32"><a href="1039-nonlinearfit.html#cb640-32" aria-hidden="true" tabindex="-1"></a><span class="do">## age&#39;&#39;&#39;     15.8326 16.9397   0.93 0.3500  </span></span>
<span id="cb640-33"><a href="1039-nonlinearfit.html#cb640-33" aria-hidden="true" tabindex="-1"></a><span class="do">## sex=male   -2.4944  0.1549 -16.10 &lt;0.0001</span></span></code></pre></div>
<p>构建好逻辑回归模型后，首先可以用<code>anova()</code>函数查看各自变量的统计显著性：</p>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="1039-nonlinearfit.html#cb641-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(f)</span>
<span id="cb641-2"><a href="1039-nonlinearfit.html#cb641-2" aria-hidden="true" tabindex="-1"></a><span class="do">##                 Wald Statistics          Response: survived </span></span>
<span id="cb641-3"><a href="1039-nonlinearfit.html#cb641-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb641-4"><a href="1039-nonlinearfit.html#cb641-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  Factor     Chi-Square d.f. P     </span></span>
<span id="cb641-5"><a href="1039-nonlinearfit.html#cb641-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  age         14.97     4    0.0048</span></span>
<span id="cb641-6"><a href="1039-nonlinearfit.html#cb641-6" aria-hidden="true" tabindex="-1"></a><span class="do">##   Nonlinear  12.65     3    0.0055</span></span>
<span id="cb641-7"><a href="1039-nonlinearfit.html#cb641-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  sex        259.17     1    &lt;.0001</span></span>
<span id="cb641-8"><a href="1039-nonlinearfit.html#cb641-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  TOTAL      265.88     5    &lt;.0001</span></span></code></pre></div>
<p><code>age</code>的<code>Nonlinear</code>的P&lt;0.05，可以认为是符合非线性的。（如果是符合线性，那我们可以直接用普通线性回归的方法，就不用这么折腾还要用样条回归了）</p>
<p>下面我们用图形展示年龄和OR值的关系：</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="1039-nonlinearfit.html#cb642-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(f, age, sex))<span class="sc">+</span> <span class="co"># 加上 fun = plogis 则返回概率</span></span>
<span id="cb642-2"><a href="1039-nonlinearfit.html#cb642-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span> <span class="co"># OR=1的横线</span></span>
<span id="cb642-3"><a href="1039-nonlinearfit.html#cb642-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>纵坐标表示OR值，横坐标是年龄。</p>
</div>
<div id="cox回归的立方样条" class="section level3 hasAnchor" number="39.2.3">
<h3><span class="header-section-number">39.2.3</span> cox回归的立方样条<a href="1039-nonlinearfit.html#cox回归的立方样条" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="1039-nonlinearfit.html#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb643-2"><a href="1039-nonlinearfit.html#cb643-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 构造数据，包括性别(sex),年龄(age),生存时间(time),生存结局(death)</span></span>
<span id="cb643-3"><a href="1039-nonlinearfit.html#cb643-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb643-4"><a href="1039-nonlinearfit.html#cb643-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">731</span>)</span>
<span id="cb643-5"><a href="1039-nonlinearfit.html#cb643-5" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="sc">+</span> <span class="dv">12</span><span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb643-6"><a href="1039-nonlinearfit.html#cb643-6" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(age) <span class="ot">&lt;-</span> <span class="st">&quot;Age&quot;</span></span>
<span id="cb643-7"><a href="1039-nonlinearfit.html#cb643-7" aria-hidden="true" tabindex="-1"></a>sex <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&#39;Male&#39;</span>,<span class="st">&#39;Female&#39;</span>), n, <span class="at">rep=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">6</span>, .<span class="dv">4</span>)))</span>
<span id="cb643-8"><a href="1039-nonlinearfit.html#cb643-8" aria-hidden="true" tabindex="-1"></a>cens <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">*</span><span class="fu">runif</span>(n)</span>
<span id="cb643-9"><a href="1039-nonlinearfit.html#cb643-9" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> .<span class="dv">02</span><span class="sc">*</span><span class="fu">exp</span>(.<span class="dv">04</span><span class="sc">*</span>(age<span class="dv">-50</span>)<span class="sc">+</span>.<span class="dv">8</span><span class="sc">*</span>(sex<span class="sc">==</span><span class="st">&#39;Female&#39;</span>))</span>
<span id="cb643-10"><a href="1039-nonlinearfit.html#cb643-10" aria-hidden="true" tabindex="-1"></a>time<span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fu">runif</span>(n))<span class="sc">/</span>h</span>
<span id="cb643-11"><a href="1039-nonlinearfit.html#cb643-11" aria-hidden="true" tabindex="-1"></a><span class="fu">label</span>(time) <span class="ot">&lt;-</span> <span class="st">&#39;Follow-up Time&#39;</span></span>
<span id="cb643-12"><a href="1039-nonlinearfit.html#cb643-12" aria-hidden="true" tabindex="-1"></a>death<span class="ot">&lt;-</span> <span class="fu">ifelse</span>(time <span class="sc">&lt;=</span> cens,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb643-13"><a href="1039-nonlinearfit.html#cb643-13" aria-hidden="true" tabindex="-1"></a>time <span class="ot">&lt;-</span> <span class="fu">pmin</span>(time, cens)</span>
<span id="cb643-14"><a href="1039-nonlinearfit.html#cb643-14" aria-hidden="true" tabindex="-1"></a><span class="fu">units</span>(time) <span class="ot">&lt;-</span> <span class="st">&quot;Year&quot;</span></span>
<span id="cb643-15"><a href="1039-nonlinearfit.html#cb643-15" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(age,sex,time,death)</span>
<span id="cb643-16"><a href="1039-nonlinearfit.html#cb643-16" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">headTail</span>(data)</span>
<span id="cb643-17"><a href="1039-nonlinearfit.html#cb643-17" aria-hidden="true" tabindex="-1"></a><span class="do">##        age    sex  time death</span></span>
<span id="cb643-18"><a href="1039-nonlinearfit.html#cb643-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 1    60.58   Male  3.09     1</span></span>
<span id="cb643-19"><a href="1039-nonlinearfit.html#cb643-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 2    42.11   Male  1.57     0</span></span>
<span id="cb643-20"><a href="1039-nonlinearfit.html#cb643-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 3    54.87   Male  3.24     0</span></span>
<span id="cb643-21"><a href="1039-nonlinearfit.html#cb643-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 4    55.82   Male  12.5     0</span></span>
<span id="cb643-22"><a href="1039-nonlinearfit.html#cb643-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ...    ...   &lt;NA&gt;   ...   ...</span></span>
<span id="cb643-23"><a href="1039-nonlinearfit.html#cb643-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 997  53.02 Female  9.03     0</span></span>
<span id="cb643-24"><a href="1039-nonlinearfit.html#cb643-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 998  38.25   Male 11.72     0</span></span>
<span id="cb643-25"><a href="1039-nonlinearfit.html#cb643-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 999  45.63   Male  12.8     0</span></span>
<span id="cb643-26"><a href="1039-nonlinearfit.html#cb643-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 1000 57.38 Female   3.4     0</span></span></code></pre></div>
<p>使用限制性立方样条进行Cox回归：</p>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="1039-nonlinearfit.html#cb644-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 打包数据</span></span>
<span id="cb644-2"><a href="1039-nonlinearfit.html#cb644-2" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">datadist</span>(data);<span class="fu">options</span>(<span class="at">datadist=</span><span class="st">&#39;dd&#39;</span>) </span>
<span id="cb644-3"><a href="1039-nonlinearfit.html#cb644-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb644-4"><a href="1039-nonlinearfit.html#cb644-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 拟合cox模型</span></span>
<span id="cb644-5"><a href="1039-nonlinearfit.html#cb644-5" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span> <span class="fu">cph</span>(<span class="fu">Surv</span>(time,death) <span class="sc">~</span> <span class="fu">rcs</span>(age,<span class="dv">4</span>) <span class="sc">+</span> sex,<span class="at">data =</span> data) </span>
<span id="cb644-6"><a href="1039-nonlinearfit.html#cb644-6" aria-hidden="true" tabindex="-1"></a>fit</span>
<span id="cb644-7"><a href="1039-nonlinearfit.html#cb644-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Cox Proportional Hazards Model</span></span>
<span id="cb644-8"><a href="1039-nonlinearfit.html#cb644-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb644-9"><a href="1039-nonlinearfit.html#cb644-9" aria-hidden="true" tabindex="-1"></a><span class="do">## cph(formula = Surv(time, death) ~ rcs(age, 4) + sex, data = data)</span></span>
<span id="cb644-10"><a href="1039-nonlinearfit.html#cb644-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb644-11"><a href="1039-nonlinearfit.html#cb644-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                         Model Tests     Discrimination    </span></span>
<span id="cb644-12"><a href="1039-nonlinearfit.html#cb644-12" aria-hidden="true" tabindex="-1"></a><span class="do">##                                                Indexes    </span></span>
<span id="cb644-13"><a href="1039-nonlinearfit.html#cb644-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Obs       1000    LR chi2     78.28     R2       0.083    </span></span>
<span id="cb644-14"><a href="1039-nonlinearfit.html#cb644-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Events     183    d.f.            4    R2(4,1000)0.072    </span></span>
<span id="cb644-15"><a href="1039-nonlinearfit.html#cb644-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Center -0.2861    Pr(&gt; chi2) 0.0000     R2(4,183)0.334    </span></span>
<span id="cb644-16"><a href="1039-nonlinearfit.html#cb644-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Score chi2  83.86     Dxy      0.378    </span></span>
<span id="cb644-17"><a href="1039-nonlinearfit.html#cb644-17" aria-hidden="true" tabindex="-1"></a><span class="do">##                   Pr(&gt; chi2) 0.0000                       </span></span>
<span id="cb644-18"><a href="1039-nonlinearfit.html#cb644-18" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb644-19"><a href="1039-nonlinearfit.html#cb644-19" aria-hidden="true" tabindex="-1"></a><span class="do">##          Coef    S.E.   Wald Z Pr(&gt;|Z|)</span></span>
<span id="cb644-20"><a href="1039-nonlinearfit.html#cb644-20" aria-hidden="true" tabindex="-1"></a><span class="do">## age      -0.0173 0.0286 -0.61  0.5443  </span></span>
<span id="cb644-21"><a href="1039-nonlinearfit.html#cb644-21" aria-hidden="true" tabindex="-1"></a><span class="do">## age&#39;      0.2040 0.0767  2.66  0.0079  </span></span>
<span id="cb644-22"><a href="1039-nonlinearfit.html#cb644-22" aria-hidden="true" tabindex="-1"></a><span class="do">## age&#39;&#39;    -0.7500 0.2679 -2.80  0.0051  </span></span>
<span id="cb644-23"><a href="1039-nonlinearfit.html#cb644-23" aria-hidden="true" tabindex="-1"></a><span class="do">## sex=Male -0.6445 0.1488 -4.33  &lt;0.0001</span></span></code></pre></div>
<p>有了这个结果，我们就可以像logistic回归一样，把结果画出来，用来展示年龄和HR值的关系：</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="1039-nonlinearfit.html#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(fit, age,<span class="at">fun =</span> exp, <span class="at">ref.zero =</span> T))<span class="sc">+</span> <span class="co"># fun = exp，计算HR值，不加这句计算概率</span></span>
<span id="cb645-2"><a href="1039-nonlinearfit.html#cb645-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">linetype=</span><span class="dv">2</span>)<span class="sc">+</span> <span class="co"># HR=1的横线</span></span>
<span id="cb645-3"><a href="1039-nonlinearfit.html#cb645-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>通常在文献中还会看到一些竖线，来表示一些比较重要的分割点，比如根据某些值把HR分为大于1和小于1，这样就可以区分在哪一个范围内是保护因素或者风险因素。</p>
<p>我们这个例子，首先可以通过以下函数获取HR=1时的年龄是几岁：</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="1039-nonlinearfit.html#cb646-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 结果太长，没放出来</span></span>
<span id="cb646-2"><a href="1039-nonlinearfit.html#cb646-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Predict</span>(fit, age,<span class="at">fun =</span> exp, <span class="at">ref.zero =</span> T)</span></code></pre></div>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="1039-nonlinearfit.html#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="dv">97</span>  <span class="fl">47.44907</span> Male <span class="fl">0.8836735</span> <span class="fl">0.8413758</span> <span class="fl">0.9280976</span></span>
<span id="cb647-2"><a href="1039-nonlinearfit.html#cb647-2" aria-hidden="true" tabindex="-1"></a><span class="dv">98</span>  <span class="fl">47.73791</span> Male <span class="fl">0.9068446</span> <span class="fl">0.8722672</span> <span class="fl">0.9427927</span></span>
<span id="cb647-3"><a href="1039-nonlinearfit.html#cb647-3" aria-hidden="true" tabindex="-1"></a><span class="dv">99</span>  <span class="fl">48.02676</span> Male <span class="fl">0.9309398</span> <span class="fl">0.9047742</span> <span class="fl">0.9578620</span></span>
<span id="cb647-4"><a href="1039-nonlinearfit.html#cb647-4" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="fl">48.31561</span> Male <span class="fl">0.9559535</span> <span class="fl">0.9389208</span> <span class="fl">0.9732953</span></span>
<span id="cb647-5"><a href="1039-nonlinearfit.html#cb647-5" aria-hidden="true" tabindex="-1"></a><span class="dv">101</span> <span class="fl">48.60445</span> Male <span class="fl">0.9818776</span> <span class="fl">0.9747260</span> <span class="fl">0.9890816</span></span>
<span id="cb647-6"><a href="1039-nonlinearfit.html#cb647-6" aria-hidden="true" tabindex="-1"></a><span class="dv">102</span> <span class="fl">48.89330</span> Male <span class="fl">1.0087001</span> <span class="fl">1.0052093</span> <span class="fl">1.0122030</span></span>
<span id="cb647-7"><a href="1039-nonlinearfit.html#cb647-7" aria-hidden="true" tabindex="-1"></a><span class="dv">103</span> <span class="fl">49.18214</span> Male <span class="fl">1.0364058</span> <span class="fl">1.0216664</span> <span class="fl">1.0513578</span></span>
<span id="cb647-8"><a href="1039-nonlinearfit.html#cb647-8" aria-hidden="true" tabindex="-1"></a><span class="dv">104</span> <span class="fl">49.47099</span> Male <span class="fl">1.0649750</span> <span class="fl">1.0384398</span> <span class="fl">1.0921883</span></span>
<span id="cb647-9"><a href="1039-nonlinearfit.html#cb647-9" aria-hidden="true" tabindex="-1"></a><span class="dv">105</span> <span class="fl">49.75984</span> Male <span class="fl">1.0943840</span> <span class="fl">1.0555157</span> <span class="fl">1.1346835</span></span></code></pre></div>
<p>可以看到在第101,102行左右，HR值从0.9变成了1.0，此时对应的年龄大概是48岁，所以我们可以在年龄为48的位置增加一条竖线，以此来区分HR。</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="1039-nonlinearfit.html#cb648-1" aria-hidden="true" tabindex="-1"></a>dd<span class="sc">$</span>limits<span class="sc">$</span>age[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">48</span> <span class="co"># 重新选择HR为1的点</span></span>
<span id="cb648-2"><a href="1039-nonlinearfit.html#cb648-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">update</span>(fit) <span class="co"># 更新模型</span></span>
<span id="cb648-3"><a href="1039-nonlinearfit.html#cb648-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb648-4"><a href="1039-nonlinearfit.html#cb648-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 重新画图</span></span>
<span id="cb648-5"><a href="1039-nonlinearfit.html#cb648-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">Predict</span>(fit, age,<span class="at">fun =</span> exp, <span class="at">ref.zero =</span> T))<span class="sc">+</span> </span>
<span id="cb648-6"><a href="1039-nonlinearfit.html#cb648-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>,<span class="at">linetype=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span> <span class="co"># HR=1的横线</span></span>
<span id="cb648-7"><a href="1039-nonlinearfit.html#cb648-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">48</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">linetype=</span><span class="dv">2</span>,<span class="at">size=</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb648-8"><a href="1039-nonlinearfit.html#cb648-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="1039-nonlinearfit_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>除此之外，你也可以用返回的数据自己用<code>ggplot2</code>画。</p>
<p>以上就是限制性立方样条回归的演示。</p>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="1038-p4trend.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="1040-appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
