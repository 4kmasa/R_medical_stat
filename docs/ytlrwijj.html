<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 R语言方差分析注意事项 | R语言实战医学统计</title>
  <meta name="description" content="10 R语言方差分析注意事项 | R语言实战医学统计" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="10 R语言方差分析注意事项 | R语言实战医学统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="10 R语言方差分析注意事项 | R语言实战医学统计" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 R语言方差分析注意事项 | R语言实战医学统计" />
  
  <meta name="twitter:description" content="10 R语言方差分析注意事项 | R语言实战医学统计" />
  

<meta name="author" content="阿越就是我" />


<meta name="date" content="2023-06-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rugnjkdfgl.html"/>
<link rel="next" href="terlajskd.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R语言实战医学统计</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本书缘起"><i class="fa fa-check"></i>本书缘起</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#作者简介"><i class="fa fa-check"></i>作者简介</a></li>
</ul></li>
<li class="part"><span><b>I 基础统计分析</b></span></li>
<li class="chapter" data-level="1" data-path="sdjfl.html"><a href="sdjfl.html"><i class="fa fa-check"></i><b>1</b> t检验</a>
<ul>
<li class="chapter" data-level="1.1" data-path="sdjfl.html"><a href="sdjfl.html#单样本t检验"><i class="fa fa-check"></i><b>1.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="1.2" data-path="sdjfl.html"><a href="sdjfl.html#配对样本t检验"><i class="fa fa-check"></i><b>1.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="1.3" data-path="sdjfl.html"><a href="sdjfl.html#两样本t检验"><i class="fa fa-check"></i><b>1.3</b> 两样本t检验</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="xnclg.html"><a href="xnclg.html"><i class="fa fa-check"></i><b>2</b> 多样本均数比较的方差分析</a>
<ul>
<li class="chapter" data-level="2.1" data-path="xnclg.html"><a href="xnclg.html#完全随机设计资料的方差分析"><i class="fa fa-check"></i><b>2.1</b> 完全随机设计资料的方差分析</a></li>
<li class="chapter" data-level="2.2" data-path="xnclg.html"><a href="xnclg.html#随机区组设计资料的方差分析"><i class="fa fa-check"></i><b>2.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="2.3" data-path="xnclg.html"><a href="xnclg.html#拉丁方设计方差分析"><i class="fa fa-check"></i><b>2.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="2.4" data-path="xnclg.html"><a href="xnclg.html#两阶段交叉设计资料方差分析"><i class="fa fa-check"></i><b>2.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="2.5" data-path="xnclg.html"><a href="xnclg.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>2.5</b> 多个样本均数间的多重比较</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="xnclg.html"><a href="xnclg.html#lsd-t检验"><i class="fa fa-check"></i><b>2.5.1</b> LSD-t检验</a></li>
<li class="chapter" data-level="2.5.2" data-path="xnclg.html"><a href="xnclg.html#tukeyhsd"><i class="fa fa-check"></i><b>2.5.2</b> TukeyHSD</a></li>
<li class="chapter" data-level="2.5.3" data-path="xnclg.html"><a href="xnclg.html#dunnett-t检验"><i class="fa fa-check"></i><b>2.5.3</b> Dunnett-t检验</a></li>
<li class="chapter" data-level="2.5.4" data-path="xnclg.html"><a href="xnclg.html#snk-q检验"><i class="fa fa-check"></i><b>2.5.4</b> SNK-q检验</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="xnclg.html"><a href="xnclg.html#多样本方差比较的bartlett检验和levene检验"><i class="fa fa-check"></i><b>2.6</b> 多样本方差比较的Bartlett检验和Levene检验</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="xnclg.html"><a href="xnclg.html#多样本方差比较的bartlett检验"><i class="fa fa-check"></i><b>2.6.1</b> 多样本方差比较的Bartlett检验</a></li>
<li class="chapter" data-level="2.6.2" data-path="xnclg.html"><a href="xnclg.html#多样本方差比较的levene检验"><i class="fa fa-check"></i><b>2.6.2</b> 多样本方差比较的Levene检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="njlkga.html"><a href="njlkga.html"><i class="fa fa-check"></i><b>3</b> 多因素方差分析</a>
<ul>
<li class="chapter" data-level="3.1" data-path="njlkga.html"><a href="njlkga.html#x-2-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.1</b> 2 x 2 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.2" data-path="njlkga.html"><a href="njlkga.html#i-x-j-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.2</b> I x J 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.3" data-path="njlkga.html"><a href="njlkga.html#i-x-j-x-k-三因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.3</b> I x J x K 三因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.4" data-path="njlkga.html"><a href="njlkga.html#正交设计资料的方差分析"><i class="fa fa-check"></i><b>3.4</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="3.5" data-path="njlkga.html"><a href="njlkga.html#嵌套设计资料的方差分析"><i class="fa fa-check"></i><b>3.5</b> 嵌套设计资料的方差分析</a></li>
<li class="chapter" data-level="3.6" data-path="njlkga.html"><a href="njlkga.html#裂区设计资料的方差分析"><i class="fa fa-check"></i><b>3.6</b> 裂区设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="iegljgk.html"><a href="iegljgk.html"><i class="fa fa-check"></i><b>4</b> 重复测量方差分析</a>
<ul>
<li class="chapter" data-level="4.1" data-path="iegljgk.html"><a href="iegljgk.html#重复测量数据两因素两水平的方差分析"><i class="fa fa-check"></i><b>4.1</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="4.2" data-path="iegljgk.html"><a href="iegljgk.html#重复测量数据两因素多水平的分析"><i class="fa fa-check"></i><b>4.2</b> 重复测量数据两因素多水平的分析</a></li>
<li class="chapter" data-level="4.3" data-path="iegljgk.html"><a href="iegljgk.html#重复测量数据的多重比较"><i class="fa fa-check"></i><b>4.3</b> 重复测量数据的多重比较</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="iegljgk.html"><a href="iegljgk.html#组间差别多重比较"><i class="fa fa-check"></i><b>4.3.1</b> 组间差别多重比较</a></li>
<li class="chapter" data-level="4.3.2" data-path="iegljgk.html"><a href="iegljgk.html#时间趋势比较"><i class="fa fa-check"></i><b>4.3.2</b> 时间趋势比较</a></li>
<li class="chapter" data-level="4.3.3" data-path="iegljgk.html"><a href="iegljgk.html#时间点比较"><i class="fa fa-check"></i><b>4.3.3</b> 时间点比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lasijdlfjd.html"><a href="lasijdlfjd.html"><i class="fa fa-check"></i><b>5</b> 协方差分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="lasijdlfjd.html"><a href="lasijdlfjd.html#完全随机设计资料的协方差分析"><i class="fa fa-check"></i><b>5.1</b> 完全随机设计资料的协方差分析</a></li>
<li class="chapter" data-level="5.2" data-path="lasijdlfjd.html"><a href="lasijdlfjd.html#使用rstatix进行优雅的协方差分析"><i class="fa fa-check"></i><b>5.2</b> 使用rstatix进行优雅的协方差分析</a></li>
<li class="chapter" data-level="5.3" data-path="lasijdlfjd.html"><a href="lasijdlfjd.html#随机区组设计资料的协方差分析"><i class="fa fa-check"></i><b>5.3</b> 随机区组设计资料的协方差分析</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="aspljsffjd.html"><a href="aspljsffjd.html"><i class="fa fa-check"></i><b>6</b> 卡方检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aspljsffjd.html"><a href="aspljsffjd.html#不同类型卡方检验的选择"><i class="fa fa-check"></i><b>6.1</b> 不同类型卡方检验的选择</a></li>
<li class="chapter" data-level="6.2" data-path="aspljsffjd.html"><a href="aspljsffjd.html#四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.2</b> 四格表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="aspljsffjd.html"><a href="aspljsffjd.html#方法1"><i class="fa fa-check"></i><b>6.2.1</b> 方法1</a></li>
<li class="chapter" data-level="6.2.2" data-path="aspljsffjd.html"><a href="aspljsffjd.html#方法2"><i class="fa fa-check"></i><b>6.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="aspljsffjd.html"><a href="aspljsffjd.html#配对四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.3</b> 配对四格表资料的卡方检验</a></li>
<li class="chapter" data-level="6.4" data-path="aspljsffjd.html"><a href="aspljsffjd.html#四格表资料的-fisher-确切概率法"><i class="fa fa-check"></i><b>6.4</b> 四格表资料的 Fisher 确切概率法</a></li>
<li class="chapter" data-level="6.5" data-path="aspljsffjd.html"><a href="aspljsffjd.html#行-x-列表资料的卡方检验"><i class="fa fa-check"></i><b>6.5</b> 行 x 列表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aspljsffjd.html"><a href="aspljsffjd.html#多个样本率的比较"><i class="fa fa-check"></i><b>6.5.1</b> 多个样本率的比较</a></li>
<li class="chapter" data-level="6.5.2" data-path="aspljsffjd.html"><a href="aspljsffjd.html#样本构成比的比较"><i class="fa fa-check"></i><b>6.5.2</b> 样本构成比的比较</a></li>
<li class="chapter" data-level="6.5.3" data-path="aspljsffjd.html"><a href="aspljsffjd.html#双向无序分类资料的关联性检验"><i class="fa fa-check"></i><b>6.5.3</b> 双向无序分类资料的关联性检验</a></li>
<li class="chapter" data-level="6.5.4" data-path="aspljsffjd.html"><a href="aspljsffjd.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>6.5.4</b> 双向有序分组资料的线性趋势检验</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="aspljsffjd.html"><a href="aspljsffjd.html#多个样本率间的多重比较"><i class="fa fa-check"></i><b>6.6</b> 多个样本率间的多重比较</a></li>
<li class="chapter" data-level="6.7" data-path="aspljsffjd.html"><a href="aspljsffjd.html#cochran-mantel-haenszel-卡方统计量检验"><i class="fa fa-check"></i><b>6.7</b> Cochran-Mantel-Haenszel 卡方统计量检验</a></li>
<li class="chapter" data-level="6.8" data-path="aspljsffjd.html"><a href="aspljsffjd.html#频数分布拟合优度卡方检验"><i class="fa fa-check"></i><b>6.8</b> 频数分布拟合优度卡方检验</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="lidukj.html"><a href="lidukj.html"><i class="fa fa-check"></i><b>7</b> 秩和检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="lidukj.html"><a href="lidukj.html#配对样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.1</b> 配对样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.2" data-path="lidukj.html"><a href="lidukj.html#两独立样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.2</b> 两独立样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.3" data-path="lidukj.html"><a href="lidukj.html#完全随机设计多个样本比较的-kruskal-wallis-h-检验"><i class="fa fa-check"></i><b>7.3</b> 完全随机设计多个样本比较的 Kruskal-Wallis H 检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="lidukj.html"><a href="lidukj.html#多样本比较的kruskal-wallis-h检验"><i class="fa fa-check"></i><b>7.3.1</b> 多样本比较的kruskal-wallis H检验</a></li>
<li class="chapter" data-level="7.3.2" data-path="lidukj.html"><a href="lidukj.html#kruskal-wallis-h检验后的多重比较"><i class="fa fa-check"></i><b>7.3.2</b> kruskal-Wallis H检验后的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="lidukj.html"><a href="lidukj.html#随记区组设计多个样本比较的-friedman-m-检验"><i class="fa fa-check"></i><b>7.4</b> 随记区组设计多个样本比较的 Friedman M 检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="lidukj.html"><a href="lidukj.html#多个相关样本比较的friedman-m检验"><i class="fa fa-check"></i><b>7.4.1</b> 多个相关样本比较的Friedman M检验</a></li>
<li class="chapter" data-level="7.4.2" data-path="lidukj.html"><a href="lidukj.html#多个相关样本两两比较的q检验"><i class="fa fa-check"></i><b>7.4.2</b> 多个相关样本两两比较的q检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="yruugkjh.html"><a href="yruugkjh.html"><i class="fa fa-check"></i><b>8</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1" data-path="yruugkjh.html"><a href="yruugkjh.html#球对称检验"><i class="fa fa-check"></i><b>8.1</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="yruugkjh.html"><a href="yruugkjh.html#使用课本表12-3的数据"><i class="fa fa-check"></i><b>8.1.1</b> 使用课本<strong>表12-3</strong>的数据</a></li>
<li class="chapter" data-level="8.1.2" data-path="yruugkjh.html"><a href="yruugkjh.html#使用课本例12-3的数据"><i class="fa fa-check"></i><b>8.1.2</b> 使用课本<strong>例12-3</strong>的数据</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="rugnjkdfgl.html"><a href="rugnjkdfgl.html"><i class="fa fa-check"></i><b>9</b> R语言Cochran Armitage检验</a></li>
<li class="chapter" data-level="10" data-path="ytlrwijj.html"><a href="ytlrwijj.html"><i class="fa fa-check"></i><b>10</b> R语言方差分析注意事项</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ytlrwijj.html"><a href="ytlrwijj.html#均衡设计和非均衡设计"><i class="fa fa-check"></i><b>10.1</b> 均衡设计和非均衡设计</a></li>
<li class="chapter" data-level="10.2" data-path="ytlrwijj.html"><a href="ytlrwijj.html#方差分析的3种类型"><i class="fa fa-check"></i><b>10.2</b> 方差分析的3种类型</a></li>
<li class="chapter" data-level="10.3" data-path="ytlrwijj.html"><a href="ytlrwijj.html#示例"><i class="fa fa-check"></i><b>10.3</b> 示例</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ytlrwijj.html"><a href="ytlrwijj.html#one-way-anova"><i class="fa fa-check"></i><b>10.3.1</b> one-way anova</a></li>
<li class="chapter" data-level="10.3.2" data-path="ytlrwijj.html"><a href="ytlrwijj.html#two-way-anova"><i class="fa fa-check"></i><b>10.3.2</b> two-way anova</a></li>
<li class="chapter" data-level="10.3.3" data-path="ytlrwijj.html"><a href="ytlrwijj.html#协方差分析"><i class="fa fa-check"></i><b>10.3.3</b> 协方差分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="terlajskd.html"><a href="terlajskd.html"><i class="fa fa-check"></i><b>11</b> 样本量计算</a>
<ul>
<li class="chapter" data-level="11.1" data-path="terlajskd.html"><a href="terlajskd.html#t检验的样本量计算"><i class="fa fa-check"></i><b>11.1</b> t检验的样本量计算</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="terlajskd.html"><a href="terlajskd.html#单样本t检验样本均数和已知总体均数比较"><i class="fa fa-check"></i><b>11.1.1</b> 单样本t检验（样本均数和已知总体均数比较）</a></li>
<li class="chapter" data-level="11.1.2" data-path="terlajskd.html"><a href="terlajskd.html#两样本t检验两样本均数比较"><i class="fa fa-check"></i><b>11.1.2</b> 两样本t检验（两样本均数比较）</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="terlajskd.html"><a href="terlajskd.html#多样本均数比较"><i class="fa fa-check"></i><b>11.2</b> 多样本均数比较</a></li>
<li class="chapter" data-level="11.3" data-path="terlajskd.html"><a href="terlajskd.html#样本率和已知总体率的比较"><i class="fa fa-check"></i><b>11.3</b> 样本率和已知总体率的比较</a></li>
<li class="chapter" data-level="11.4" data-path="terlajskd.html"><a href="terlajskd.html#两独立样本率的比较"><i class="fa fa-check"></i><b>11.4</b> 两独立样本率的比较</a></li>
<li class="chapter" data-level="11.5" data-path="terlajskd.html"><a href="terlajskd.html#多样本率的比较"><i class="fa fa-check"></i><b>11.5</b> 多样本率的比较</a></li>
<li class="chapter" data-level="11.6" data-path="terlajskd.html"><a href="terlajskd.html#直线相关分析"><i class="fa fa-check"></i><b>11.6</b> 直线相关分析</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ytsgs.html"><a href="ytsgs.html"><i class="fa fa-check"></i><b>12</b> 随机分组</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ytsgs.html"><a href="ytsgs.html#简单随机"><i class="fa fa-check"></i><b>12.1</b> 简单随机</a></li>
<li class="chapter" data-level="12.2" data-path="ytsgs.html"><a href="ytsgs.html#区组随机"><i class="fa fa-check"></i><b>12.2</b> 区组随机</a></li>
<li class="chapter" data-level="12.3" data-path="ytsgs.html"><a href="ytsgs.html#分层随机"><i class="fa fa-check"></i><b>12.3</b> 分层随机</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html"><i class="fa fa-check"></i><b>13</b> R语言tidy风格医学统计学</a>
<ul>
<li class="chapter" data-level="13.1" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#主要函数"><i class="fa fa-check"></i><b>13.1</b> 主要函数</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#描述性统计"><i class="fa fa-check"></i><b>13.1.1</b> 描述性统计</a></li>
<li class="chapter" data-level="13.1.2" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#比较均值"><i class="fa fa-check"></i><b>13.1.2</b> 比较均值</a></li>
<li class="chapter" data-level="13.1.3" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#增强r中的anova"><i class="fa fa-check"></i><b>13.1.3</b> 增强R中的ANOVA</a></li>
<li class="chapter" data-level="13.1.4" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#事后检验post-hoc"><i class="fa fa-check"></i><b>13.1.4</b> 事后检验（post-hoc）</a></li>
<li class="chapter" data-level="13.1.5" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#比较比例"><i class="fa fa-check"></i><b>13.1.5</b> 比较比例</a></li>
<li class="chapter" data-level="13.1.6" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#比较方差"><i class="fa fa-check"></i><b>13.1.6</b> 比较方差</a></li>
<li class="chapter" data-level="13.1.7" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#计算效应量"><i class="fa fa-check"></i><b>13.1.7</b> 计算效应量</a></li>
<li class="chapter" data-level="13.1.8" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#相关性分析"><i class="fa fa-check"></i><b>13.1.8</b> 相关性分析</a></li>
<li class="chapter" data-level="13.1.9" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#添加p值和显著性标记"><i class="fa fa-check"></i><b>13.1.9</b> 添加P值和显著性标记</a></li>
<li class="chapter" data-level="13.1.10" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#提取统计信息"><i class="fa fa-check"></i><b>13.1.10</b> 提取统计信息</a></li>
<li class="chapter" data-level="13.1.11" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#数据处理辅助函数"><i class="fa fa-check"></i><b>13.1.11</b> 数据处理辅助函数</a></li>
<li class="chapter" data-level="13.1.12" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#其他"><i class="fa fa-check"></i><b>13.1.12</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#安装和加载"><i class="fa fa-check"></i><b>13.2</b> 安装和加载</a></li>
<li class="chapter" data-level="13.3" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#描述性统计-1"><i class="fa fa-check"></i><b>13.3</b> 描述性统计</a></li>
<li class="chapter" data-level="13.4" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#t检验"><i class="fa fa-check"></i><b>13.4</b> t检验</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#单样本t检验-1"><i class="fa fa-check"></i><b>13.4.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="13.4.2" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#配对t检验"><i class="fa fa-check"></i><b>13.4.2</b> 配对t检验</a></li>
<li class="chapter" data-level="13.4.3" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#两样本t检验-1"><i class="fa fa-check"></i><b>13.4.3</b> 两样本t检验</a></li>
<li class="chapter" data-level="13.4.4" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#分组后进行比较"><i class="fa fa-check"></i><b>13.4.4</b> 分组后进行比较</a></li>
<li class="chapter" data-level="13.4.5" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#多组间的两两比较"><i class="fa fa-check"></i><b>13.4.5</b> 多组间的两两比较</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#方差分析"><i class="fa fa-check"></i><b>13.5</b> 方差分析</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#完全随机设计方差分析"><i class="fa fa-check"></i><b>13.5.1</b> 完全随机设计方差分析</a></li>
<li class="chapter" data-level="13.5.2" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#随机区组设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.3" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#拉丁方设计方差分析-1"><i class="fa fa-check"></i><b>13.5.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="13.5.4" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#两阶段交叉设计资料方差分析-1"><i class="fa fa-check"></i><b>13.5.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="13.5.5" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#析因设计资料的方差分析"><i class="fa fa-check"></i><b>13.5.5</b> 析因设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.6" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#正交设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.6</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.7" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#重复测量数据两因素两水平的方差分析-1"><i class="fa fa-check"></i><b>13.5.7</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="13.5.8" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#重复测量数据两因素多水平的分析-1"><i class="fa fa-check"></i><b>13.5.8</b> 重复测量数据两因素多水平的分析</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#相关分析"><i class="fa fa-check"></i><b>13.6</b> 相关分析</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#两个变量"><i class="fa fa-check"></i><b>13.6.1</b> 两个变量</a></li>
<li class="chapter" data-level="13.6.2" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#一个变量和其他所有变量"><i class="fa fa-check"></i><b>13.6.2</b> 一个变量和其他所有变量</a></li>
<li class="chapter" data-level="13.6.3" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#所有变量间两两相关性"><i class="fa fa-check"></i><b>13.6.3</b> 所有变量间两两相关性</a></li>
<li class="chapter" data-level="13.6.4" data-path="yaiehfkjasd.html"><a href="yaiehfkjasd.html#相关矩阵"><i class="fa fa-check"></i><b>13.6.4</b> 相关矩阵</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tjslrkjga.html"><a href="tjslrkjga.html"><i class="fa fa-check"></i><b>14</b> R语言多个变量同时进行t检验</a>
<ul>
<li class="chapter" data-level="14.1" data-path="tjslrkjga.html"><a href="tjslrkjga.html#简介"><i class="fa fa-check"></i><b>14.1</b> 简介</a></li>
<li class="chapter" data-level="14.2" data-path="tjslrkjga.html"><a href="tjslrkjga.html#实战"><i class="fa fa-check"></i><b>14.2</b> 实战</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="oirjglsj.html"><a href="oirjglsj.html"><i class="fa fa-check"></i><b>15</b> 双变量回归与相关</a>
<ul>
<li class="chapter" data-level="15.1" data-path="oirjglsj.html"><a href="oirjglsj.html#两样本相关"><i class="fa fa-check"></i><b>15.1</b> 两样本相关</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="jhgkjahdj.html"><a href="jhgkjahdj.html"><i class="fa fa-check"></i><b>16</b> 偏相关和典型相关</a>
<ul>
<li class="chapter" data-level="16.1" data-path="jhgkjahdj.html"><a href="jhgkjahdj.html#偏相关partial-correlation"><i class="fa fa-check"></i><b>16.1</b> 偏相关（partial correlation）</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="jhgkjahdj.html"><a href="jhgkjahdj.html#偏相关散点图"><i class="fa fa-check"></i><b>16.1.1</b> 偏相关散点图</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="jhgkjahdj.html"><a href="jhgkjahdj.html#典型相关canonical-correlation"><i class="fa fa-check"></i><b>16.2</b> 典型相关（Canonical Correlation）</a></li>
</ul></li>
<li class="part"><span><b>II 高级统计分析</b></span></li>
<li class="chapter" data-level="17" data-path="raljflksdj.html"><a href="raljflksdj.html"><i class="fa fa-check"></i><b>17</b> 多元线性回归</a>
<ul>
<li class="chapter" data-level="17.1" data-path="raljflksdj.html"><a href="raljflksdj.html#多元线性回归"><i class="fa fa-check"></i><b>17.1</b> 多元线性回归</a></li>
<li class="chapter" data-level="17.2" data-path="raljflksdj.html"><a href="raljflksdj.html#回归诊断"><i class="fa fa-check"></i><b>17.2</b> 回归诊断</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="raljflksdj.html"><a href="raljflksdj.html#可以通过看图来判断"><i class="fa fa-check"></i><b>17.2.1</b> 可以通过看图来判断</a></li>
<li class="chapter" data-level="17.2.2" data-path="raljflksdj.html"><a href="raljflksdj.html#也可以通过统计方法验证"><i class="fa fa-check"></i><b>17.2.2</b> 也可以通过统计方法验证</a></li>
<li class="chapter" data-level="17.2.3" data-path="raljflksdj.html"><a href="raljflksdj.html#多重共线性的检验"><i class="fa fa-check"></i><b>17.2.3</b> 多重共线性的检验</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="raljflksdj.html"><a href="raljflksdj.html#逐步选择法"><i class="fa fa-check"></i><b>17.3</b> 逐步选择法</a></li>
<li class="chapter" data-level="17.4" data-path="raljflksdj.html"><a href="raljflksdj.html#全局择优法"><i class="fa fa-check"></i><b>17.4</b> 全局择优法</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="rlkdfjj.html"><a href="rlkdfjj.html"><i class="fa fa-check"></i><b>18</b> Logistic回归</a>
<ul>
<li class="chapter" data-level="18.1" data-path="rlkdfjj.html"><a href="rlkdfjj.html#二项logistic回归"><i class="fa fa-check"></i><b>18.1</b> 二项logistic回归</a></li>
<li class="chapter" data-level="18.2" data-path="rlkdfjj.html"><a href="rlkdfjj.html#多项逻辑回归"><i class="fa fa-check"></i><b>18.2</b> 多项逻辑回归</a></li>
<li class="chapter" data-level="18.3" data-path="rlkdfjj.html"><a href="rlkdfjj.html#有序逻辑回归"><i class="fa fa-check"></i><b>18.3</b> 有序逻辑回归</a></li>
<li class="chapter" data-level="18.4" data-path="rlkdfjj.html"><a href="rlkdfjj.html#条件逻辑回归"><i class="fa fa-check"></i><b>18.4</b> 条件逻辑回归</a></li>
<li class="chapter" data-level="18.5" data-path="rlkdfjj.html"><a href="rlkdfjj.html#参考资料"><i class="fa fa-check"></i><b>18.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="tuishgh.html"><a href="tuishgh.html"><i class="fa fa-check"></i><b>19</b> 分类变量进行回归分析时的编码方案</a>
<ul>
<li class="chapter" data-level="19.1" data-path="tuishgh.html"><a href="tuishgh.html#演示数据"><i class="fa fa-check"></i><b>19.1</b> 演示数据</a></li>
<li class="chapter" data-level="19.2" data-path="tuishgh.html"><a href="tuishgh.html#dummy-coding"><i class="fa fa-check"></i><b>19.2</b> Dummy Coding</a></li>
<li class="chapter" data-level="19.3" data-path="tuishgh.html"><a href="tuishgh.html#simple-coding"><i class="fa fa-check"></i><b>19.3</b> simple coding</a></li>
<li class="chapter" data-level="19.4" data-path="tuishgh.html"><a href="tuishgh.html#deviation-coding"><i class="fa fa-check"></i><b>19.4</b> Deviation coding</a></li>
<li class="chapter" data-level="19.5" data-path="tuishgh.html"><a href="tuishgh.html#orthogonal-polynomial-coding"><i class="fa fa-check"></i><b>19.5</b> Orthogonal Polynomial Coding</a></li>
<li class="chapter" data-level="19.6" data-path="tuishgh.html"><a href="tuishgh.html#helmert-coding"><i class="fa fa-check"></i><b>19.6</b> Helmert Coding</a></li>
<li class="chapter" data-level="19.7" data-path="tuishgh.html"><a href="tuishgh.html#reverse-helmert-coding"><i class="fa fa-check"></i><b>19.7</b> Reverse Helmert Coding</a></li>
<li class="chapter" data-level="19.8" data-path="tuishgh.html"><a href="tuishgh.html#forward-difference-coding"><i class="fa fa-check"></i><b>19.8</b> Forward Difference Coding</a></li>
<li class="chapter" data-level="19.9" data-path="tuishgh.html"><a href="tuishgh.html#backward-difference-coding"><i class="fa fa-check"></i><b>19.9</b> Backward Difference Coding</a></li>
<li class="chapter" data-level="19.10" data-path="tuishgh.html"><a href="tuishgh.html#参考资料-1"><i class="fa fa-check"></i><b>19.10</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="erutgjdflk.html"><a href="erutgjdflk.html"><i class="fa fa-check"></i><b>20</b> R语言判别分析</a>
<ul>
<li class="chapter" data-level="20.1" data-path="erutgjdflk.html"><a href="erutgjdflk.html#fisher判别分析"><i class="fa fa-check"></i><b>20.1</b> Fisher判别分析</a></li>
<li class="chapter" data-level="20.2" data-path="erutgjdflk.html"><a href="erutgjdflk.html#bayes判别分析"><i class="fa fa-check"></i><b>20.2</b> Bayes判别分析</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html"><i class="fa fa-check"></i><b>21</b> R语言聚类分析</a>
<ul>
<li class="chapter" data-level="21.1" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html#系统聚类层次聚类hierarchical-clustering"><i class="fa fa-check"></i><b>21.1</b> 系统聚类（层次聚类,Hierarchical clustering）</a></li>
<li class="chapter" data-level="21.2" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html#聚类分析可视化"><i class="fa fa-check"></i><b>21.2</b> 聚类分析可视化</a></li>
<li class="chapter" data-level="21.3" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html#快速聚类划分聚类partitioning-clustering"><i class="fa fa-check"></i><b>21.3</b> 快速聚类（划分聚类,partitioning clustering）</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html#k-means聚类"><i class="fa fa-check"></i><b>21.3.1</b> K-means聚类</a></li>
<li class="chapter" data-level="21.3.2" data-path="lksdjgljdsl.html"><a href="lksdjgljdsl.html#围绕中心点的划分pam"><i class="fa fa-check"></i><b>21.3.2</b> 围绕中心点的划分PAM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ejtlj.html"><a href="ejtlj.html"><i class="fa fa-check"></i><b>22</b> R语言主成分分析</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ejtlj.html"><a href="ejtlj.html#加载数据"><i class="fa fa-check"></i><b>22.1</b> 加载数据</a></li>
<li class="chapter" data-level="22.2" data-path="ejtlj.html"><a href="ejtlj.html#相关性检验"><i class="fa fa-check"></i><b>22.2</b> 相关性检验</a></li>
<li class="chapter" data-level="22.3" data-path="ejtlj.html"><a href="ejtlj.html#kmo和bartlett球形检验"><i class="fa fa-check"></i><b>22.3</b> KMO和Bartlett球形检验</a></li>
<li class="chapter" data-level="22.4" data-path="ejtlj.html"><a href="ejtlj.html#r自带的pca"><i class="fa fa-check"></i><b>22.4</b> R自带的PCA</a></li>
<li class="chapter" data-level="22.5" data-path="ejtlj.html"><a href="ejtlj.html#结果可视化"><i class="fa fa-check"></i><b>22.5</b> 结果可视化</a></li>
<li class="chapter" data-level="22.6" data-path="ejtlj.html"><a href="ejtlj.html#主成分分析可视化超详细"><i class="fa fa-check"></i><b>22.6</b> 主成分分析可视化(超详细)</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="ejtlj.html"><a href="ejtlj.html#进行pca分析"><i class="fa fa-check"></i><b>22.6.1</b> 进行PCA分析</a></li>
<li class="chapter" data-level="22.6.2" data-path="ejtlj.html"><a href="ejtlj.html#特征值可视化"><i class="fa fa-check"></i><b>22.6.2</b> 特征值可视化</a></li>
<li class="chapter" data-level="22.6.3" data-path="ejtlj.html"><a href="ejtlj.html#提取变量结果"><i class="fa fa-check"></i><b>22.6.3</b> 提取变量结果</a></li>
<li class="chapter" data-level="22.6.4" data-path="ejtlj.html"><a href="ejtlj.html#变量结果可视化"><i class="fa fa-check"></i><b>22.6.4</b> 变量结果可视化</a></li>
<li class="chapter" data-level="22.6.5" data-path="ejtlj.html"><a href="ejtlj.html#dimension-description"><i class="fa fa-check"></i><b>22.6.5</b> Dimension description</a></li>
<li class="chapter" data-level="22.6.6" data-path="ejtlj.html"><a href="ejtlj.html#提取样本结果"><i class="fa fa-check"></i><b>22.6.6</b> 提取样本结果</a></li>
<li class="chapter" data-level="22.6.7" data-path="ejtlj.html"><a href="ejtlj.html#样本结果可视化"><i class="fa fa-check"></i><b>22.6.7</b> 样本结果可视化</a></li>
<li class="chapter" data-level="22.6.8" data-path="ejtlj.html"><a href="ejtlj.html#biplot"><i class="fa fa-check"></i><b>22.6.8</b> biplot</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="ejtlj.html"><a href="ejtlj.html#主成分分析可视化3d版"><i class="fa fa-check"></i><b>22.7</b> 主成分分析可视化3d版</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="ejtlj.html"><a href="ejtlj.html#提取数据"><i class="fa fa-check"></i><b>22.7.1</b> 提取数据</a></li>
<li class="chapter" data-level="22.7.2" data-path="ejtlj.html"><a href="ejtlj.html#d版"><i class="fa fa-check"></i><b>22.7.2</b> 3d版</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="iurgsdh.html"><a href="iurgsdh.html"><i class="fa fa-check"></i><b>23</b> R语言因子分析</a>
<ul>
<li class="chapter" data-level="23.1" data-path="iurgsdh.html"><a href="iurgsdh.html#演示数据-1"><i class="fa fa-check"></i><b>23.1</b> 演示数据</a></li>
<li class="chapter" data-level="23.2" data-path="iurgsdh.html"><a href="iurgsdh.html#判断需要提取的因子个数"><i class="fa fa-check"></i><b>23.2</b> 判断需要提取的因子个数</a></li>
<li class="chapter" data-level="23.3" data-path="iurgsdh.html"><a href="iurgsdh.html#进行因子分析"><i class="fa fa-check"></i><b>23.3</b> 进行因子分析</a></li>
<li class="chapter" data-level="23.4" data-path="iurgsdh.html"><a href="iurgsdh.html#因子旋转"><i class="fa fa-check"></i><b>23.4</b> 因子旋转</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ljhgjsj.html"><a href="ljhgjsj.html"><i class="fa fa-check"></i><b>24</b> 二分类资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="24.1" data-path="ljhgjsj.html"><a href="ljhgjsj.html#方法1-1"><i class="fa fa-check"></i><b>24.1</b> 方法1</a></li>
<li class="chapter" data-level="24.2" data-path="ljhgjsj.html"><a href="ljhgjsj.html#方法2-1"><i class="fa fa-check"></i><b>24.2</b> 方法2</a></li>
<li class="chapter" data-level="24.3" data-path="ljhgjsj.html"><a href="ljhgjsj.html#方法3"><i class="fa fa-check"></i><b>24.3</b> 方法3</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="xlkjgj.html"><a href="xlkjgj.html"><i class="fa fa-check"></i><b>25</b> 生存资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="25.1" data-path="xlkjgj.html"><a href="xlkjgj.html#加载r包和数据"><i class="fa fa-check"></i><b>25.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="25.2" data-path="xlkjgj.html"><a href="xlkjgj.html#多个时间点roc"><i class="fa fa-check"></i><b>25.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="25.3" data-path="xlkjgj.html"><a href="xlkjgj.html#多指标roc"><i class="fa fa-check"></i><b>25.3</b> 多指标ROC</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="lsjdglj.html"><a href="lsjdglj.html"><i class="fa fa-check"></i><b>26</b> 生存资料ROC曲线的最佳截点和平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1" data-path="lsjdglj.html"><a href="lsjdglj.html#平滑曲线"><i class="fa fa-check"></i><b>26.1</b> 平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="lsjdglj.html"><a href="lsjdglj.html#加载r包和数据-1"><i class="fa fa-check"></i><b>26.1.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="26.1.2" data-path="lsjdglj.html"><a href="lsjdglj.html#多个时间点roc-1"><i class="fa fa-check"></i><b>26.1.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="26.1.3" data-path="lsjdglj.html"><a href="lsjdglj.html#画平滑曲线"><i class="fa fa-check"></i><b>26.1.3</b> 画平滑曲线</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="lsjdglj.html"><a href="lsjdglj.html#找最佳截点"><i class="fa fa-check"></i><b>26.2</b> 找最佳截点</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="oljgja.html"><a href="oljgja.html"><i class="fa fa-check"></i><b>27</b> ROC曲线的显著性检验</a>
<ul>
<li class="chapter" data-level="27.1" data-path="oljgja.html"><a href="oljgja.html#二分类资料的roc比较"><i class="fa fa-check"></i><b>27.1</b> 二分类资料的ROC比较</a></li>
<li class="chapter" data-level="27.2" data-path="oljgja.html"><a href="oljgja.html#生存资料roc的比较"><i class="fa fa-check"></i><b>27.2</b> 生存资料ROC的比较</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="uxijsjg.html"><a href="uxijsjg.html"><i class="fa fa-check"></i><b>28</b> ROC阴性结果还是阳性结果</a>
<ul>
<li class="chapter" data-level="28.1" data-path="uxijsjg.html"><a href="uxijsjg.html#探索roc曲线"><i class="fa fa-check"></i><b>28.1</b> 探索ROC曲线</a></li>
<li class="chapter" data-level="28.2" data-path="uxijsjg.html"><a href="uxijsjg.html#反过来可以吗"><i class="fa fa-check"></i><b>28.2</b> 反过来可以吗？</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="yrlhksdg.html"><a href="yrlhksdg.html"><i class="fa fa-check"></i><b>29</b> ROC曲线ggplot2绘制</a>
<ul>
<li class="chapter" data-level="29.1" data-path="yrlhksdg.html"><a href="yrlhksdg.html#准备数据"><i class="fa fa-check"></i><b>29.1</b> 准备数据</a></li>
<li class="chapter" data-level="29.2" data-path="yrlhksdg.html"><a href="yrlhksdg.html#计算"><i class="fa fa-check"></i><b>29.2</b> 计算</a></li>
<li class="chapter" data-level="29.3" data-path="yrlhksdg.html"><a href="yrlhksdg.html#画图"><i class="fa fa-check"></i><b>29.3</b> 画图</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="sjgjaklj.html"><a href="sjgjaklj.html"><i class="fa fa-check"></i><b>30</b> R语言计算AUC(ROC)注意事项</a>
<ul>
<li class="chapter" data-level="30.1" data-path="sjgjaklj.html"><a href="sjgjaklj.html#准备数据-1"><i class="fa fa-check"></i><b>30.1</b> 准备数据</a></li>
<li class="chapter" data-level="30.2" data-path="sjgjaklj.html"><a href="sjgjaklj.html#rocr"><i class="fa fa-check"></i><b>30.2</b> ROCR</a></li>
<li class="chapter" data-level="30.3" data-path="sjgjaklj.html"><a href="sjgjaklj.html#proc"><i class="fa fa-check"></i><b>30.3</b> pROC</a></li>
<li class="chapter" data-level="30.4" data-path="sjgjaklj.html"><a href="sjgjaklj.html#yardstick"><i class="fa fa-check"></i><b>30.4</b> yardstick</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="oljgji.html"><a href="oljgji.html"><i class="fa fa-check"></i><b>31</b> 多指标联合诊断的ROC曲线</a>
<ul>
<li class="chapter" data-level="31.1" data-path="oljgji.html"><a href="oljgji.html#准备数据-2"><i class="fa fa-check"></i><b>31.1</b> 准备数据</a></li>
<li class="chapter" data-level="31.2" data-path="oljgji.html"><a href="oljgji.html#多指标联合诊断的roc"><i class="fa fa-check"></i><b>31.2</b> 多指标联合诊断的ROC</a></li>
<li class="chapter" data-level="31.3" data-path="oljgji.html"><a href="oljgji.html#测试集怎么办"><i class="fa fa-check"></i><b>31.3</b> 测试集怎么办？</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="djgkas.html"><a href="djgkas.html"><i class="fa fa-check"></i><b>32</b> R语言生存分析</a>
<ul>
<li class="chapter" data-level="32.1" data-path="djgkas.html"><a href="djgkas.html#生存过程的描述"><i class="fa fa-check"></i><b>32.1</b> 生存过程的描述</a></li>
<li class="chapter" data-level="32.2" data-path="djgkas.html"><a href="djgkas.html#生存过程的比较"><i class="fa fa-check"></i><b>32.2</b> 生存过程的比较</a></li>
<li class="chapter" data-level="32.3" data-path="djgkas.html"><a href="djgkas.html#cox回归"><i class="fa fa-check"></i><b>32.3</b> Cox回归</a></li>
<li class="chapter" data-level="32.4" data-path="djgkas.html"><a href="djgkas.html#时间依存协变量的cox回归和时间依存系数cox回归"><i class="fa fa-check"></i><b>32.4</b> 时间依存协变量的Cox回归和时间依存系数Cox回归</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="djgkas.html"><a href="djgkas.html#对时间分层"><i class="fa fa-check"></i><b>32.4.1</b> 对时间分层</a></li>
<li class="chapter" data-level="32.4.2" data-path="djgkas.html"><a href="djgkas.html#连续性时依系数变换"><i class="fa fa-check"></i><b>32.4.2</b> 连续性时依系数变换</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="djgkas.html"><a href="djgkas.html#参考资料-2"><i class="fa fa-check"></i><b>32.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html"><i class="fa fa-check"></i><b>33</b> R语言超详细的生存曲线可视化</a>
<ul>
<li class="chapter" data-level="33.1" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#演示数据-2"><i class="fa fa-check"></i><b>33.1</b> 演示数据</a></li>
<li class="chapter" data-level="33.2" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#基本的生存曲线"><i class="fa fa-check"></i><b>33.2</b> 基本的生存曲线</a></li>
<li class="chapter" data-level="33.3" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#增加-risk-table"><i class="fa fa-check"></i><b>33.3</b> 增加 risk table</a></li>
<li class="chapter" data-level="33.4" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#增加删失时间表ncensor-plot"><i class="fa fa-check"></i><b>33.4</b> 增加删失时间表ncensor plot</a></li>
<li class="chapter" data-level="33.5" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#超级无敌精细化自定设置"><i class="fa fa-check"></i><b>33.5</b> 超级无敌精细化自定设置</a></li>
<li class="chapter" data-level="33.6" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#多个组的生存曲线"><i class="fa fa-check"></i><b>33.6</b> 多个组的生存曲线</a></li>
<li class="chapter" data-level="33.7" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#多个分类变量分面绘制"><i class="fa fa-check"></i><b>33.7</b> 多个分类变量分面绘制</a></li>
<li class="chapter" data-level="33.8" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#同时绘制多个生存函数"><i class="fa fa-check"></i><b>33.8</b> 同时绘制多个生存函数</a></li>
<li class="chapter" data-level="33.9" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#根据某一个变量分组绘制"><i class="fa fa-check"></i><b>33.9</b> 根据某一个变量分组绘制</a></li>
<li class="chapter" data-level="33.10" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#在原有生存曲线的基础上增加"><i class="fa fa-check"></i><b>33.10</b> 在原有生存曲线的基础上增加</a></li>
<li class="chapter" data-level="33.11" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#多个生存函数画在一起"><i class="fa fa-check"></i><b>33.11</b> 多个生存函数画在一起</a></li>
<li class="chapter" data-level="33.12" data-path="oiewjrtsjl.html"><a href="oiewjrtsjl.html#参考资料-3"><i class="fa fa-check"></i><b>33.12</b> 参考资料</a></li>
</ul></li>
<li class="part"><span><b>III 文献中常用的统计方法</b></span></li>
<li class="chapter" data-level="34" data-path="lxjjgjja.html"><a href="lxjjgjja.html"><i class="fa fa-check"></i><b>34</b> Fine-Gray检验、竞争风险模型列线图绘制</a>
<ul>
<li class="chapter" data-level="34.1" data-path="lxjjgjja.html"><a href="lxjjgjja.html#加载数据和r包"><i class="fa fa-check"></i><b>34.1</b> 加载数据和R包</a></li>
<li class="chapter" data-level="34.2" data-path="lxjjgjja.html"><a href="lxjjgjja.html#fine-gray检验单因素分析"><i class="fa fa-check"></i><b>34.2</b> Fine-Gray检验（单因素分析）</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="lxjjgjja.html"><a href="lxjjgjja.html#图形展示结果"><i class="fa fa-check"></i><b>34.2.1</b> 图形展示结果</a></li>
<li class="chapter" data-level="34.2.2" data-path="lxjjgjja.html"><a href="lxjjgjja.html#ggplot2"><i class="fa fa-check"></i><b>34.2.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="lxjjgjja.html"><a href="lxjjgjja.html#竞争风险模型多因素分析"><i class="fa fa-check"></i><b>34.3</b> 竞争风险模型（多因素分析）</a></li>
<li class="chapter" data-level="34.4" data-path="lxjjgjja.html"><a href="lxjjgjja.html#列线图"><i class="fa fa-check"></i><b>34.4</b> 列线图</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html"><i class="fa fa-check"></i><b>35</b> R语言倾向性评分：匹配</a>
<ul>
<li class="chapter" data-level="35.1" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#准备数据-3"><i class="fa fa-check"></i><b>35.1</b> 准备数据</a></li>
<li class="chapter" data-level="35.2" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#matchit包进行psm"><i class="fa fa-check"></i><b>35.2</b> matchIt包进行PSM</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#使用随机森林计算ps"><i class="fa fa-check"></i><b>35.2.1</b> 使用随机森林计算PS</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#主要匹配方法选择"><i class="fa fa-check"></i><b>35.3</b> 主要匹配方法选择</a></li>
<li class="chapter" data-level="35.4" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#匹配后数据的平衡性检验"><i class="fa fa-check"></i><b>35.4</b> 匹配后数据的平衡性检验</a>
<ul>
<li class="chapter" data-level="35.4.1" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#cobalt包"><i class="fa fa-check"></i><b>35.4.1</b> cobalt包</a></li>
<li class="chapter" data-level="35.4.2" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#统计检验衡量均衡性"><i class="fa fa-check"></i><b>35.4.2</b> 统计检验衡量均衡性</a></li>
</ul></li>
<li class="chapter" data-level="35.5" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#结果可视化-1"><i class="fa fa-check"></i><b>35.5</b> 结果可视化</a></li>
<li class="chapter" data-level="35.6" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#不平衡怎么办"><i class="fa fa-check"></i><b>35.6</b> 不平衡怎么办？</a></li>
<li class="chapter" data-level="35.7" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#其他问题"><i class="fa fa-check"></i><b>35.7</b> 其他问题</a></li>
<li class="chapter" data-level="35.8" data-path="ysdkfjhsjk.html"><a href="ysdkfjhsjk.html#参考资料-4"><i class="fa fa-check"></i><b>35.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html"><i class="fa fa-check"></i><b>36</b> R语言倾向性评分：回归和分层</a>
<ul>
<li class="chapter" data-level="36.1" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#演示数据-3"><i class="fa fa-check"></i><b>36.1</b> 演示数据</a></li>
<li class="chapter" data-level="36.2" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#原始数据的概况"><i class="fa fa-check"></i><b>36.2</b> 原始数据的概况</a></li>
<li class="chapter" data-level="36.3" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#计算倾向性评分"><i class="fa fa-check"></i><b>36.3</b> 计算倾向性评分</a></li>
<li class="chapter" data-level="36.4" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#倾向性评分回归"><i class="fa fa-check"></i><b>36.4</b> 倾向性评分回归</a></li>
<li class="chapter" data-level="36.5" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#倾向性评分分层"><i class="fa fa-check"></i><b>36.5</b> 倾向性评分分层</a></li>
<li class="chapter" data-level="36.6" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#分层后的数据"><i class="fa fa-check"></i><b>36.6</b> 分层后的数据</a></li>
<li class="chapter" data-level="36.7" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#总结"><i class="fa fa-check"></i><b>36.7</b> 总结</a></li>
<li class="chapter" data-level="36.8" data-path="yxkskjhfk.html"><a href="yxkskjhfk.html#参考资料-5"><i class="fa fa-check"></i><b>36.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="yplksjhfk.html"><a href="yplksjhfk.html"><i class="fa fa-check"></i><b>37</b> R语言倾向性评分：加权</a>
<ul>
<li class="chapter" data-level="37.1" data-path="yplksjhfk.html"><a href="yplksjhfk.html#演示数据-4"><i class="fa fa-check"></i><b>37.1</b> 演示数据</a></li>
<li class="chapter" data-level="37.2" data-path="yplksjhfk.html"><a href="yplksjhfk.html#iptw"><i class="fa fa-check"></i><b>37.2</b> IPTW</a></li>
<li class="chapter" data-level="37.3" data-path="yplksjhfk.html"><a href="yplksjhfk.html#重叠加权"><i class="fa fa-check"></i><b>37.3</b> 重叠加权</a></li>
<li class="chapter" data-level="37.4" data-path="yplksjhfk.html"><a href="yplksjhfk.html#参考资料-6"><i class="fa fa-check"></i><b>37.4</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="qdkjfgj.html"><a href="qdkjfgj.html"><i class="fa fa-check"></i><b>38</b> p for trend/ p for interaction/ per 1 sd 的R语言实现</a>
<ul>
<li class="chapter" data-level="38.1" data-path="qdkjfgj.html"><a href="qdkjfgj.html#p-for-trend"><i class="fa fa-check"></i><b>38.1</b> P for trend</a></li>
<li class="chapter" data-level="38.2" data-path="qdkjfgj.html"><a href="qdkjfgj.html#p-for-interaction"><i class="fa fa-check"></i><b>38.2</b> p for interaction</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="qdkjfgj.html"><a href="qdkjfgj.html#方法1-2"><i class="fa fa-check"></i><b>38.2.1</b> 方法1</a></li>
<li class="chapter" data-level="38.2.2" data-path="qdkjfgj.html"><a href="qdkjfgj.html#方法2-2"><i class="fa fa-check"></i><b>38.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="qdkjfgj.html"><a href="qdkjfgj.html#per-1-sd"><i class="fa fa-check"></i><b>38.3</b> per 1 sd</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="jddsfsdf.html"><a href="jddsfsdf.html"><i class="fa fa-check"></i><b>39</b> R语言多项式拟合及样条回归</a>
<ul>
<li class="chapter" data-level="39.1" data-path="jddsfsdf.html"><a href="jddsfsdf.html#多项式拟合"><i class="fa fa-check"></i><b>39.1</b> 多项式拟合</a></li>
<li class="chapter" data-level="39.2" data-path="jddsfsdf.html"><a href="jddsfsdf.html#样条回归"><i class="fa fa-check"></i><b>39.2</b> 样条回归</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="jddsfsdf.html"><a href="jddsfsdf.html#线性的立方样条"><i class="fa fa-check"></i><b>39.2.1</b> 线性的立方样条</a></li>
<li class="chapter" data-level="39.2.2" data-path="jddsfsdf.html"><a href="jddsfsdf.html#逻辑回归的立方样条"><i class="fa fa-check"></i><b>39.2.2</b> 逻辑回归的立方样条</a></li>
<li class="chapter" data-level="39.2.3" data-path="jddsfsdf.html"><a href="jddsfsdf.html#cox回归的立方样条"><i class="fa fa-check"></i><b>39.2.3</b> cox回归的立方样条</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 附录</b></span></li>
<li class="chapter" data-level="40" data-path="jdkhfgjad.html"><a href="jdkhfgjad.html"><i class="fa fa-check"></i><b>40</b> R语言和R包安装</a>
<ul>
<li class="chapter" data-level="40.1" data-path="jdkhfgjad.html"><a href="jdkhfgjad.html#r语言rtoolsrstudio的安装"><i class="fa fa-check"></i><b>40.1</b> R语言、Rtools、Rstudio的安装</a></li>
<li class="chapter" data-level="40.2" data-path="jdkhfgjad.html"><a href="jdkhfgjad.html#r包安装"><i class="fa fa-check"></i><b>40.2</b> R包安装</a></li>
<li class="chapter" data-level="40.3" data-path="jdkhfgjad.html"><a href="jdkhfgjad.html#pass软件链接"><i class="fa fa-check"></i><b>40.3</b> PASS软件链接</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由bookdown强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言实战医学统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ytlrwijj" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">10</span> R语言方差分析注意事项<a href="ytlrwijj.html#ytlrwijj" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R语言做方差分析很简单，就是一个函数<code>aov()</code>，包括但不限于单因素方差分析、多因素方差分析、协方差分析、重复测量方差分析等，都是这个函数。</p>
<p>R语言做方差分析和SPSS/SAS等传统统计软件不太一样，下面说一下需要注意的地方，主要是2个点：
- 3种类型的方差分析
- 单因素协方差分析和two-way anova的区别</p>
<div id="均衡设计和非均衡设计" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> 均衡设计和非均衡设计<a href="ytlrwijj.html#均衡设计和非均衡设计" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>均衡设计是指不同组别之间的样本量相等，非均衡设计自然就是指不同组别之间样本量不相同。</p>
<p>医学研究中大部分都是均衡设计。</p>
</div>
<div id="方差分析的3种类型" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> 方差分析的3种类型<a href="ytlrwijj.html#方差分析的3种类型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>在计算方差分析中的平方和时，有3种类型（你可以简单理解为方差分析有3种类型），SPSS/SAS在做方差分析的时候，默认是<strong>类型Ⅲ</strong>，但是R语言中的<code>aov()</code>函数做方差分析时，默认是<strong>类型Ⅰ</strong>。</p>
<p>R语言中做方差分析是公式表示的，比如：<code>aov(y ~ A + B + A:B, data = df)</code>。</p>
<blockquote>
<p>表达式中效应的顺序在两种情况下会造成影响：(a)因子不止一个，并且是非平衡设计；(b)存在协变量。出现任意一种情况时，等式右边的变量都与其他每个变量相关。此时，我们无法清晰地划分它们对因变量的影响。一般来说，越基础性的效应越需要放在表达式前面。具体来讲，首先是协变量，然后是主效应，接着是双因素的交互项，再接着是三因素的交互项，以此类推。对于主效应，越基础性的变量越应放在表达式前面，因此性别要放在处理方式之前。有一个基本的准则：若研究设计不是正交的（也就是说，因子和/或协变量相关），一定要谨慎设置效应的顺序。–《R语言实战》</p>
</blockquote>
<p>也就是说：</p>
<ul>
<li>如果是均衡设计，3种类型的方差分析没有差别，这也是为什么之前的演示全都和SPSS结果一样的原因！</li>
<li>如果是非均衡设计，但是只存在组别因素（比如完全随机设计的方差分析），结果也是没有差别的！</li>
<li>如果是非均衡设计并且有多个因素，或者存在协变量时，3种类型方差分析的结果是不一样的！</li>
</ul>
<p>3种类型的区别可以参考下面这张图：</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="ytlrwijj.html#cb151-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;figs/Snipaste_2023-04-05_13-42-24.png&quot;</span>)</span></code></pre></div>
<p><img src="figs/Snipaste_2023-04-05_13-42-24.png" width="90%" /></p>
<p>R语言的<code>aov()</code>函数不能更改类型，但是我们通过其他R包实现更改类型。比如<code>car::Anova()</code>或者<code>rstatix</code>包。</p>
</div>
<div id="示例" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> 示例<a href="ytlrwijj.html#示例" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>使用3个简单的小例子进行演示。</p>
<div id="one-way-anova" class="section level3 hasAnchor" number="10.3.1">
<h3><span class="header-section-number">10.3.1</span> one-way anova<a href="ytlrwijj.html#one-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>首先是一个单因素（one-way anova）均衡设计的例子，来自课本<strong>例4-2</strong>。</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="ytlrwijj.html#cb152-1" aria-hidden="true" tabindex="-1"></a>trt<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group1&quot;</span>,<span class="dv">30</span>),<span class="fu">rep</span>(<span class="st">&quot;group2&quot;</span>,<span class="dv">30</span>),<span class="fu">rep</span>(<span class="st">&quot;group3&quot;</span>,<span class="dv">30</span>),<span class="fu">rep</span>(<span class="st">&quot;group4&quot;</span>,<span class="dv">30</span>))</span>
<span id="cb152-2"><a href="ytlrwijj.html#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="ytlrwijj.html#cb152-3" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">3.53</span>,<span class="fl">4.59</span>,<span class="fl">4.34</span>,<span class="fl">2.66</span>,<span class="fl">3.59</span>,<span class="fl">3.13</span>,<span class="fl">3.30</span>,<span class="fl">4.04</span>,<span class="fl">3.53</span>,<span class="fl">3.56</span>,<span class="fl">3.85</span>,<span class="fl">4.07</span>,<span class="fl">1.37</span>,</span>
<span id="cb152-4"><a href="ytlrwijj.html#cb152-4" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.93</span>,<span class="fl">2.33</span>,<span class="fl">2.98</span>,<span class="fl">4.00</span>,<span class="fl">3.55</span>,<span class="fl">2.64</span>,<span class="fl">2.56</span>,<span class="fl">3.50</span>,<span class="fl">3.25</span>,<span class="fl">2.96</span>,<span class="fl">4.30</span>,<span class="fl">3.52</span>,<span class="fl">3.93</span>,</span>
<span id="cb152-5"><a href="ytlrwijj.html#cb152-5" aria-hidden="true" tabindex="-1"></a>          <span class="fl">4.19</span>,<span class="fl">2.96</span>,<span class="fl">4.16</span>,<span class="fl">2.59</span>,<span class="fl">2.42</span>,<span class="fl">3.36</span>,<span class="fl">4.32</span>,<span class="fl">2.34</span>,<span class="fl">2.68</span>,<span class="fl">2.95</span>,<span class="fl">2.36</span>,<span class="fl">2.56</span>,<span class="fl">2.52</span>,</span>
<span id="cb152-6"><a href="ytlrwijj.html#cb152-6" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.27</span>,<span class="fl">2.98</span>,<span class="fl">3.72</span>,<span class="fl">2.65</span>,<span class="fl">2.22</span>,<span class="fl">2.90</span>,<span class="fl">1.98</span>,<span class="fl">2.63</span>,<span class="fl">2.86</span>,<span class="fl">2.93</span>,<span class="fl">2.17</span>,<span class="fl">2.72</span>,<span class="fl">1.56</span>,</span>
<span id="cb152-7"><a href="ytlrwijj.html#cb152-7" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.11</span>,<span class="fl">1.81</span>,<span class="fl">1.77</span>,<span class="fl">2.80</span>,<span class="fl">3.57</span>,<span class="fl">2.97</span>,<span class="fl">4.02</span>,<span class="fl">2.31</span>,<span class="fl">2.86</span>,<span class="fl">2.28</span>,<span class="fl">2.39</span>,<span class="fl">2.28</span>,<span class="fl">2.48</span>,</span>
<span id="cb152-8"><a href="ytlrwijj.html#cb152-8" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.28</span>,<span class="fl">3.48</span>,<span class="fl">2.42</span>,<span class="fl">2.41</span>,<span class="fl">2.66</span>,<span class="fl">3.29</span>,<span class="fl">2.70</span>,<span class="fl">2.66</span>,<span class="fl">3.68</span>,<span class="fl">2.65</span>,<span class="fl">2.66</span>,<span class="fl">2.32</span>,<span class="fl">2.61</span>,</span>
<span id="cb152-9"><a href="ytlrwijj.html#cb152-9" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.64</span>,<span class="fl">2.58</span>,<span class="fl">3.65</span>,<span class="fl">3.21</span>,<span class="fl">2.23</span>,<span class="fl">2.32</span>,<span class="fl">2.68</span>,<span class="fl">3.04</span>,<span class="fl">2.81</span>,<span class="fl">3.02</span>,<span class="fl">1.97</span>,<span class="fl">1.68</span>,<span class="fl">0.89</span>,</span>
<span id="cb152-10"><a href="ytlrwijj.html#cb152-10" aria-hidden="true" tabindex="-1"></a>          <span class="fl">1.06</span>,<span class="fl">1.08</span>,<span class="fl">1.27</span>,<span class="fl">1.63</span>,<span class="fl">1.89</span>,<span class="fl">1.31</span>,<span class="fl">2.51</span>,<span class="fl">1.88</span>,<span class="fl">1.41</span>,<span class="fl">3.19</span>,<span class="fl">1.92</span>,<span class="fl">0.94</span>,<span class="fl">2.11</span>,</span>
<span id="cb152-11"><a href="ytlrwijj.html#cb152-11" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.81</span>,<span class="fl">1.98</span>,<span class="fl">1.74</span>,<span class="fl">2.16</span>,<span class="fl">3.37</span>,<span class="fl">2.97</span>,<span class="fl">1.69</span>,<span class="fl">1.19</span>,<span class="fl">2.17</span>,<span class="fl">2.28</span>,<span class="fl">1.72</span>,<span class="fl">2.47</span>,<span class="fl">1.02</span>,</span>
<span id="cb152-12"><a href="ytlrwijj.html#cb152-12" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.52</span>,<span class="fl">2.10</span>,<span class="fl">3.71</span>)</span>
<span id="cb152-13"><a href="ytlrwijj.html#cb152-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-14"><a href="ytlrwijj.html#cb152-14" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(trt,weight)</span>
<span id="cb152-15"><a href="ytlrwijj.html#cb152-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-16"><a href="ytlrwijj.html#cb152-16" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span>
<span id="cb152-17"><a href="ytlrwijj.html#cb152-17" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    120 obs. of  2 variables:</span></span>
<span id="cb152-18"><a href="ytlrwijj.html#cb152-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ trt   : chr  &quot;group1&quot; &quot;group1&quot; &quot;group1&quot; &quot;group1&quot; ...</span></span>
<span id="cb152-19"><a href="ytlrwijj.html#cb152-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ weight: num  3.53 4.59 4.34 2.66 3.59 3.13 3.3 4.04 3.53 3.56 ...</span></span></code></pre></div>
<p>R语言中的方差分析结果比较：</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="ytlrwijj.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1型</span></span>
<span id="cb153-2"><a href="ytlrwijj.html#cb153-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> trt, <span class="at">data =</span> df)</span>
<span id="cb153-3"><a href="ytlrwijj.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb153-4"><a href="ytlrwijj.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="do">##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span id="cb153-5"><a href="ytlrwijj.html#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="do">## trt           3  32.16  10.719   24.88 1.67e-12 ***</span></span>
<span id="cb153-6"><a href="ytlrwijj.html#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   116  49.97   0.431                     </span></span>
<span id="cb153-7"><a href="ytlrwijj.html#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb153-8"><a href="ytlrwijj.html#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb153-9"><a href="ytlrwijj.html#cb153-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-10"><a href="ytlrwijj.html#cb153-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2型</span></span>
<span id="cb153-11"><a href="ytlrwijj.html#cb153-11" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type=</span><span class="dv">2</span>)</span>
<span id="cb153-12"><a href="ytlrwijj.html#cb153-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb153-13"><a href="ytlrwijj.html#cb153-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-14"><a href="ytlrwijj.html#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb153-15"><a href="ytlrwijj.html#cb153-15" aria-hidden="true" tabindex="-1"></a><span class="do">##           Sum Sq  Df F value    Pr(&gt;F)    </span></span>
<span id="cb153-16"><a href="ytlrwijj.html#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="do">## trt       32.156   3  24.884 1.674e-12 ***</span></span>
<span id="cb153-17"><a href="ytlrwijj.html#cb153-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 49.967 116                      </span></span>
<span id="cb153-18"><a href="ytlrwijj.html#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb153-19"><a href="ytlrwijj.html#cb153-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb153-20"><a href="ytlrwijj.html#cb153-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-21"><a href="ytlrwijj.html#cb153-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3型</span></span>
<span id="cb153-22"><a href="ytlrwijj.html#cb153-22" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type=</span><span class="dv">3</span>)</span>
<span id="cb153-23"><a href="ytlrwijj.html#cb153-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type III tests)</span></span>
<span id="cb153-24"><a href="ytlrwijj.html#cb153-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb153-25"><a href="ytlrwijj.html#cb153-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb153-26"><a href="ytlrwijj.html#cb153-26" aria-hidden="true" tabindex="-1"></a><span class="do">##             Sum Sq  Df F value    Pr(&gt;F)    </span></span>
<span id="cb153-27"><a href="ytlrwijj.html#cb153-27" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 353.02   1 819.537 &lt; 2.2e-16 ***</span></span>
<span id="cb153-28"><a href="ytlrwijj.html#cb153-28" aria-hidden="true" tabindex="-1"></a><span class="do">## trt          32.16   3  24.884 1.674e-12 ***</span></span>
<span id="cb153-29"><a href="ytlrwijj.html#cb153-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    49.97 116                      </span></span>
<span id="cb153-30"><a href="ytlrwijj.html#cb153-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb153-31"><a href="ytlrwijj.html#cb153-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>可以看到3种类型的结果是完全一样的，没有差别~</p>
<p>下面我们更改一下样本数量，使其变成非均衡设计（还是one-way anova）：</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="ytlrwijj.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 每组样本数量改一下</span></span>
<span id="cb154-2"><a href="ytlrwijj.html#cb154-2" aria-hidden="true" tabindex="-1"></a>trt<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;group1&quot;</span>,<span class="dv">10</span>),<span class="fu">rep</span>(<span class="st">&quot;group2&quot;</span>,<span class="dv">50</span>),<span class="fu">rep</span>(<span class="st">&quot;group3&quot;</span>,<span class="dv">35</span>),<span class="fu">rep</span>(<span class="st">&quot;group4&quot;</span>,<span class="dv">25</span>))</span>
<span id="cb154-3"><a href="ytlrwijj.html#cb154-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-4"><a href="ytlrwijj.html#cb154-4" aria-hidden="true" tabindex="-1"></a>weight<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">3.53</span>,<span class="fl">4.59</span>,<span class="fl">4.34</span>,<span class="fl">2.66</span>,<span class="fl">3.59</span>,<span class="fl">3.13</span>,<span class="fl">3.30</span>,<span class="fl">4.04</span>,<span class="fl">3.53</span>,<span class="fl">3.56</span>,<span class="fl">3.85</span>,<span class="fl">4.07</span>,<span class="fl">1.37</span>,</span>
<span id="cb154-5"><a href="ytlrwijj.html#cb154-5" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.93</span>,<span class="fl">2.33</span>,<span class="fl">2.98</span>,<span class="fl">4.00</span>,<span class="fl">3.55</span>,<span class="fl">2.64</span>,<span class="fl">2.56</span>,<span class="fl">3.50</span>,<span class="fl">3.25</span>,<span class="fl">2.96</span>,<span class="fl">4.30</span>,<span class="fl">3.52</span>,<span class="fl">3.93</span>,</span>
<span id="cb154-6"><a href="ytlrwijj.html#cb154-6" aria-hidden="true" tabindex="-1"></a>          <span class="fl">4.19</span>,<span class="fl">2.96</span>,<span class="fl">4.16</span>,<span class="fl">2.59</span>,<span class="fl">2.42</span>,<span class="fl">3.36</span>,<span class="fl">4.32</span>,<span class="fl">2.34</span>,<span class="fl">2.68</span>,<span class="fl">2.95</span>,<span class="fl">2.36</span>,<span class="fl">2.56</span>,<span class="fl">2.52</span>,</span>
<span id="cb154-7"><a href="ytlrwijj.html#cb154-7" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.27</span>,<span class="fl">2.98</span>,<span class="fl">3.72</span>,<span class="fl">2.65</span>,<span class="fl">2.22</span>,<span class="fl">2.90</span>,<span class="fl">1.98</span>,<span class="fl">2.63</span>,<span class="fl">2.86</span>,<span class="fl">2.93</span>,<span class="fl">2.17</span>,<span class="fl">2.72</span>,<span class="fl">1.56</span>,</span>
<span id="cb154-8"><a href="ytlrwijj.html#cb154-8" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.11</span>,<span class="fl">1.81</span>,<span class="fl">1.77</span>,<span class="fl">2.80</span>,<span class="fl">3.57</span>,<span class="fl">2.97</span>,<span class="fl">4.02</span>,<span class="fl">2.31</span>,<span class="fl">2.86</span>,<span class="fl">2.28</span>,<span class="fl">2.39</span>,<span class="fl">2.28</span>,<span class="fl">2.48</span>,</span>
<span id="cb154-9"><a href="ytlrwijj.html#cb154-9" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.28</span>,<span class="fl">3.48</span>,<span class="fl">2.42</span>,<span class="fl">2.41</span>,<span class="fl">2.66</span>,<span class="fl">3.29</span>,<span class="fl">2.70</span>,<span class="fl">2.66</span>,<span class="fl">3.68</span>,<span class="fl">2.65</span>,<span class="fl">2.66</span>,<span class="fl">2.32</span>,<span class="fl">2.61</span>,</span>
<span id="cb154-10"><a href="ytlrwijj.html#cb154-10" aria-hidden="true" tabindex="-1"></a>          <span class="fl">3.64</span>,<span class="fl">2.58</span>,<span class="fl">3.65</span>,<span class="fl">3.21</span>,<span class="fl">2.23</span>,<span class="fl">2.32</span>,<span class="fl">2.68</span>,<span class="fl">3.04</span>,<span class="fl">2.81</span>,<span class="fl">3.02</span>,<span class="fl">1.97</span>,<span class="fl">1.68</span>,<span class="fl">0.89</span>,</span>
<span id="cb154-11"><a href="ytlrwijj.html#cb154-11" aria-hidden="true" tabindex="-1"></a>          <span class="fl">1.06</span>,<span class="fl">1.08</span>,<span class="fl">1.27</span>,<span class="fl">1.63</span>,<span class="fl">1.89</span>,<span class="fl">1.31</span>,<span class="fl">2.51</span>,<span class="fl">1.88</span>,<span class="fl">1.41</span>,<span class="fl">3.19</span>,<span class="fl">1.92</span>,<span class="fl">0.94</span>,<span class="fl">2.11</span>,</span>
<span id="cb154-12"><a href="ytlrwijj.html#cb154-12" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.81</span>,<span class="fl">1.98</span>,<span class="fl">1.74</span>,<span class="fl">2.16</span>,<span class="fl">3.37</span>,<span class="fl">2.97</span>,<span class="fl">1.69</span>,<span class="fl">1.19</span>,<span class="fl">2.17</span>,<span class="fl">2.28</span>,<span class="fl">1.72</span>,<span class="fl">2.47</span>,<span class="fl">1.02</span>,</span>
<span id="cb154-13"><a href="ytlrwijj.html#cb154-13" aria-hidden="true" tabindex="-1"></a>          <span class="fl">2.52</span>,<span class="fl">2.10</span>,<span class="fl">3.71</span>)</span>
<span id="cb154-14"><a href="ytlrwijj.html#cb154-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-15"><a href="ytlrwijj.html#cb154-15" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(trt,weight)</span></code></pre></div>
<p>然后再来看一下3种类型方差分析的结果：</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="ytlrwijj.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1型</span></span>
<span id="cb155-2"><a href="ytlrwijj.html#cb155-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> trt, <span class="at">data =</span> df1)</span>
<span id="cb155-3"><a href="ytlrwijj.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb155-4"><a href="ytlrwijj.html#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="do">##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span id="cb155-5"><a href="ytlrwijj.html#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="do">## trt           3  22.03   7.343   14.17 6.23e-08 ***</span></span>
<span id="cb155-6"><a href="ytlrwijj.html#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   116  60.09   0.518                     </span></span>
<span id="cb155-7"><a href="ytlrwijj.html#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb155-8"><a href="ytlrwijj.html#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb155-9"><a href="ytlrwijj.html#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="ytlrwijj.html#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2型</span></span>
<span id="cb155-11"><a href="ytlrwijj.html#cb155-11" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit1, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb155-12"><a href="ytlrwijj.html#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb155-13"><a href="ytlrwijj.html#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb155-14"><a href="ytlrwijj.html#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb155-15"><a href="ytlrwijj.html#cb155-15" aria-hidden="true" tabindex="-1"></a><span class="do">##           Sum Sq  Df F value    Pr(&gt;F)    </span></span>
<span id="cb155-16"><a href="ytlrwijj.html#cb155-16" aria-hidden="true" tabindex="-1"></a><span class="do">## trt       22.029   3  14.174 6.228e-08 ***</span></span>
<span id="cb155-17"><a href="ytlrwijj.html#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 60.094 116                      </span></span>
<span id="cb155-18"><a href="ytlrwijj.html#cb155-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb155-19"><a href="ytlrwijj.html#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb155-20"><a href="ytlrwijj.html#cb155-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-21"><a href="ytlrwijj.html#cb155-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3型</span></span>
<span id="cb155-22"><a href="ytlrwijj.html#cb155-22" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit1, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb155-23"><a href="ytlrwijj.html#cb155-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type III tests)</span></span>
<span id="cb155-24"><a href="ytlrwijj.html#cb155-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb155-25"><a href="ytlrwijj.html#cb155-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb155-26"><a href="ytlrwijj.html#cb155-26" aria-hidden="true" tabindex="-1"></a><span class="do">##              Sum Sq  Df F value    Pr(&gt;F)    </span></span>
<span id="cb155-27"><a href="ytlrwijj.html#cb155-27" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 131.551   1 253.933 &lt; 2.2e-16 ***</span></span>
<span id="cb155-28"><a href="ytlrwijj.html#cb155-28" aria-hidden="true" tabindex="-1"></a><span class="do">## trt          22.029   3  14.174 6.228e-08 ***</span></span>
<span id="cb155-29"><a href="ytlrwijj.html#cb155-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    60.094 116                      </span></span>
<span id="cb155-30"><a href="ytlrwijj.html#cb155-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb155-31"><a href="ytlrwijj.html#cb155-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>可以看到3种类型的结果也是一样的哦！</p>
</div>
<div id="two-way-anova" class="section level3 hasAnchor" number="10.3.2">
<h3><span class="header-section-number">10.3.2</span> two-way anova<a href="ytlrwijj.html#two-way-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>使用一个随机区组设计的方差分析进行演示，示例数据来自课本<strong>例4-3</strong>的数据。</p>
<p>首先也是均衡设计的情况：</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="ytlrwijj.html#cb156-1" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.82</span>,<span class="fl">0.65</span>,<span class="fl">0.51</span>,<span class="fl">0.73</span>,<span class="fl">0.54</span>,<span class="fl">0.23</span>,<span class="fl">0.43</span>,<span class="fl">0.34</span>,<span class="fl">0.28</span>,<span class="fl">0.41</span>,<span class="fl">0.21</span>,</span>
<span id="cb156-2"><a href="ytlrwijj.html#cb156-2" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.31</span>,<span class="fl">0.68</span>,<span class="fl">0.43</span>,<span class="fl">0.24</span>)</span>
<span id="cb156-3"><a href="ytlrwijj.html#cb156-3" aria-hidden="true" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>),<span class="at">each=</span><span class="dv">3</span>))</span>
<span id="cb156-4"><a href="ytlrwijj.html#cb156-4" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>),<span class="dv">5</span>))</span>
<span id="cb156-5"><a href="ytlrwijj.html#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="ytlrwijj.html#cb156-6" aria-hidden="true" tabindex="-1"></a>data4_4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(weight,block,group)</span>
<span id="cb156-7"><a href="ytlrwijj.html#cb156-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-8"><a href="ytlrwijj.html#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data4_4)</span>
<span id="cb156-9"><a href="ytlrwijj.html#cb156-9" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    15 obs. of  3 variables:</span></span>
<span id="cb156-10"><a href="ytlrwijj.html#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ weight: num  0.82 0.65 0.51 0.73 0.54 0.23 0.43 0.34 0.28 0.41 ...</span></span>
<span id="cb156-11"><a href="ytlrwijj.html#cb156-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ block : chr  &quot;1&quot; &quot;1&quot; &quot;1&quot; &quot;2&quot; ...</span></span>
<span id="cb156-12"><a href="ytlrwijj.html#cb156-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ group : chr  &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;A&quot; ...</span></span></code></pre></div>
<p>下面是3种类型方差分析的结果，由于是均衡设计，3种类型没有任何区别，并且即使你把区组因素和分组因素的位置互换，也不会有任何差别哦！</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="ytlrwijj.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1型</span></span>
<span id="cb157-2"><a href="ytlrwijj.html#cb157-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> block <span class="sc">+</span> group, <span class="at">data =</span> data4_4)</span>
<span id="cb157-3"><a href="ytlrwijj.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb157-4"><a href="ytlrwijj.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="do">##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></span>
<span id="cb157-5"><a href="ytlrwijj.html#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="do">## block        4 0.2284 0.05709   5.978 0.01579 * </span></span>
<span id="cb157-6"><a href="ytlrwijj.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="do">## group        2 0.2280 0.11400  11.937 0.00397 **</span></span>
<span id="cb157-7"><a href="ytlrwijj.html#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    8 0.0764 0.00955                   </span></span>
<span id="cb157-8"><a href="ytlrwijj.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb157-9"><a href="ytlrwijj.html#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb157-10"><a href="ytlrwijj.html#cb157-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-11"><a href="ytlrwijj.html#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2型</span></span>
<span id="cb157-12"><a href="ytlrwijj.html#cb157-12" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb157-13"><a href="ytlrwijj.html#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb157-14"><a href="ytlrwijj.html#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb157-15"><a href="ytlrwijj.html#cb157-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb157-16"><a href="ytlrwijj.html#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="do">##            Sum Sq Df F value   Pr(&gt;F)   </span></span>
<span id="cb157-17"><a href="ytlrwijj.html#cb157-17" aria-hidden="true" tabindex="-1"></a><span class="do">## block     0.22836  4   5.978 0.015787 * </span></span>
<span id="cb157-18"><a href="ytlrwijj.html#cb157-18" aria-hidden="true" tabindex="-1"></a><span class="do">## group     0.22800  2  11.937 0.003968 **</span></span>
<span id="cb157-19"><a href="ytlrwijj.html#cb157-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 0.07640  8                    </span></span>
<span id="cb157-20"><a href="ytlrwijj.html#cb157-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb157-21"><a href="ytlrwijj.html#cb157-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb157-22"><a href="ytlrwijj.html#cb157-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-23"><a href="ytlrwijj.html#cb157-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3型</span></span>
<span id="cb157-24"><a href="ytlrwijj.html#cb157-24" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb157-25"><a href="ytlrwijj.html#cb157-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type III tests)</span></span>
<span id="cb157-26"><a href="ytlrwijj.html#cb157-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb157-27"><a href="ytlrwijj.html#cb157-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb157-28"><a href="ytlrwijj.html#cb157-28" aria-hidden="true" tabindex="-1"></a><span class="do">##              Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span id="cb157-29"><a href="ytlrwijj.html#cb157-29" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 1.44086  1 150.875 1.794e-06 ***</span></span>
<span id="cb157-30"><a href="ytlrwijj.html#cb157-30" aria-hidden="true" tabindex="-1"></a><span class="do">## block       0.22836  4   5.978  0.015787 *  </span></span>
<span id="cb157-31"><a href="ytlrwijj.html#cb157-31" aria-hidden="true" tabindex="-1"></a><span class="do">## group       0.22800  2  11.937  0.003968 ** </span></span>
<span id="cb157-32"><a href="ytlrwijj.html#cb157-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   0.07640  8                      </span></span>
<span id="cb157-33"><a href="ytlrwijj.html#cb157-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb157-34"><a href="ytlrwijj.html#cb157-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>下面给它改成非均衡设计：</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="ytlrwijj.html#cb158-1" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.82</span>,<span class="fl">0.65</span>,<span class="fl">0.51</span>,<span class="fl">0.73</span>,<span class="fl">0.54</span>,<span class="fl">0.23</span>,<span class="fl">0.43</span>,<span class="fl">0.34</span>,<span class="fl">0.28</span>,<span class="fl">0.41</span>,<span class="fl">0.21</span>,</span>
<span id="cb158-2"><a href="ytlrwijj.html#cb158-2" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.31</span>,<span class="fl">0.68</span>,<span class="fl">0.43</span>,<span class="fl">0.24</span>)</span>
<span id="cb158-3"><a href="ytlrwijj.html#cb158-3" aria-hidden="true" tabindex="-1"></a>block <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;3&quot;</span>,<span class="st">&quot;4&quot;</span>,<span class="st">&quot;5&quot;</span>),<span class="at">each=</span><span class="dv">3</span>))</span>
<span id="cb158-4"><a href="ytlrwijj.html#cb158-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-5"><a href="ytlrwijj.html#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 每组样本量不一样</span></span>
<span id="cb158-6"><a href="ytlrwijj.html#cb158-6" aria-hidden="true" tabindex="-1"></a>group <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>),<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>,<span class="dv">9</span>),<span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>,<span class="dv">4</span>))</span>
<span id="cb158-7"><a href="ytlrwijj.html#cb158-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-8"><a href="ytlrwijj.html#cb158-8" aria-hidden="true" tabindex="-1"></a>data4_4 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(weight,block,group)</span></code></pre></div>
<p>下面再看一下3种类型方差分析的结果：</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="ytlrwijj.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1型</span></span>
<span id="cb159-2"><a href="ytlrwijj.html#cb159-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(weight <span class="sc">~</span> block <span class="sc">+</span> group, <span class="at">data =</span> data4_4)</span>
<span id="cb159-3"><a href="ytlrwijj.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb159-4"><a href="ytlrwijj.html#cb159-4" aria-hidden="true" tabindex="-1"></a><span class="do">##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   </span></span>
<span id="cb159-5"><a href="ytlrwijj.html#cb159-5" aria-hidden="true" tabindex="-1"></a><span class="do">## block        4 0.2284 0.05709   5.978 0.01579 * </span></span>
<span id="cb159-6"><a href="ytlrwijj.html#cb159-6" aria-hidden="true" tabindex="-1"></a><span class="do">## group        2 0.2280 0.11400  11.937 0.00397 **</span></span>
<span id="cb159-7"><a href="ytlrwijj.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals    8 0.0764 0.00955                   </span></span>
<span id="cb159-8"><a href="ytlrwijj.html#cb159-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb159-9"><a href="ytlrwijj.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb159-10"><a href="ytlrwijj.html#cb159-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-11"><a href="ytlrwijj.html#cb159-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2型</span></span>
<span id="cb159-12"><a href="ytlrwijj.html#cb159-12" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit1, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb159-13"><a href="ytlrwijj.html#cb159-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb159-14"><a href="ytlrwijj.html#cb159-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb159-15"><a href="ytlrwijj.html#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb159-16"><a href="ytlrwijj.html#cb159-16" aria-hidden="true" tabindex="-1"></a><span class="do">##             Sum Sq Df F value Pr(&gt;F)</span></span>
<span id="cb159-17"><a href="ytlrwijj.html#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="do">## block     0.079789  4  0.5896 0.6798</span></span>
<span id="cb159-18"><a href="ytlrwijj.html#cb159-18" aria-hidden="true" tabindex="-1"></a><span class="do">## group     0.033750  2  0.4988 0.6250</span></span>
<span id="cb159-19"><a href="ytlrwijj.html#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 0.270650  8</span></span>
<span id="cb159-20"><a href="ytlrwijj.html#cb159-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-21"><a href="ytlrwijj.html#cb159-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 3型</span></span>
<span id="cb159-22"><a href="ytlrwijj.html#cb159-22" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit1, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb159-23"><a href="ytlrwijj.html#cb159-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type III tests)</span></span>
<span id="cb159-24"><a href="ytlrwijj.html#cb159-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb159-25"><a href="ytlrwijj.html#cb159-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: weight</span></span>
<span id="cb159-26"><a href="ytlrwijj.html#cb159-26" aria-hidden="true" tabindex="-1"></a><span class="do">##              Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span id="cb159-27"><a href="ytlrwijj.html#cb159-27" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept) 1.08045  1 31.9364 0.0004807 ***</span></span>
<span id="cb159-28"><a href="ytlrwijj.html#cb159-28" aria-hidden="true" tabindex="-1"></a><span class="do">## block       0.07979  4  0.5896 0.6798021    </span></span>
<span id="cb159-29"><a href="ytlrwijj.html#cb159-29" aria-hidden="true" tabindex="-1"></a><span class="do">## group       0.03375  2  0.4988 0.6249619    </span></span>
<span id="cb159-30"><a href="ytlrwijj.html#cb159-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   0.27065  8                      </span></span>
<span id="cb159-31"><a href="ytlrwijj.html#cb159-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb159-32"><a href="ytlrwijj.html#cb159-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>可以看到结果完全不一样了哦！</p>
</div>
<div id="协方差分析" class="section level3 hasAnchor" number="10.3.3">
<h3><span class="header-section-number">10.3.3</span> 协方差分析<a href="ytlrwijj.html#协方差分析" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>就用一个简单的完全随机设计资料的协方差分析进行演示，示例数据来自课本<strong>例13-1</strong>。</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="ytlrwijj.html#cb160-1" aria-hidden="true" tabindex="-1"></a>df13_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1=</span><span class="fu">c</span>(<span class="fl">10.8</span>,<span class="fl">11.6</span>,<span class="fl">10.6</span>,<span class="fl">9.0</span>,<span class="fl">11.2</span>,<span class="fl">9.9</span>,<span class="fl">10.6</span>,<span class="fl">10.4</span>,<span class="fl">9.6</span>,<span class="fl">10.5</span>,</span>
<span id="cb160-2"><a href="ytlrwijj.html#cb160-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">10.6</span>,<span class="fl">9.9</span>,<span class="fl">9.5</span>,<span class="fl">9.7</span>,<span class="fl">10.7</span>,<span class="fl">9.2</span>,<span class="fl">10.5</span>,<span class="fl">11.0</span>,<span class="fl">10.1</span>,<span class="fl">10.7</span>,<span class="fl">8.5</span>,<span class="fl">10.0</span>,</span>
<span id="cb160-3"><a href="ytlrwijj.html#cb160-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">10.4</span>,<span class="fl">9.7</span>,<span class="fl">9.4</span>,<span class="fl">9.2</span>,<span class="fl">10.5</span>,<span class="fl">11.2</span>,<span class="fl">9.6</span>,<span class="fl">8.0</span>),</span>
<span id="cb160-4"><a href="ytlrwijj.html#cb160-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y1=</span><span class="fu">c</span>(<span class="fl">9.4</span>,<span class="fl">9.7</span>,<span class="fl">8.7</span>,<span class="fl">7.2</span>,<span class="fl">10.0</span>,<span class="fl">8.5</span>,<span class="fl">8.3</span>,<span class="fl">8.1</span>,<span class="fl">8.5</span>,<span class="fl">9.1</span>,<span class="fl">9.2</span>,<span class="fl">8.4</span>,</span>
<span id="cb160-5"><a href="ytlrwijj.html#cb160-5" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">7.6</span>,<span class="fl">7.9</span>,<span class="fl">8.8</span>,<span class="fl">7.4</span>,<span class="fl">8.6</span>,<span class="fl">9.2</span>,<span class="fl">8.0</span>,<span class="fl">8.5</span>,<span class="fl">7.3</span>,</span>
<span id="cb160-6"><a href="ytlrwijj.html#cb160-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">8.3</span>,<span class="fl">8.6</span>,<span class="fl">8.7</span>,<span class="fl">7.6</span>,<span class="fl">8.0</span>,<span class="fl">8.8</span>,<span class="fl">9.5</span>,<span class="fl">8.2</span>,<span class="fl">7.2</span>),</span>
<span id="cb160-7"><a href="ytlrwijj.html#cb160-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x2=</span><span class="fu">c</span>(<span class="fl">10.4</span>,<span class="fl">9.7</span>,<span class="fl">9.9</span>,<span class="fl">9.8</span>,<span class="fl">11.1</span>,<span class="fl">8.2</span>,<span class="fl">8.8</span>,<span class="fl">10.0</span>,<span class="fl">9.0</span>,<span class="fl">9.4</span>,</span>
<span id="cb160-8"><a href="ytlrwijj.html#cb160-8" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">8.9</span>,<span class="fl">10.3</span>,<span class="fl">9.3</span>,<span class="fl">9.2</span>,<span class="fl">10.9</span>,<span class="fl">9.2</span>,<span class="fl">9.2</span>,<span class="fl">10.4</span>,<span class="fl">11.2</span>,</span>
<span id="cb160-9"><a href="ytlrwijj.html#cb160-9" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">11.1</span>,<span class="fl">11.0</span>,<span class="fl">8.6</span>,<span class="fl">9.3</span>,<span class="fl">10.3</span>,<span class="fl">10.3</span>,<span class="fl">9.8</span>,<span class="fl">10.5</span>,<span class="fl">10.7</span>,<span class="fl">10.4</span>,<span class="fl">9.4</span>),</span>
<span id="cb160-10"><a href="ytlrwijj.html#cb160-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y2=</span><span class="fu">c</span>(<span class="fl">9.2</span>,<span class="fl">9.1</span>,<span class="fl">8.9</span>,<span class="fl">8.6</span>,<span class="fl">9.9</span>,<span class="fl">7.1</span>,<span class="fl">7.8</span>,<span class="fl">7.9</span>,<span class="fl">8.0</span>,<span class="fl">9.0</span>,<span class="fl">7.9</span>,<span class="fl">8.9</span>,</span>
<span id="cb160-11"><a href="ytlrwijj.html#cb160-11" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">8.9</span>,<span class="fl">8.1</span>,<span class="fl">10.2</span>,<span class="fl">8.5</span>,<span class="fl">9.0</span>,<span class="fl">8.9</span>,<span class="fl">9.8</span>,<span class="fl">10.1</span>,<span class="fl">8.5</span>,</span>
<span id="cb160-12"><a href="ytlrwijj.html#cb160-12" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">8.1</span>,<span class="fl">8.6</span>,<span class="fl">8.9</span>,<span class="fl">9.6</span>,<span class="fl">8.1</span>,<span class="fl">9.9</span>,<span class="fl">9.3</span>,<span class="fl">8.7</span>,<span class="fl">8.7</span>),</span>
<span id="cb160-13"><a href="ytlrwijj.html#cb160-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">x3=</span><span class="fu">c</span>(<span class="fl">9.8</span>,<span class="fl">11.2</span>,<span class="fl">10.7</span>,<span class="fl">9.6</span>,<span class="fl">10.1</span>,<span class="fl">9.8</span>,<span class="fl">10.1</span>,<span class="fl">10.3</span>,<span class="fl">11.0</span>,<span class="fl">10.5</span>,<span class="fl">9.2</span>,</span>
<span id="cb160-14"><a href="ytlrwijj.html#cb160-14" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">10.1</span>,<span class="fl">10.4</span>,<span class="fl">10.0</span>,<span class="fl">8.4</span>,<span class="fl">10.1</span>,<span class="fl">9.3</span>,<span class="fl">10.5</span>,<span class="fl">11.1</span>,<span class="fl">10.5</span>,</span>
<span id="cb160-15"><a href="ytlrwijj.html#cb160-15" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">9.7</span>,<span class="fl">9.2</span>,<span class="fl">9.3</span>,<span class="fl">10.4</span>,<span class="fl">10.0</span>,<span class="fl">10.3</span>,<span class="fl">9.9</span>,<span class="fl">9.4</span>,<span class="fl">8.3</span>,<span class="fl">9.2</span>),</span>
<span id="cb160-16"><a href="ytlrwijj.html#cb160-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y3=</span><span class="fu">c</span>(<span class="fl">7.6</span>,<span class="fl">7.9</span>,<span class="fl">9.0</span>,<span class="fl">7.8</span>,<span class="fl">8.5</span>,<span class="fl">7.5</span>,<span class="fl">8.3</span>,<span class="fl">8.2</span>,<span class="fl">8.4</span>,<span class="fl">8.1</span>,<span class="fl">7.0</span>,<span class="fl">7.7</span>,<span class="fl">8.0</span>,</span>
<span id="cb160-17"><a href="ytlrwijj.html#cb160-17" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">6.6</span>,<span class="fl">6.1</span>,<span class="fl">8.1</span>,<span class="fl">7.8</span>,<span class="fl">8.4</span>,<span class="fl">8.2</span>,<span class="fl">8.0</span>,<span class="fl">7.6</span>,<span class="fl">6.9</span>,</span>
<span id="cb160-18"><a href="ytlrwijj.html#cb160-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fl">6.7</span>,<span class="fl">8.1</span>,<span class="fl">7.4</span>,<span class="fl">8.2</span>,<span class="fl">7.6</span>,<span class="fl">7.8</span>,<span class="fl">6.6</span>,<span class="fl">7.2</span>)</span>
<span id="cb160-19"><a href="ytlrwijj.html#cb160-19" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb160-20"><a href="ytlrwijj.html#cb160-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-21"><a href="ytlrwijj.html#cb160-21" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb160-22"><a href="ytlrwijj.html#cb160-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-23"><a href="ytlrwijj.html#cb160-23" aria-hidden="true" tabindex="-1"></a>df13_11 <span class="ot">&lt;-</span> df13_1 <span class="sc">%&gt;%</span> </span>
<span id="cb160-24"><a href="ytlrwijj.html#cb160-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="co"># 变长</span></span>
<span id="cb160-25"><a href="ytlrwijj.html#cb160-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&quot;.value&quot;</span>,<span class="st">&quot;group&quot;</span>),</span>
<span id="cb160-26"><a href="ytlrwijj.html#cb160-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_pattern =</span> <span class="st">&quot;(.)(.)&quot;</span></span>
<span id="cb160-27"><a href="ytlrwijj.html#cb160-27" aria-hidden="true" tabindex="-1"></a>               ) <span class="sc">%&gt;%</span> </span>
<span id="cb160-28"><a href="ytlrwijj.html#cb160-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">as.factor</span>(group)) <span class="co"># 组别变为因子型</span></span>
<span id="cb160-29"><a href="ytlrwijj.html#cb160-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-30"><a href="ytlrwijj.html#cb160-30" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df13_11)</span>
<span id="cb160-31"><a href="ytlrwijj.html#cb160-31" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 90</span></span>
<span id="cb160-32"><a href="ytlrwijj.html#cb160-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Columns: 3</span></span>
<span id="cb160-33"><a href="ytlrwijj.html#cb160-33" aria-hidden="true" tabindex="-1"></a><span class="do">## $ group &lt;fct&gt; 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, 1…</span></span>
<span id="cb160-34"><a href="ytlrwijj.html#cb160-34" aria-hidden="true" tabindex="-1"></a><span class="do">## $ x     &lt;dbl&gt; 10.8, 10.4, 9.8, 11.6, 9.7, 11.2, 10.6, 9.9, 10.7, 9.0, 9.8, 9.6…</span></span>
<span id="cb160-35"><a href="ytlrwijj.html#cb160-35" aria-hidden="true" tabindex="-1"></a><span class="do">## $ y     &lt;dbl&gt; 9.4, 9.2, 7.6, 9.7, 9.1, 7.9, 8.7, 8.9, 9.0, 7.2, 8.6, 7.8, 10.0…</span></span></code></pre></div>
<p><code>group</code>是分组因素，<code>x</code>是协变量，<code>y</code>是因变量。</p>
<p>下面进行3种类型的协方差分析：</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="ytlrwijj.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1型</span></span>
<span id="cb161-2"><a href="ytlrwijj.html#cb161-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> x <span class="sc">+</span> group, <span class="at">data =</span> df13_11) </span>
<span id="cb161-3"><a href="ytlrwijj.html#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span>
<span id="cb161-4"><a href="ytlrwijj.html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="do">##             Df Sum Sq Mean Sq F value Pr(&gt;F)    </span></span>
<span id="cb161-5"><a href="ytlrwijj.html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="do">## x            1  29.06  29.057  171.20 &lt;2e-16 ***</span></span>
<span id="cb161-6"><a href="ytlrwijj.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="do">## group        2  19.85   9.925   58.48 &lt;2e-16 ***</span></span>
<span id="cb161-7"><a href="ytlrwijj.html#cb161-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   86  14.60   0.170                   </span></span>
<span id="cb161-8"><a href="ytlrwijj.html#cb161-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb161-9"><a href="ytlrwijj.html#cb161-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb161-10"><a href="ytlrwijj.html#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="ytlrwijj.html#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 2型</span></span>
<span id="cb161-12"><a href="ytlrwijj.html#cb161-12" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type =</span> <span class="dv">2</span>)</span>
<span id="cb161-13"><a href="ytlrwijj.html#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type II tests)</span></span>
<span id="cb161-14"><a href="ytlrwijj.html#cb161-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb161-15"><a href="ytlrwijj.html#cb161-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: y</span></span>
<span id="cb161-16"><a href="ytlrwijj.html#cb161-16" aria-hidden="true" tabindex="-1"></a><span class="do">##           Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span id="cb161-17"><a href="ytlrwijj.html#cb161-17" aria-hidden="true" tabindex="-1"></a><span class="do">## x         30.183  1  177.83 &lt; 2.2e-16 ***</span></span>
<span id="cb161-18"><a href="ytlrwijj.html#cb161-18" aria-hidden="true" tabindex="-1"></a><span class="do">## group     19.851  2   58.48 &lt; 2.2e-16 ***</span></span>
<span id="cb161-19"><a href="ytlrwijj.html#cb161-19" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals 14.596 86                      </span></span>
<span id="cb161-20"><a href="ytlrwijj.html#cb161-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb161-21"><a href="ytlrwijj.html#cb161-21" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb161-22"><a href="ytlrwijj.html#cb161-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-23"><a href="ytlrwijj.html#cb161-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3型</span></span>
<span id="cb161-24"><a href="ytlrwijj.html#cb161-24" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit, <span class="at">type =</span> <span class="dv">3</span>)</span>
<span id="cb161-25"><a href="ytlrwijj.html#cb161-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Anova Table (Type III tests)</span></span>
<span id="cb161-26"><a href="ytlrwijj.html#cb161-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb161-27"><a href="ytlrwijj.html#cb161-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Response: y</span></span>
<span id="cb161-28"><a href="ytlrwijj.html#cb161-28" aria-hidden="true" tabindex="-1"></a><span class="do">##              Sum Sq Df  F value Pr(&gt;F)    </span></span>
<span id="cb161-29"><a href="ytlrwijj.html#cb161-29" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  0.3818  1   2.2493 0.1373    </span></span>
<span id="cb161-30"><a href="ytlrwijj.html#cb161-30" aria-hidden="true" tabindex="-1"></a><span class="do">## x           30.1830  1 177.8346 &lt;2e-16 ***</span></span>
<span id="cb161-31"><a href="ytlrwijj.html#cb161-31" aria-hidden="true" tabindex="-1"></a><span class="do">## group       19.8510  2  58.4798 &lt;2e-16 ***</span></span>
<span id="cb161-32"><a href="ytlrwijj.html#cb161-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Residuals   14.5963 86                    </span></span>
<span id="cb161-33"><a href="ytlrwijj.html#cb161-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb161-34"><a href="ytlrwijj.html#cb161-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span></code></pre></div>
<p>可以看到在有协变量的情况下，即使是均衡设计，1型和2型、3型之间的平方及F值也是有差异的。</p>
<p>如果你很细心，你可能会发现R中进行单因素协方差分析（ANCOVA）的公式写法和two-way anova一模一样！那R语言怎么知道我们是要进行ancova还是two-way anova呢？</p>
<p>很简单，在这里<code>x</code>作为协变量，是数值型，所以R默认会进行ancova，如果是因子型或者字符型，R会默认进行two-way anova，比如上面那个随机区组的例子！</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rugnjkdfgl.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="terlajskd.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["medicine-statistic-book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
