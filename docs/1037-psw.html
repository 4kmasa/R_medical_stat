<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>37 R语言倾向性评分：加权 | R语言实战医学统计</title>
  <meta name="description" content="37 R语言倾向性评分：加权 | R语言实战医学统计" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="37 R语言倾向性评分：加权 | R语言实战医学统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="37 R语言倾向性评分：加权 | R语言实战医学统计" />
  <meta name="github-repo" content="ayueme/ayueme.github.io" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="37 R语言倾向性评分：加权 | R语言实战医学统计" />
  
  <meta name="twitter:description" content="37 R语言倾向性评分：加权 | R语言实战医学统计" />
  

<meta name="author" content="阿越就是我" />


<meta name="date" content="2023-06-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="1036-pssc.html"/>
<link rel="next" href="1038-p4trend.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R语言实战医学统计</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#本书缘起"><i class="fa fa-check"></i>本书缘起</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#作者简介"><i class="fa fa-check"></i>作者简介</a></li>
</ul></li>
<li class="part"><span><b>I 基础统计分析</b></span></li>
<li class="chapter" data-level="1" data-path="1001-ttest.html"><a href="1001-ttest.html"><i class="fa fa-check"></i><b>1</b> t检验</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1001-ttest.html"><a href="1001-ttest.html#单样本t检验"><i class="fa fa-check"></i><b>1.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="1.2" data-path="1001-ttest.html"><a href="1001-ttest.html#配对样本t检验"><i class="fa fa-check"></i><b>1.2</b> 配对样本t检验</a></li>
<li class="chapter" data-level="1.3" data-path="1001-ttest.html"><a href="1001-ttest.html#两样本t检验"><i class="fa fa-check"></i><b>1.3</b> 两样本t检验</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="1002-anova.html"><a href="1002-anova.html"><i class="fa fa-check"></i><b>2</b> 多样本均数比较的方差分析</a>
<ul>
<li class="chapter" data-level="2.1" data-path="1002-anova.html"><a href="1002-anova.html#完全随机设计资料的方差分析"><i class="fa fa-check"></i><b>2.1</b> 完全随机设计资料的方差分析</a></li>
<li class="chapter" data-level="2.2" data-path="1002-anova.html"><a href="1002-anova.html#随机区组设计资料的方差分析"><i class="fa fa-check"></i><b>2.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="2.3" data-path="1002-anova.html"><a href="1002-anova.html#拉丁方设计方差分析"><i class="fa fa-check"></i><b>2.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="2.4" data-path="1002-anova.html"><a href="1002-anova.html#两阶段交叉设计资料方差分析"><i class="fa fa-check"></i><b>2.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="2.5" data-path="1002-anova.html"><a href="1002-anova.html#多个样本均数间的多重比较"><i class="fa fa-check"></i><b>2.5</b> 多个样本均数间的多重比较</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="1002-anova.html"><a href="1002-anova.html#lsd-t检验"><i class="fa fa-check"></i><b>2.5.1</b> LSD-t检验</a></li>
<li class="chapter" data-level="2.5.2" data-path="1002-anova.html"><a href="1002-anova.html#tukeyhsd"><i class="fa fa-check"></i><b>2.5.2</b> TukeyHSD</a></li>
<li class="chapter" data-level="2.5.3" data-path="1002-anova.html"><a href="1002-anova.html#dunnett-t检验"><i class="fa fa-check"></i><b>2.5.3</b> Dunnett-t检验</a></li>
<li class="chapter" data-level="2.5.4" data-path="1002-anova.html"><a href="1002-anova.html#snk-q检验"><i class="fa fa-check"></i><b>2.5.4</b> SNK-q检验</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的bartlett检验和levene检验"><i class="fa fa-check"></i><b>2.6</b> 多样本方差比较的Bartlett检验和Levene检验</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的bartlett检验"><i class="fa fa-check"></i><b>2.6.1</b> 多样本方差比较的Bartlett检验</a></li>
<li class="chapter" data-level="2.6.2" data-path="1002-anova.html"><a href="1002-anova.html#多样本方差比较的levene检验"><i class="fa fa-check"></i><b>2.6.2</b> 多样本方差比较的Levene检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="1003-dysanova.html"><a href="1003-dysanova.html"><i class="fa fa-check"></i><b>3</b> 多因素方差分析</a>
<ul>
<li class="chapter" data-level="3.1" data-path="1003-dysanova.html"><a href="1003-dysanova.html#x-2-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.1</b> 2 x 2 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.2" data-path="1003-dysanova.html"><a href="1003-dysanova.html#i-x-j-两因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.2</b> I x J 两因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.3" data-path="1003-dysanova.html"><a href="1003-dysanova.html#i-x-j-x-k-三因素析因设计资料的方差分析"><i class="fa fa-check"></i><b>3.3</b> I x J x K 三因素析因设计资料的方差分析</a></li>
<li class="chapter" data-level="3.4" data-path="1003-dysanova.html"><a href="1003-dysanova.html#正交设计资料的方差分析"><i class="fa fa-check"></i><b>3.4</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="3.5" data-path="1003-dysanova.html"><a href="1003-dysanova.html#嵌套设计资料的方差分析"><i class="fa fa-check"></i><b>3.5</b> 嵌套设计资料的方差分析</a></li>
<li class="chapter" data-level="3.6" data-path="1003-dysanova.html"><a href="1003-dysanova.html#裂区设计资料的方差分析"><i class="fa fa-check"></i><b>3.6</b> 裂区设计资料的方差分析</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html"><i class="fa fa-check"></i><b>4</b> 重复测量方差分析</a>
<ul>
<li class="chapter" data-level="4.1" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据两因素两水平的方差分析"><i class="fa fa-check"></i><b>4.1</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="4.2" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据两因素多水平的分析"><i class="fa fa-check"></i><b>4.2</b> 重复测量数据两因素多水平的分析</a></li>
<li class="chapter" data-level="4.3" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#重复测量数据的多重比较"><i class="fa fa-check"></i><b>4.3</b> 重复测量数据的多重比较</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#组间差别多重比较"><i class="fa fa-check"></i><b>4.3.1</b> 组间差别多重比较</a></li>
<li class="chapter" data-level="4.3.2" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#时间趋势比较"><i class="fa fa-check"></i><b>4.3.2</b> 时间趋势比较</a></li>
<li class="chapter" data-level="4.3.3" data-path="1004-repeatedmeaanova.html"><a href="1004-repeatedmeaanova.html#时间点比较"><i class="fa fa-check"></i><b>4.3.3</b> 时间点比较</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="1005-ancova.html"><a href="1005-ancova.html"><i class="fa fa-check"></i><b>5</b> 协方差分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="1005-ancova.html"><a href="1005-ancova.html#完全随机设计资料的协方差分析"><i class="fa fa-check"></i><b>5.1</b> 完全随机设计资料的协方差分析</a></li>
<li class="chapter" data-level="5.2" data-path="1005-ancova.html"><a href="1005-ancova.html#使用rstatix进行优雅的协方差分析"><i class="fa fa-check"></i><b>5.2</b> 使用rstatix进行优雅的协方差分析</a></li>
<li class="chapter" data-level="5.3" data-path="1005-ancova.html"><a href="1005-ancova.html#随机区组设计资料的协方差分析"><i class="fa fa-check"></i><b>5.3</b> 随机区组设计资料的协方差分析</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="1006-chisq.html"><a href="1006-chisq.html"><i class="fa fa-check"></i><b>6</b> 卡方检验</a>
<ul>
<li class="chapter" data-level="6.1" data-path="1006-chisq.html"><a href="1006-chisq.html#不同类型卡方检验的选择"><i class="fa fa-check"></i><b>6.1</b> 不同类型卡方检验的选择</a></li>
<li class="chapter" data-level="6.2" data-path="1006-chisq.html"><a href="1006-chisq.html#四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.2</b> 四格表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="1006-chisq.html"><a href="1006-chisq.html#方法1"><i class="fa fa-check"></i><b>6.2.1</b> 方法1</a></li>
<li class="chapter" data-level="6.2.2" data-path="1006-chisq.html"><a href="1006-chisq.html#方法2"><i class="fa fa-check"></i><b>6.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="1006-chisq.html"><a href="1006-chisq.html#配对四格表资料的卡方检验"><i class="fa fa-check"></i><b>6.3</b> 配对四格表资料的卡方检验</a></li>
<li class="chapter" data-level="6.4" data-path="1006-chisq.html"><a href="1006-chisq.html#四格表资料的-fisher-确切概率法"><i class="fa fa-check"></i><b>6.4</b> 四格表资料的 Fisher 确切概率法</a></li>
<li class="chapter" data-level="6.5" data-path="1006-chisq.html"><a href="1006-chisq.html#行-x-列表资料的卡方检验"><i class="fa fa-check"></i><b>6.5</b> 行 x 列表资料的卡方检验</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="1006-chisq.html"><a href="1006-chisq.html#多个样本率的比较"><i class="fa fa-check"></i><b>6.5.1</b> 多个样本率的比较</a></li>
<li class="chapter" data-level="6.5.2" data-path="1006-chisq.html"><a href="1006-chisq.html#样本构成比的比较"><i class="fa fa-check"></i><b>6.5.2</b> 样本构成比的比较</a></li>
<li class="chapter" data-level="6.5.3" data-path="1006-chisq.html"><a href="1006-chisq.html#双向无序分类资料的关联性检验"><i class="fa fa-check"></i><b>6.5.3</b> 双向无序分类资料的关联性检验</a></li>
<li class="chapter" data-level="6.5.4" data-path="1006-chisq.html"><a href="1006-chisq.html#双向有序分组资料的线性趋势检验"><i class="fa fa-check"></i><b>6.5.4</b> 双向有序分组资料的线性趋势检验</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="1006-chisq.html"><a href="1006-chisq.html#多个样本率间的多重比较"><i class="fa fa-check"></i><b>6.6</b> 多个样本率间的多重比较</a></li>
<li class="chapter" data-level="6.7" data-path="1006-chisq.html"><a href="1006-chisq.html#cochran-mantel-haenszel-卡方统计量检验"><i class="fa fa-check"></i><b>6.7</b> Cochran-Mantel-Haenszel 卡方统计量检验</a></li>
<li class="chapter" data-level="6.8" data-path="1006-chisq.html"><a href="1006-chisq.html#频数分布拟合优度卡方检验"><i class="fa fa-check"></i><b>6.8</b> 频数分布拟合优度卡方检验</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html"><i class="fa fa-check"></i><b>7</b> 秩和检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#配对样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.1</b> 配对样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#两独立样本比较的wilcoxon符号秩检验"><i class="fa fa-check"></i><b>7.2</b> 两独立样本比较的Wilcoxon符号秩检验</a></li>
<li class="chapter" data-level="7.3" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#完全随机设计多个样本比较的-kruskal-wallis-h-检验"><i class="fa fa-check"></i><b>7.3</b> 完全随机设计多个样本比较的 Kruskal-Wallis H 检验</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多样本比较的kruskal-wallis-h检验"><i class="fa fa-check"></i><b>7.3.1</b> 多样本比较的kruskal-wallis H检验</a></li>
<li class="chapter" data-level="7.3.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#kruskal-wallis-h检验后的多重比较"><i class="fa fa-check"></i><b>7.3.2</b> kruskal-Wallis H检验后的多重比较</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#随记区组设计多个样本比较的-friedman-m-检验"><i class="fa fa-check"></i><b>7.4</b> 随记区组设计多个样本比较的 Friedman M 检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多个相关样本比较的friedman-m检验"><i class="fa fa-check"></i><b>7.4.1</b> 多个相关样本比较的Friedman M检验</a></li>
<li class="chapter" data-level="7.4.2" data-path="1007-wilcoxn.html"><a href="1007-wilcoxn.html#多个相关样本两两比较的q检验"><i class="fa fa-check"></i><b>7.4.2</b> 多个相关样本两两比较的q检验</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html"><i class="fa fa-check"></i><b>8</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#球对称检验"><i class="fa fa-check"></i><b>8.1</b> 球对称检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#使用课本表12-3的数据"><i class="fa fa-check"></i><b>8.1.1</b> 使用课本<strong>表12-3</strong>的数据</a></li>
<li class="chapter" data-level="8.1.2" data-path="1008-mauchlytest.html"><a href="1008-mauchlytest.html#使用课本例12-3的数据"><i class="fa fa-check"></i><b>8.1.2</b> 使用课本<strong>例12-3</strong>的数据</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="1009-cochranarmitage.html"><a href="1009-cochranarmitage.html"><i class="fa fa-check"></i><b>9</b> R语言Cochran Armitage检验</a></li>
<li class="chapter" data-level="10" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html"><i class="fa fa-check"></i><b>10</b> R语言方差分析注意事项</a>
<ul>
<li class="chapter" data-level="10.1" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#均衡设计和非均衡设计"><i class="fa fa-check"></i><b>10.1</b> 均衡设计和非均衡设计</a></li>
<li class="chapter" data-level="10.2" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#方差分析的3种类型"><i class="fa fa-check"></i><b>10.2</b> 方差分析的3种类型</a></li>
<li class="chapter" data-level="10.3" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#示例"><i class="fa fa-check"></i><b>10.3</b> 示例</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#one-way-anova"><i class="fa fa-check"></i><b>10.3.1</b> one-way anova</a></li>
<li class="chapter" data-level="10.3.2" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#two-way-anova"><i class="fa fa-check"></i><b>10.3.2</b> two-way anova</a></li>
<li class="chapter" data-level="10.3.3" data-path="1010-anovaattention.html"><a href="1010-anovaattention.html#协方差分析"><i class="fa fa-check"></i><b>10.3.3</b> 协方差分析</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="1011-samplesize.html"><a href="1011-samplesize.html"><i class="fa fa-check"></i><b>11</b> 样本量计算</a>
<ul>
<li class="chapter" data-level="11.1" data-path="1011-samplesize.html"><a href="1011-samplesize.html#t检验的样本量计算"><i class="fa fa-check"></i><b>11.1</b> t检验的样本量计算</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="1011-samplesize.html"><a href="1011-samplesize.html#单样本t检验样本均数和已知总体均数比较"><i class="fa fa-check"></i><b>11.1.1</b> 单样本t检验（样本均数和已知总体均数比较）</a></li>
<li class="chapter" data-level="11.1.2" data-path="1011-samplesize.html"><a href="1011-samplesize.html#两样本t检验两样本均数比较"><i class="fa fa-check"></i><b>11.1.2</b> 两样本t检验（两样本均数比较）</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="1011-samplesize.html"><a href="1011-samplesize.html#多样本均数比较"><i class="fa fa-check"></i><b>11.2</b> 多样本均数比较</a></li>
<li class="chapter" data-level="11.3" data-path="1011-samplesize.html"><a href="1011-samplesize.html#样本率和已知总体率的比较"><i class="fa fa-check"></i><b>11.3</b> 样本率和已知总体率的比较</a></li>
<li class="chapter" data-level="11.4" data-path="1011-samplesize.html"><a href="1011-samplesize.html#两独立样本率的比较"><i class="fa fa-check"></i><b>11.4</b> 两独立样本率的比较</a></li>
<li class="chapter" data-level="11.5" data-path="1011-samplesize.html"><a href="1011-samplesize.html#多样本率的比较"><i class="fa fa-check"></i><b>11.5</b> 多样本率的比较</a></li>
<li class="chapter" data-level="11.6" data-path="1011-samplesize.html"><a href="1011-samplesize.html#直线相关分析"><i class="fa fa-check"></i><b>11.6</b> 直线相关分析</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html"><i class="fa fa-check"></i><b>12</b> 随机分组</a>
<ul>
<li class="chapter" data-level="12.1" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#简单随机"><i class="fa fa-check"></i><b>12.1</b> 简单随机</a></li>
<li class="chapter" data-level="12.2" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#区组随机"><i class="fa fa-check"></i><b>12.2</b> 区组随机</a></li>
<li class="chapter" data-level="12.3" data-path="1012-randomgroup.html"><a href="1012-randomgroup.html#分层随机"><i class="fa fa-check"></i><b>12.3</b> 分层随机</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="1013-rstastix.html"><a href="1013-rstastix.html"><i class="fa fa-check"></i><b>13</b> R语言tidy风格医学统计学</a>
<ul>
<li class="chapter" data-level="13.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#主要函数"><i class="fa fa-check"></i><b>13.1</b> 主要函数</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#描述性统计"><i class="fa fa-check"></i><b>13.1.1</b> 描述性统计</a></li>
<li class="chapter" data-level="13.1.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较均值"><i class="fa fa-check"></i><b>13.1.2</b> 比较均值</a></li>
<li class="chapter" data-level="13.1.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#增强r中的anova"><i class="fa fa-check"></i><b>13.1.3</b> 增强R中的ANOVA</a></li>
<li class="chapter" data-level="13.1.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#事后检验post-hoc"><i class="fa fa-check"></i><b>13.1.4</b> 事后检验（post-hoc）</a></li>
<li class="chapter" data-level="13.1.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较比例"><i class="fa fa-check"></i><b>13.1.5</b> 比较比例</a></li>
<li class="chapter" data-level="13.1.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#比较方差"><i class="fa fa-check"></i><b>13.1.6</b> 比较方差</a></li>
<li class="chapter" data-level="13.1.7" data-path="1013-rstastix.html"><a href="1013-rstastix.html#计算效应量"><i class="fa fa-check"></i><b>13.1.7</b> 计算效应量</a></li>
<li class="chapter" data-level="13.1.8" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关性分析"><i class="fa fa-check"></i><b>13.1.8</b> 相关性分析</a></li>
<li class="chapter" data-level="13.1.9" data-path="1013-rstastix.html"><a href="1013-rstastix.html#添加p值和显著性标记"><i class="fa fa-check"></i><b>13.1.9</b> 添加P值和显著性标记</a></li>
<li class="chapter" data-level="13.1.10" data-path="1013-rstastix.html"><a href="1013-rstastix.html#提取统计信息"><i class="fa fa-check"></i><b>13.1.10</b> 提取统计信息</a></li>
<li class="chapter" data-level="13.1.11" data-path="1013-rstastix.html"><a href="1013-rstastix.html#数据处理辅助函数"><i class="fa fa-check"></i><b>13.1.11</b> 数据处理辅助函数</a></li>
<li class="chapter" data-level="13.1.12" data-path="1013-rstastix.html"><a href="1013-rstastix.html#其他"><i class="fa fa-check"></i><b>13.1.12</b> 其他</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#安装和加载"><i class="fa fa-check"></i><b>13.2</b> 安装和加载</a></li>
<li class="chapter" data-level="13.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#描述性统计-1"><i class="fa fa-check"></i><b>13.3</b> 描述性统计</a></li>
<li class="chapter" data-level="13.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#t检验"><i class="fa fa-check"></i><b>13.4</b> t检验</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#单样本t检验-1"><i class="fa fa-check"></i><b>13.4.1</b> 单样本t检验</a></li>
<li class="chapter" data-level="13.4.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#配对t检验"><i class="fa fa-check"></i><b>13.4.2</b> 配对t检验</a></li>
<li class="chapter" data-level="13.4.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两样本t检验-1"><i class="fa fa-check"></i><b>13.4.3</b> 两样本t检验</a></li>
<li class="chapter" data-level="13.4.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#分组后进行比较"><i class="fa fa-check"></i><b>13.4.4</b> 分组后进行比较</a></li>
<li class="chapter" data-level="13.4.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#多组间的两两比较"><i class="fa fa-check"></i><b>13.4.5</b> 多组间的两两比较</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#方差分析"><i class="fa fa-check"></i><b>13.5</b> 方差分析</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#完全随机设计方差分析"><i class="fa fa-check"></i><b>13.5.1</b> 完全随机设计方差分析</a></li>
<li class="chapter" data-level="13.5.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#随机区组设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.2</b> 随机区组设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#拉丁方设计方差分析-1"><i class="fa fa-check"></i><b>13.5.3</b> 拉丁方设计方差分析</a></li>
<li class="chapter" data-level="13.5.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两阶段交叉设计资料方差分析-1"><i class="fa fa-check"></i><b>13.5.4</b> 两阶段交叉设计资料方差分析</a></li>
<li class="chapter" data-level="13.5.5" data-path="1013-rstastix.html"><a href="1013-rstastix.html#析因设计资料的方差分析"><i class="fa fa-check"></i><b>13.5.5</b> 析因设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#正交设计资料的方差分析-1"><i class="fa fa-check"></i><b>13.5.6</b> 正交设计资料的方差分析</a></li>
<li class="chapter" data-level="13.5.7" data-path="1013-rstastix.html"><a href="1013-rstastix.html#重复测量数据两因素两水平的方差分析-1"><i class="fa fa-check"></i><b>13.5.7</b> 重复测量数据两因素两水平的方差分析</a></li>
<li class="chapter" data-level="13.5.8" data-path="1013-rstastix.html"><a href="1013-rstastix.html#重复测量数据两因素多水平的分析-1"><i class="fa fa-check"></i><b>13.5.8</b> 重复测量数据两因素多水平的分析</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关分析"><i class="fa fa-check"></i><b>13.6</b> 相关分析</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="1013-rstastix.html"><a href="1013-rstastix.html#两个变量"><i class="fa fa-check"></i><b>13.6.1</b> 两个变量</a></li>
<li class="chapter" data-level="13.6.2" data-path="1013-rstastix.html"><a href="1013-rstastix.html#一个变量和其他所有变量"><i class="fa fa-check"></i><b>13.6.2</b> 一个变量和其他所有变量</a></li>
<li class="chapter" data-level="13.6.3" data-path="1013-rstastix.html"><a href="1013-rstastix.html#所有变量间两两相关性"><i class="fa fa-check"></i><b>13.6.3</b> 所有变量间两两相关性</a></li>
<li class="chapter" data-level="13.6.4" data-path="1013-rstastix.html"><a href="1013-rstastix.html#相关矩阵"><i class="fa fa-check"></i><b>13.6.4</b> 相关矩阵</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html"><i class="fa fa-check"></i><b>14</b> R语言多个变量同时进行t检验</a>
<ul>
<li class="chapter" data-level="14.1" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html#简介"><i class="fa fa-check"></i><b>14.1</b> 简介</a></li>
<li class="chapter" data-level="14.2" data-path="1014-rstatixmanyvariables.html"><a href="1014-rstatixmanyvariables.html#实战"><i class="fa fa-check"></i><b>14.2</b> 实战</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="1015-twocorrelation.html"><a href="1015-twocorrelation.html"><i class="fa fa-check"></i><b>15</b> 双变量回归与相关</a>
<ul>
<li class="chapter" data-level="15.1" data-path="1015-twocorrelation.html"><a href="1015-twocorrelation.html#两样本相关"><i class="fa fa-check"></i><b>15.1</b> 两样本相关</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html"><i class="fa fa-check"></i><b>16</b> 偏相关和典型相关</a>
<ul>
<li class="chapter" data-level="16.1" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#偏相关partial-correlation"><i class="fa fa-check"></i><b>16.1</b> 偏相关（partial correlation）</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#偏相关散点图"><i class="fa fa-check"></i><b>16.1.1</b> 偏相关散点图</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="1016-piancorrelation.html"><a href="1016-piancorrelation.html#典型相关canonical-correlation"><i class="fa fa-check"></i><b>16.2</b> 典型相关（Canonical Correlation）</a></li>
</ul></li>
<li class="part"><span><b>II 高级统计分析</b></span></li>
<li class="chapter" data-level="17" data-path="1017-multiregression.html"><a href="1017-multiregression.html"><i class="fa fa-check"></i><b>17</b> 多元线性回归</a>
<ul>
<li class="chapter" data-level="17.1" data-path="1017-multiregression.html"><a href="1017-multiregression.html#多元线性回归"><i class="fa fa-check"></i><b>17.1</b> 多元线性回归</a></li>
<li class="chapter" data-level="17.2" data-path="1017-multiregression.html"><a href="1017-multiregression.html#回归诊断"><i class="fa fa-check"></i><b>17.2</b> 回归诊断</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="1017-multiregression.html"><a href="1017-multiregression.html#可以通过看图来判断"><i class="fa fa-check"></i><b>17.2.1</b> 可以通过看图来判断</a></li>
<li class="chapter" data-level="17.2.2" data-path="1017-multiregression.html"><a href="1017-multiregression.html#也可以通过统计方法验证"><i class="fa fa-check"></i><b>17.2.2</b> 也可以通过统计方法验证</a></li>
<li class="chapter" data-level="17.2.3" data-path="1017-multiregression.html"><a href="1017-multiregression.html#多重共线性的检验"><i class="fa fa-check"></i><b>17.2.3</b> 多重共线性的检验</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="1017-multiregression.html"><a href="1017-multiregression.html#逐步选择法"><i class="fa fa-check"></i><b>17.3</b> 逐步选择法</a></li>
<li class="chapter" data-level="17.4" data-path="1017-multiregression.html"><a href="1017-multiregression.html#全局择优法"><i class="fa fa-check"></i><b>17.4</b> 全局择优法</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="1018-logistic.html"><a href="1018-logistic.html"><i class="fa fa-check"></i><b>18</b> Logistic回归</a>
<ul>
<li class="chapter" data-level="18.1" data-path="1018-logistic.html"><a href="1018-logistic.html#二项logistic回归"><i class="fa fa-check"></i><b>18.1</b> 二项logistic回归</a></li>
<li class="chapter" data-level="18.2" data-path="1018-logistic.html"><a href="1018-logistic.html#多项逻辑回归"><i class="fa fa-check"></i><b>18.2</b> 多项逻辑回归</a></li>
<li class="chapter" data-level="18.3" data-path="1018-logistic.html"><a href="1018-logistic.html#有序逻辑回归"><i class="fa fa-check"></i><b>18.3</b> 有序逻辑回归</a></li>
<li class="chapter" data-level="18.4" data-path="1018-logistic.html"><a href="1018-logistic.html#条件逻辑回归"><i class="fa fa-check"></i><b>18.4</b> 条件逻辑回归</a></li>
<li class="chapter" data-level="18.5" data-path="1018-logistic.html"><a href="1018-logistic.html#参考资料"><i class="fa fa-check"></i><b>18.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html"><i class="fa fa-check"></i><b>19</b> 分类变量进行回归分析时的编码方案</a>
<ul>
<li class="chapter" data-level="19.1" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#演示数据"><i class="fa fa-check"></i><b>19.1</b> 演示数据</a></li>
<li class="chapter" data-level="19.2" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#dummy-coding"><i class="fa fa-check"></i><b>19.2</b> Dummy Coding</a></li>
<li class="chapter" data-level="19.3" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#simple-coding"><i class="fa fa-check"></i><b>19.3</b> simple coding</a></li>
<li class="chapter" data-level="19.4" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#deviation-coding"><i class="fa fa-check"></i><b>19.4</b> Deviation coding</a></li>
<li class="chapter" data-level="19.5" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#orthogonal-polynomial-coding"><i class="fa fa-check"></i><b>19.5</b> Orthogonal Polynomial Coding</a></li>
<li class="chapter" data-level="19.6" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#helmert-coding"><i class="fa fa-check"></i><b>19.6</b> Helmert Coding</a></li>
<li class="chapter" data-level="19.7" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#reverse-helmert-coding"><i class="fa fa-check"></i><b>19.7</b> Reverse Helmert Coding</a></li>
<li class="chapter" data-level="19.8" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#forward-difference-coding"><i class="fa fa-check"></i><b>19.8</b> Forward Difference Coding</a></li>
<li class="chapter" data-level="19.9" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#backward-difference-coding"><i class="fa fa-check"></i><b>19.9</b> Backward Difference Coding</a></li>
<li class="chapter" data-level="19.10" data-path="1019-rcodecheme.html"><a href="1019-rcodecheme.html#参考资料-1"><i class="fa fa-check"></i><b>19.10</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="1020-discriminant.html"><a href="1020-discriminant.html"><i class="fa fa-check"></i><b>20</b> R语言判别分析</a>
<ul>
<li class="chapter" data-level="20.1" data-path="1020-discriminant.html"><a href="1020-discriminant.html#fisher判别分析"><i class="fa fa-check"></i><b>20.1</b> Fisher判别分析</a></li>
<li class="chapter" data-level="20.2" data-path="1020-discriminant.html"><a href="1020-discriminant.html#bayes判别分析"><i class="fa fa-check"></i><b>20.2</b> Bayes判别分析</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="1021-cluster.html"><a href="1021-cluster.html"><i class="fa fa-check"></i><b>21</b> R语言聚类分析</a>
<ul>
<li class="chapter" data-level="21.1" data-path="1021-cluster.html"><a href="1021-cluster.html#系统聚类层次聚类hierarchical-clustering"><i class="fa fa-check"></i><b>21.1</b> 系统聚类（层次聚类,Hierarchical clustering）</a></li>
<li class="chapter" data-level="21.2" data-path="1021-cluster.html"><a href="1021-cluster.html#聚类分析可视化"><i class="fa fa-check"></i><b>21.2</b> 聚类分析可视化</a></li>
<li class="chapter" data-level="21.3" data-path="1021-cluster.html"><a href="1021-cluster.html#快速聚类划分聚类partitioning-clustering"><i class="fa fa-check"></i><b>21.3</b> 快速聚类（划分聚类,partitioning clustering）</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="1021-cluster.html"><a href="1021-cluster.html#k-means聚类"><i class="fa fa-check"></i><b>21.3.1</b> K-means聚类</a></li>
<li class="chapter" data-level="21.3.2" data-path="1021-cluster.html"><a href="1021-cluster.html#围绕中心点的划分pam"><i class="fa fa-check"></i><b>21.3.2</b> 围绕中心点的划分PAM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="1022-pca.html"><a href="1022-pca.html"><i class="fa fa-check"></i><b>22</b> R语言主成分分析</a>
<ul>
<li class="chapter" data-level="22.1" data-path="1022-pca.html"><a href="1022-pca.html#加载数据"><i class="fa fa-check"></i><b>22.1</b> 加载数据</a></li>
<li class="chapter" data-level="22.2" data-path="1022-pca.html"><a href="1022-pca.html#相关性检验"><i class="fa fa-check"></i><b>22.2</b> 相关性检验</a></li>
<li class="chapter" data-level="22.3" data-path="1022-pca.html"><a href="1022-pca.html#kmo和bartlett球形检验"><i class="fa fa-check"></i><b>22.3</b> KMO和Bartlett球形检验</a></li>
<li class="chapter" data-level="22.4" data-path="1022-pca.html"><a href="1022-pca.html#r自带的pca"><i class="fa fa-check"></i><b>22.4</b> R自带的PCA</a></li>
<li class="chapter" data-level="22.5" data-path="1022-pca.html"><a href="1022-pca.html#结果可视化"><i class="fa fa-check"></i><b>22.5</b> 结果可视化</a></li>
<li class="chapter" data-level="22.6" data-path="1022-pca.html"><a href="1022-pca.html#主成分分析可视化超详细"><i class="fa fa-check"></i><b>22.6</b> 主成分分析可视化(超详细)</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="1022-pca.html"><a href="1022-pca.html#进行pca分析"><i class="fa fa-check"></i><b>22.6.1</b> 进行PCA分析</a></li>
<li class="chapter" data-level="22.6.2" data-path="1022-pca.html"><a href="1022-pca.html#特征值可视化"><i class="fa fa-check"></i><b>22.6.2</b> 特征值可视化</a></li>
<li class="chapter" data-level="22.6.3" data-path="1022-pca.html"><a href="1022-pca.html#提取变量结果"><i class="fa fa-check"></i><b>22.6.3</b> 提取变量结果</a></li>
<li class="chapter" data-level="22.6.4" data-path="1022-pca.html"><a href="1022-pca.html#变量结果可视化"><i class="fa fa-check"></i><b>22.6.4</b> 变量结果可视化</a></li>
<li class="chapter" data-level="22.6.5" data-path="1022-pca.html"><a href="1022-pca.html#dimension-description"><i class="fa fa-check"></i><b>22.6.5</b> Dimension description</a></li>
<li class="chapter" data-level="22.6.6" data-path="1022-pca.html"><a href="1022-pca.html#提取样本结果"><i class="fa fa-check"></i><b>22.6.6</b> 提取样本结果</a></li>
<li class="chapter" data-level="22.6.7" data-path="1022-pca.html"><a href="1022-pca.html#样本结果可视化"><i class="fa fa-check"></i><b>22.6.7</b> 样本结果可视化</a></li>
<li class="chapter" data-level="22.6.8" data-path="1022-pca.html"><a href="1022-pca.html#biplot"><i class="fa fa-check"></i><b>22.6.8</b> biplot</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="1022-pca.html"><a href="1022-pca.html#主成分分析可视化3d版"><i class="fa fa-check"></i><b>22.7</b> 主成分分析可视化3d版</a>
<ul>
<li class="chapter" data-level="22.7.1" data-path="1022-pca.html"><a href="1022-pca.html#提取数据"><i class="fa fa-check"></i><b>22.7.1</b> 提取数据</a></li>
<li class="chapter" data-level="22.7.2" data-path="1022-pca.html"><a href="1022-pca.html#d版"><i class="fa fa-check"></i><b>22.7.2</b> 3d版</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="23" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html"><i class="fa fa-check"></i><b>23</b> R语言因子分析</a>
<ul>
<li class="chapter" data-level="23.1" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#演示数据-1"><i class="fa fa-check"></i><b>23.1</b> 演示数据</a></li>
<li class="chapter" data-level="23.2" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#判断需要提取的因子个数"><i class="fa fa-check"></i><b>23.2</b> 判断需要提取的因子个数</a></li>
<li class="chapter" data-level="23.3" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#进行因子分析"><i class="fa fa-check"></i><b>23.3</b> 进行因子分析</a></li>
<li class="chapter" data-level="23.4" data-path="1023-factoranalysis.html"><a href="1023-factoranalysis.html#因子旋转"><i class="fa fa-check"></i><b>23.4</b> 因子旋转</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html"><i class="fa fa-check"></i><b>24</b> 二分类资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="24.1" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法1-1"><i class="fa fa-check"></i><b>24.1</b> 方法1</a></li>
<li class="chapter" data-level="24.2" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法2-1"><i class="fa fa-check"></i><b>24.2</b> 方法2</a></li>
<li class="chapter" data-level="24.3" data-path="1024-rocbinomial.html"><a href="1024-rocbinomial.html#方法3"><i class="fa fa-check"></i><b>24.3</b> 方法3</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html"><i class="fa fa-check"></i><b>25</b> 生存资料ROC曲线绘制</a>
<ul>
<li class="chapter" data-level="25.1" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#加载r包和数据"><i class="fa fa-check"></i><b>25.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="25.2" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#多个时间点roc"><i class="fa fa-check"></i><b>25.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="25.3" data-path="1025-rocsurvival.html"><a href="1025-rocsurvival.html#多指标roc"><i class="fa fa-check"></i><b>25.3</b> 多指标ROC</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html"><i class="fa fa-check"></i><b>26</b> 生存资料ROC曲线的最佳截点和平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#平滑曲线"><i class="fa fa-check"></i><b>26.1</b> 平滑曲线</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#加载r包和数据-1"><i class="fa fa-check"></i><b>26.1.1</b> 加载R包和数据</a></li>
<li class="chapter" data-level="26.1.2" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#多个时间点roc-1"><i class="fa fa-check"></i><b>26.1.2</b> 多个时间点ROC</a></li>
<li class="chapter" data-level="26.1.3" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#画平滑曲线"><i class="fa fa-check"></i><b>26.1.3</b> 画平滑曲线</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="1026-rocsurvsmooth.html"><a href="1026-rocsurvsmooth.html#找最佳截点"><i class="fa fa-check"></i><b>26.2</b> 找最佳截点</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="1027-roccompare.html"><a href="1027-roccompare.html"><i class="fa fa-check"></i><b>27</b> ROC曲线的显著性检验</a>
<ul>
<li class="chapter" data-level="27.1" data-path="1027-roccompare.html"><a href="1027-roccompare.html#二分类资料的roc比较"><i class="fa fa-check"></i><b>27.1</b> 二分类资料的ROC比较</a></li>
<li class="chapter" data-level="27.2" data-path="1027-roccompare.html"><a href="1027-roccompare.html#生存资料roc的比较"><i class="fa fa-check"></i><b>27.2</b> 生存资料ROC的比较</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html"><i class="fa fa-check"></i><b>28</b> ROC阴性结果还是阳性结果</a>
<ul>
<li class="chapter" data-level="28.1" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html#探索roc曲线"><i class="fa fa-check"></i><b>28.1</b> 探索ROC曲线</a></li>
<li class="chapter" data-level="28.2" data-path="1028-rocdirection.html"><a href="1028-rocdirection.html#反过来可以吗"><i class="fa fa-check"></i><b>28.2</b> 反过来可以吗？</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html"><i class="fa fa-check"></i><b>29</b> ROC曲线ggplot2绘制</a>
<ul>
<li class="chapter" data-level="29.1" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#准备数据"><i class="fa fa-check"></i><b>29.1</b> 准备数据</a></li>
<li class="chapter" data-level="29.2" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#计算"><i class="fa fa-check"></i><b>29.2</b> 计算</a></li>
<li class="chapter" data-level="29.3" data-path="1029-rocggplot.html"><a href="1029-rocggplot.html#画图"><i class="fa fa-check"></i><b>29.3</b> 画图</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="1030-rocattention.html"><a href="1030-rocattention.html"><i class="fa fa-check"></i><b>30</b> R语言计算AUC(ROC)注意事项</a>
<ul>
<li class="chapter" data-level="30.1" data-path="1030-rocattention.html"><a href="1030-rocattention.html#准备数据-1"><i class="fa fa-check"></i><b>30.1</b> 准备数据</a></li>
<li class="chapter" data-level="30.2" data-path="1030-rocattention.html"><a href="1030-rocattention.html#rocr"><i class="fa fa-check"></i><b>30.2</b> ROCR</a></li>
<li class="chapter" data-level="30.3" data-path="1030-rocattention.html"><a href="1030-rocattention.html#proc"><i class="fa fa-check"></i><b>30.3</b> pROC</a></li>
<li class="chapter" data-level="30.4" data-path="1030-rocattention.html"><a href="1030-rocattention.html#yardstick"><i class="fa fa-check"></i><b>30.4</b> yardstick</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="1031-rocmany.html"><a href="1031-rocmany.html"><i class="fa fa-check"></i><b>31</b> 多指标联合诊断的ROC曲线</a>
<ul>
<li class="chapter" data-level="31.1" data-path="1031-rocmany.html"><a href="1031-rocmany.html#准备数据-2"><i class="fa fa-check"></i><b>31.1</b> 准备数据</a></li>
<li class="chapter" data-level="31.2" data-path="1031-rocmany.html"><a href="1031-rocmany.html#多指标联合诊断的roc"><i class="fa fa-check"></i><b>31.2</b> 多指标联合诊断的ROC</a></li>
<li class="chapter" data-level="31.3" data-path="1031-rocmany.html"><a href="1031-rocmany.html#测试集怎么办"><i class="fa fa-check"></i><b>31.3</b> 测试集怎么办？</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html"><i class="fa fa-check"></i><b>32</b> R语言生存分析</a>
<ul>
<li class="chapter" data-level="32.1" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#生存过程的描述"><i class="fa fa-check"></i><b>32.1</b> 生存过程的描述</a></li>
<li class="chapter" data-level="32.2" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#生存过程的比较"><i class="fa fa-check"></i><b>32.2</b> 生存过程的比较</a></li>
<li class="chapter" data-level="32.3" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#cox回归"><i class="fa fa-check"></i><b>32.3</b> Cox回归</a></li>
<li class="chapter" data-level="32.4" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#时间依存协变量的cox回归和时间依存系数cox回归"><i class="fa fa-check"></i><b>32.4</b> 时间依存协变量的Cox回归和时间依存系数Cox回归</a>
<ul>
<li class="chapter" data-level="32.4.1" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#对时间分层"><i class="fa fa-check"></i><b>32.4.1</b> 对时间分层</a></li>
<li class="chapter" data-level="32.4.2" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#连续性时依系数变换"><i class="fa fa-check"></i><b>32.4.2</b> 连续性时依系数变换</a></li>
</ul></li>
<li class="chapter" data-level="32.5" data-path="1032-survivalanalysis.html"><a href="1032-survivalanalysis.html#参考资料-2"><i class="fa fa-check"></i><b>32.5</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html"><i class="fa fa-check"></i><b>33</b> R语言超详细的生存曲线可视化</a>
<ul>
<li class="chapter" data-level="33.1" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#演示数据-2"><i class="fa fa-check"></i><b>33.1</b> 演示数据</a></li>
<li class="chapter" data-level="33.2" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#基本的生存曲线"><i class="fa fa-check"></i><b>33.2</b> 基本的生存曲线</a></li>
<li class="chapter" data-level="33.3" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#增加-risk-table"><i class="fa fa-check"></i><b>33.3</b> 增加 risk table</a></li>
<li class="chapter" data-level="33.4" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#增加删失时间表ncensor-plot"><i class="fa fa-check"></i><b>33.4</b> 增加删失时间表ncensor plot</a></li>
<li class="chapter" data-level="33.5" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#超级无敌精细化自定设置"><i class="fa fa-check"></i><b>33.5</b> 超级无敌精细化自定设置</a></li>
<li class="chapter" data-level="33.6" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个组的生存曲线"><i class="fa fa-check"></i><b>33.6</b> 多个组的生存曲线</a></li>
<li class="chapter" data-level="33.7" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个分类变量分面绘制"><i class="fa fa-check"></i><b>33.7</b> 多个分类变量分面绘制</a></li>
<li class="chapter" data-level="33.8" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#同时绘制多个生存函数"><i class="fa fa-check"></i><b>33.8</b> 同时绘制多个生存函数</a></li>
<li class="chapter" data-level="33.9" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#根据某一个变量分组绘制"><i class="fa fa-check"></i><b>33.9</b> 根据某一个变量分组绘制</a></li>
<li class="chapter" data-level="33.10" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#在原有生存曲线的基础上增加"><i class="fa fa-check"></i><b>33.10</b> 在原有生存曲线的基础上增加</a></li>
<li class="chapter" data-level="33.11" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#多个生存函数画在一起"><i class="fa fa-check"></i><b>33.11</b> 多个生存函数画在一起</a></li>
<li class="chapter" data-level="33.12" data-path="1033-survivalvisiualization.html"><a href="1033-survivalvisiualization.html#参考资料-3"><i class="fa fa-check"></i><b>33.12</b> 参考资料</a></li>
</ul></li>
<li class="part"><span><b>III 文献中常用的统计方法</b></span></li>
<li class="chapter" data-level="34" data-path="1034-finygray.html"><a href="1034-finygray.html"><i class="fa fa-check"></i><b>34</b> Fine-Gray检验、竞争风险模型列线图绘制</a>
<ul>
<li class="chapter" data-level="34.1" data-path="1034-finygray.html"><a href="1034-finygray.html#加载数据和r包"><i class="fa fa-check"></i><b>34.1</b> 加载数据和R包</a></li>
<li class="chapter" data-level="34.2" data-path="1034-finygray.html"><a href="1034-finygray.html#fine-gray检验单因素分析"><i class="fa fa-check"></i><b>34.2</b> Fine-Gray检验（单因素分析）</a>
<ul>
<li class="chapter" data-level="34.2.1" data-path="1034-finygray.html"><a href="1034-finygray.html#图形展示结果"><i class="fa fa-check"></i><b>34.2.1</b> 图形展示结果</a></li>
<li class="chapter" data-level="34.2.2" data-path="1034-finygray.html"><a href="1034-finygray.html#ggplot2"><i class="fa fa-check"></i><b>34.2.2</b> ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="34.3" data-path="1034-finygray.html"><a href="1034-finygray.html#竞争风险模型多因素分析"><i class="fa fa-check"></i><b>34.3</b> 竞争风险模型（多因素分析）</a></li>
<li class="chapter" data-level="34.4" data-path="1034-finygray.html"><a href="1034-finygray.html#列线图"><i class="fa fa-check"></i><b>34.4</b> 列线图</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="1035-psm.html"><a href="1035-psm.html"><i class="fa fa-check"></i><b>35</b> R语言倾向性评分：匹配</a>
<ul>
<li class="chapter" data-level="35.1" data-path="1035-psm.html"><a href="1035-psm.html#准备数据-3"><i class="fa fa-check"></i><b>35.1</b> 准备数据</a></li>
<li class="chapter" data-level="35.2" data-path="1035-psm.html"><a href="1035-psm.html#matchit包进行psm"><i class="fa fa-check"></i><b>35.2</b> matchIt包进行PSM</a>
<ul>
<li class="chapter" data-level="35.2.1" data-path="1035-psm.html"><a href="1035-psm.html#使用随机森林计算ps"><i class="fa fa-check"></i><b>35.2.1</b> 使用随机森林计算PS</a></li>
</ul></li>
<li class="chapter" data-level="35.3" data-path="1035-psm.html"><a href="1035-psm.html#主要匹配方法选择"><i class="fa fa-check"></i><b>35.3</b> 主要匹配方法选择</a></li>
<li class="chapter" data-level="35.4" data-path="1035-psm.html"><a href="1035-psm.html#匹配后数据的平衡性检验"><i class="fa fa-check"></i><b>35.4</b> 匹配后数据的平衡性检验</a>
<ul>
<li class="chapter" data-level="35.4.1" data-path="1035-psm.html"><a href="1035-psm.html#cobalt包"><i class="fa fa-check"></i><b>35.4.1</b> cobalt包</a></li>
<li class="chapter" data-level="35.4.2" data-path="1035-psm.html"><a href="1035-psm.html#统计检验衡量均衡性"><i class="fa fa-check"></i><b>35.4.2</b> 统计检验衡量均衡性</a></li>
</ul></li>
<li class="chapter" data-level="35.5" data-path="1035-psm.html"><a href="1035-psm.html#结果可视化-1"><i class="fa fa-check"></i><b>35.5</b> 结果可视化</a></li>
<li class="chapter" data-level="35.6" data-path="1035-psm.html"><a href="1035-psm.html#不平衡怎么办"><i class="fa fa-check"></i><b>35.6</b> 不平衡怎么办？</a></li>
<li class="chapter" data-level="35.7" data-path="1035-psm.html"><a href="1035-psm.html#其他问题"><i class="fa fa-check"></i><b>35.7</b> 其他问题</a></li>
<li class="chapter" data-level="35.8" data-path="1035-psm.html"><a href="1035-psm.html#参考资料-4"><i class="fa fa-check"></i><b>35.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="1036-pssc.html"><a href="1036-pssc.html"><i class="fa fa-check"></i><b>36</b> R语言倾向性评分：回归和分层</a>
<ul>
<li class="chapter" data-level="36.1" data-path="1036-pssc.html"><a href="1036-pssc.html#演示数据-3"><i class="fa fa-check"></i><b>36.1</b> 演示数据</a></li>
<li class="chapter" data-level="36.2" data-path="1036-pssc.html"><a href="1036-pssc.html#原始数据的概况"><i class="fa fa-check"></i><b>36.2</b> 原始数据的概况</a></li>
<li class="chapter" data-level="36.3" data-path="1036-pssc.html"><a href="1036-pssc.html#计算倾向性评分"><i class="fa fa-check"></i><b>36.3</b> 计算倾向性评分</a></li>
<li class="chapter" data-level="36.4" data-path="1036-pssc.html"><a href="1036-pssc.html#倾向性评分回归"><i class="fa fa-check"></i><b>36.4</b> 倾向性评分回归</a></li>
<li class="chapter" data-level="36.5" data-path="1036-pssc.html"><a href="1036-pssc.html#倾向性评分分层"><i class="fa fa-check"></i><b>36.5</b> 倾向性评分分层</a></li>
<li class="chapter" data-level="36.6" data-path="1036-pssc.html"><a href="1036-pssc.html#分层后的数据"><i class="fa fa-check"></i><b>36.6</b> 分层后的数据</a></li>
<li class="chapter" data-level="36.7" data-path="1036-pssc.html"><a href="1036-pssc.html#总结"><i class="fa fa-check"></i><b>36.7</b> 总结</a></li>
<li class="chapter" data-level="36.8" data-path="1036-pssc.html"><a href="1036-pssc.html#参考资料-5"><i class="fa fa-check"></i><b>36.8</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="1037-psw.html"><a href="1037-psw.html"><i class="fa fa-check"></i><b>37</b> R语言倾向性评分：加权</a>
<ul>
<li class="chapter" data-level="37.1" data-path="1037-psw.html"><a href="1037-psw.html#演示数据-4"><i class="fa fa-check"></i><b>37.1</b> 演示数据</a></li>
<li class="chapter" data-level="37.2" data-path="1037-psw.html"><a href="1037-psw.html#iptw"><i class="fa fa-check"></i><b>37.2</b> IPTW</a></li>
<li class="chapter" data-level="37.3" data-path="1037-psw.html"><a href="1037-psw.html#重叠加权"><i class="fa fa-check"></i><b>37.3</b> 重叠加权</a></li>
<li class="chapter" data-level="37.4" data-path="1037-psw.html"><a href="1037-psw.html#参考资料-6"><i class="fa fa-check"></i><b>37.4</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="1038-p4trend.html"><a href="1038-p4trend.html"><i class="fa fa-check"></i><b>38</b> p for trend/ p for interaction/ per 1 sd 的R语言实现</a>
<ul>
<li class="chapter" data-level="38.1" data-path="1038-p4trend.html"><a href="1038-p4trend.html#p-for-trend"><i class="fa fa-check"></i><b>38.1</b> P for trend</a></li>
<li class="chapter" data-level="38.2" data-path="1038-p4trend.html"><a href="1038-p4trend.html#p-for-interaction"><i class="fa fa-check"></i><b>38.2</b> p for interaction</a>
<ul>
<li class="chapter" data-level="38.2.1" data-path="1038-p4trend.html"><a href="1038-p4trend.html#方法1-2"><i class="fa fa-check"></i><b>38.2.1</b> 方法1</a></li>
<li class="chapter" data-level="38.2.2" data-path="1038-p4trend.html"><a href="1038-p4trend.html#方法2-2"><i class="fa fa-check"></i><b>38.2.2</b> 方法2</a></li>
</ul></li>
<li class="chapter" data-level="38.3" data-path="1038-p4trend.html"><a href="1038-p4trend.html#per-1-sd"><i class="fa fa-check"></i><b>38.3</b> per 1 sd</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html"><i class="fa fa-check"></i><b>39</b> R语言多项式拟合及样条回归</a>
<ul>
<li class="chapter" data-level="39.1" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#多项式拟合"><i class="fa fa-check"></i><b>39.1</b> 多项式拟合</a></li>
<li class="chapter" data-level="39.2" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#样条回归"><i class="fa fa-check"></i><b>39.2</b> 样条回归</a>
<ul>
<li class="chapter" data-level="39.2.1" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#线性的立方样条"><i class="fa fa-check"></i><b>39.2.1</b> 线性的立方样条</a></li>
<li class="chapter" data-level="39.2.2" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#逻辑回归的立方样条"><i class="fa fa-check"></i><b>39.2.2</b> 逻辑回归的立方样条</a></li>
<li class="chapter" data-level="39.2.3" data-path="1039-nonlinearfit.html"><a href="1039-nonlinearfit.html#cox回归的立方样条"><i class="fa fa-check"></i><b>39.2.3</b> cox回归的立方样条</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV 附录</b></span></li>
<li class="chapter" data-level="40" data-path="1040-appendix.html"><a href="1040-appendix.html"><i class="fa fa-check"></i><b>40</b> R语言和R包安装</a>
<ul>
<li class="chapter" data-level="40.1" data-path="1040-appendix.html"><a href="1040-appendix.html#r语言rtoolsrstudio的安装"><i class="fa fa-check"></i><b>40.1</b> R语言、Rtools、Rstudio的安装</a></li>
<li class="chapter" data-level="40.2" data-path="1040-appendix.html"><a href="1040-appendix.html#r包安装"><i class="fa fa-check"></i><b>40.2</b> R包安装</a></li>
<li class="chapter" data-level="40.3" data-path="1040-appendix.html"><a href="1040-appendix.html#pass软件链接"><i class="fa fa-check"></i><b>40.3</b> PASS软件链接</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由bookdown强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R语言实战医学统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="yplksjhfk" class="section level1 hasAnchor" number="37">
<h1><span class="header-section-number">37</span> R语言倾向性评分：加权<a href="1037-psw.html#yplksjhfk" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>之前已经介绍过<strong>倾向性评分匹配（propensity score matching）</strong>、<strong>倾向性评分回归和分层</strong>。</p>
<p>今天继续介绍倾向性评分最后一个重要的部分：<strong>倾向性评分加权</strong>。</p>
<p>主要介绍两种加权方法：<strong>逆概率加权</strong>(inverse probability weighting, IPW)和<strong>重叠加权</strong>(overlap weighting)。</p>
<p>倾向性评分加权的方法有很多，常见的一些加权方法比较如下：</p>
<p><img src="figs/Snipaste_2023-04-05_17-06-17.png" width="90%" /></p>
<p>其中<code>ATE</code>就是大家比较常见的<code>IPW</code>方法，还有一种常见的<strong>inverse probability of treatment weighting, IPTW</strong>，是这里的<code>ATT</code>。前者是针对所有研究对象，后者是针对病例组。</p>
<div id="演示数据-4" class="section level2 hasAnchor" number="37.1">
<h2><span class="header-section-number">37.1</span> 演示数据<a href="1037-psw.html#演示数据-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="1037-psw.html#cb605-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lindner, <span class="at">package =</span> <span class="st">&quot;twang&quot;</span>)</span>
<span id="cb605-2"><a href="1037-psw.html#cb605-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb605-3"><a href="1037-psw.html#cb605-3" aria-hidden="true" tabindex="-1"></a>lindner[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(lindner[,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>)],factor)</span>
<span id="cb605-4"><a href="1037-psw.html#cb605-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb605-5"><a href="1037-psw.html#cb605-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(lindner)</span>
<span id="cb605-6"><a href="1037-psw.html#cb605-6" aria-hidden="true" tabindex="-1"></a><span class="do">## &#39;data.frame&#39;:    996 obs. of  11 variables:</span></span>
<span id="cb605-7"><a href="1037-psw.html#cb605-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ lifepres       : num  0 11.6 11.6 11.6 11.6 11.6 11.6 11.6 11.6 11.6 ...</span></span>
<span id="cb605-8"><a href="1037-psw.html#cb605-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ cardbill       : int  14301 3563 4694 7366 8247 8319 8410 8517 8763 8823 ...</span></span>
<span id="cb605-9"><a href="1037-psw.html#cb605-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ abcix          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb605-10"><a href="1037-psw.html#cb605-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ stent          : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb605-11"><a href="1037-psw.html#cb605-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ height         : int  163 168 188 175 168 178 185 173 152 180 ...</span></span>
<span id="cb605-12"><a href="1037-psw.html#cb605-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ female         : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 1 1 2 1 1 2 2 1 ...</span></span>
<span id="cb605-13"><a href="1037-psw.html#cb605-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ diabetic       : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 1 2 1 1 1 1 1 1 ...</span></span>
<span id="cb605-14"><a href="1037-psw.html#cb605-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ acutemi        : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb605-15"><a href="1037-psw.html#cb605-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ejecfrac       : int  56 56 50 50 55 50 58 30 60 60 ...</span></span>
<span id="cb605-16"><a href="1037-psw.html#cb605-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ ves1proc       : Factor w/ 6 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span id="cb605-17"><a href="1037-psw.html#cb605-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ sixMonthSurvive: logi  FALSE TRUE TRUE TRUE TRUE TRUE ...</span></span></code></pre></div>
<p><img src="figs/Snipaste_2023-04-05_17-06-55.png" width="90%" /></p>
<p>其中<code>abcix</code>是处理因素变量，<code>sixMonthSurvive</code>是二分类的结局变量，<code>cardbill</code>是连续型的结局变量，其余变量是协变量。</p>
<p>首先可以通过<code>tableone</code>包看一下加权前的数据情况：</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="1037-psw.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tableone)</span>
<span id="cb606-2"><a href="1037-psw.html#cb606-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-3"><a href="1037-psw.html#cb606-3" aria-hidden="true" tabindex="-1"></a>covs <span class="ot">&lt;-</span> <span class="fu">colnames</span>(lindner)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb606-4"><a href="1037-psw.html#cb606-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-5"><a href="1037-psw.html#cb606-5" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">CreateTableOne</span>(<span class="at">vars =</span> covs,</span>
<span id="cb606-6"><a href="1037-psw.html#cb606-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">strata =</span> <span class="st">&quot;abcix&quot;</span>,</span>
<span id="cb606-7"><a href="1037-psw.html#cb606-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">data =</span> lindner</span>
<span id="cb606-8"><a href="1037-psw.html#cb606-8" aria-hidden="true" tabindex="-1"></a>                      )</span>
<span id="cb606-9"><a href="1037-psw.html#cb606-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab,<span class="at">showAllLevels =</span> T,<span class="at">smd =</span> T)</span>
<span id="cb606-10"><a href="1037-psw.html#cb606-10" aria-hidden="true" tabindex="-1"></a><span class="do">##                       Stratified by abcix</span></span>
<span id="cb606-11"><a href="1037-psw.html#cb606-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                        level 0              1              p      test SMD   </span></span>
<span id="cb606-12"><a href="1037-psw.html#cb606-12" aria-hidden="true" tabindex="-1"></a><span class="do">##   n                             298            698                           </span></span>
<span id="cb606-13"><a href="1037-psw.html#cb606-13" aria-hidden="true" tabindex="-1"></a><span class="do">##   lifepres (mean (SD))        11.02 (2.54)   11.42 (1.45)   0.002       0.194</span></span>
<span id="cb606-14"><a href="1037-psw.html#cb606-14" aria-hidden="true" tabindex="-1"></a><span class="do">##   stent (%)            0        124 (41.6)     206 (29.5)  &lt;0.001       0.255</span></span>
<span id="cb606-15"><a href="1037-psw.html#cb606-15" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1        174 (58.4)     492 (70.5)                    </span></span>
<span id="cb606-16"><a href="1037-psw.html#cb606-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   height (mean (SD))         171.45 (10.59) 171.44 (10.69)  0.996      &lt;0.001</span></span>
<span id="cb606-17"><a href="1037-psw.html#cb606-17" aria-hidden="true" tabindex="-1"></a><span class="do">##   female (%)           0        183 (61.4)     467 (66.9)   0.111       0.115</span></span>
<span id="cb606-18"><a href="1037-psw.html#cb606-18" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1        115 (38.6)     231 (33.1)                    </span></span>
<span id="cb606-19"><a href="1037-psw.html#cb606-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   diabetic (%)         0        218 (73.2)     555 (79.5)   0.034       0.150</span></span>
<span id="cb606-20"><a href="1037-psw.html#cb606-20" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1         80 (26.8)     143 (20.5)                    </span></span>
<span id="cb606-21"><a href="1037-psw.html#cb606-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   acutemi (%)          0        280 (94.0)     573 (82.1)  &lt;0.001       0.372</span></span>
<span id="cb606-22"><a href="1037-psw.html#cb606-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1         18 ( 6.0)     125 (17.9)                    </span></span>
<span id="cb606-23"><a href="1037-psw.html#cb606-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   ejecfrac (mean (SD))        52.29 (10.30)  50.40 (10.42)  0.009       0.182</span></span>
<span id="cb606-24"><a href="1037-psw.html#cb606-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   ves1proc (%)         0          1 ( 0.3)       3 ( 0.4)  &lt;0.001       0.446</span></span>
<span id="cb606-25"><a href="1037-psw.html#cb606-25" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1        243 (81.5)     437 (62.6)                    </span></span>
<span id="cb606-26"><a href="1037-psw.html#cb606-26" aria-hidden="true" tabindex="-1"></a><span class="do">##                        2         47 (15.8)     205 (29.4)                    </span></span>
<span id="cb606-27"><a href="1037-psw.html#cb606-27" aria-hidden="true" tabindex="-1"></a><span class="do">##                        3          6 ( 2.0)      39 ( 5.6)                    </span></span>
<span id="cb606-28"><a href="1037-psw.html#cb606-28" aria-hidden="true" tabindex="-1"></a><span class="do">##                        4          1 ( 0.3)      13 ( 1.9)                    </span></span>
<span id="cb606-29"><a href="1037-psw.html#cb606-29" aria-hidden="true" tabindex="-1"></a><span class="do">##                        5          0 ( 0.0)       1 ( 0.1)</span></span></code></pre></div>
<p>如果只是看一下协变量是否在不同组间均衡，可以通过之前介绍过的<code>cobalt</code>实现：</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="1037-psw.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cobalt)</span>
<span id="cb607-2"><a href="1037-psw.html#cb607-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  cobalt (Version 4.4.1, Build Date: 2022-11-03)</span></span>
<span id="cb607-3"><a href="1037-psw.html#cb607-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-4"><a href="1037-psw.html#cb607-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 选择只有协变量的数据框</span></span>
<span id="cb607-5"><a href="1037-psw.html#cb607-5" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">subset</span>(lindner, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb607-6"><a href="1037-psw.html#cb607-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-7"><a href="1037-psw.html#cb607-7" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(covariates,<span class="at">treat =</span> lindner<span class="sc">$</span>abcix, <span class="at">s.d.denom =</span> <span class="st">&quot;pooled&quot;</span>,</span>
<span id="cb607-8"><a href="1037-psw.html#cb607-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">m.threshold =</span> <span class="fl">0.1</span>, <span class="at">un =</span> <span class="cn">TRUE</span>,</span>
<span id="cb607-9"><a href="1037-psw.html#cb607-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.threshold =</span> <span class="dv">2</span></span>
<span id="cb607-10"><a href="1037-psw.html#cb607-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb607-11"><a href="1037-psw.html#cb607-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance Measures</span></span>
<span id="cb607-12"><a href="1037-psw.html#cb607-12" aria-hidden="true" tabindex="-1"></a><span class="do">##               Type Diff.Un     M.Threshold.Un V.Ratio.Un   V.Threshold.Un</span></span>
<span id="cb607-13"><a href="1037-psw.html#cb607-13" aria-hidden="true" tabindex="-1"></a><span class="do">## lifepres   Contin.  0.1941 Not Balanced, &gt;0.1     0.3239 Not Balanced, &gt;2</span></span>
<span id="cb607-14"><a href="1037-psw.html#cb607-14" aria-hidden="true" tabindex="-1"></a><span class="do">## stent       Binary  0.1210 Not Balanced, &gt;0.1          .                 </span></span>
<span id="cb607-15"><a href="1037-psw.html#cb607-15" aria-hidden="true" tabindex="-1"></a><span class="do">## height     Contin. -0.0003     Balanced, &lt;0.1     1.0201     Balanced, &lt;2</span></span>
<span id="cb607-16"><a href="1037-psw.html#cb607-16" aria-hidden="true" tabindex="-1"></a><span class="do">## female      Binary -0.0550     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-17"><a href="1037-psw.html#cb607-17" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic    Binary -0.0636     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-18"><a href="1037-psw.html#cb607-18" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi     Binary  0.1187 Not Balanced, &gt;0.1          .                 </span></span>
<span id="cb607-19"><a href="1037-psw.html#cb607-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac   Contin. -0.1821 Not Balanced, &gt;0.1     1.0238     Balanced, &lt;2</span></span>
<span id="cb607-20"><a href="1037-psw.html#cb607-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_0  Binary  0.0009     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-21"><a href="1037-psw.html#cb607-21" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_1  Binary -0.1894 Not Balanced, &gt;0.1          .                 </span></span>
<span id="cb607-22"><a href="1037-psw.html#cb607-22" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_2  Binary  0.1360 Not Balanced, &gt;0.1          .                 </span></span>
<span id="cb607-23"><a href="1037-psw.html#cb607-23" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_3  Binary  0.0357     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-24"><a href="1037-psw.html#cb607-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_4  Binary  0.0153     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-25"><a href="1037-psw.html#cb607-25" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_5  Binary  0.0014     Balanced, &lt;0.1          .                 </span></span>
<span id="cb607-26"><a href="1037-psw.html#cb607-26" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-27"><a href="1037-psw.html#cb607-27" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance tally for mean differences</span></span>
<span id="cb607-28"><a href="1037-psw.html#cb607-28" aria-hidden="true" tabindex="-1"></a><span class="do">##                    count</span></span>
<span id="cb607-29"><a href="1037-psw.html#cb607-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Balanced, &lt;0.1         7</span></span>
<span id="cb607-30"><a href="1037-psw.html#cb607-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Not Balanced, &gt;0.1     6</span></span>
<span id="cb607-31"><a href="1037-psw.html#cb607-31" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-32"><a href="1037-psw.html#cb607-32" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable with the greatest mean difference</span></span>
<span id="cb607-33"><a href="1037-psw.html#cb607-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  Variable Diff.Un     M.Threshold.Un</span></span>
<span id="cb607-34"><a href="1037-psw.html#cb607-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  lifepres  0.1941 Not Balanced, &gt;0.1</span></span>
<span id="cb607-35"><a href="1037-psw.html#cb607-35" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-36"><a href="1037-psw.html#cb607-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance tally for variance ratios</span></span>
<span id="cb607-37"><a href="1037-psw.html#cb607-37" aria-hidden="true" tabindex="-1"></a><span class="do">##                  count</span></span>
<span id="cb607-38"><a href="1037-psw.html#cb607-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Balanced, &lt;2         2</span></span>
<span id="cb607-39"><a href="1037-psw.html#cb607-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Not Balanced, &gt;2     1</span></span>
<span id="cb607-40"><a href="1037-psw.html#cb607-40" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-41"><a href="1037-psw.html#cb607-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable with the greatest variance ratio</span></span>
<span id="cb607-42"><a href="1037-psw.html#cb607-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  Variable V.Ratio.Un   V.Threshold.Un</span></span>
<span id="cb607-43"><a href="1037-psw.html#cb607-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  lifepres     0.3239 Not Balanced, &gt;2</span></span>
<span id="cb607-44"><a href="1037-psw.html#cb607-44" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb607-45"><a href="1037-psw.html#cb607-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Sample sizes</span></span>
<span id="cb607-46"><a href="1037-psw.html#cb607-46" aria-hidden="true" tabindex="-1"></a><span class="do">##     Control Treated</span></span>
<span id="cb607-47"><a href="1037-psw.html#cb607-47" aria-hidden="true" tabindex="-1"></a><span class="do">## All     298     698</span></span></code></pre></div>
<p><code>Diff.Adj</code>就是<code>SMD</code></p>
</div>
<div id="iptw" class="section level2 hasAnchor" number="37.2">
<h2><span class="header-section-number">37.2</span> IPTW<a href="1037-psw.html#iptw" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>倾向性评分只是一个概率（倾向干预组的概率）</strong>，计算概率的算法是在是太多了，选择自己喜欢的就好，我这里就用最简单的逻辑回归，之前的推文中也演示过随机森林等其他估计PS的方法。</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="1037-psw.html#cb608-1" aria-hidden="true" tabindex="-1"></a>psfit <span class="ot">&lt;-</span> <span class="fu">glm</span>(abcix <span class="sc">~</span> stent <span class="sc">+</span> height <span class="sc">+</span> female <span class="sc">+</span> diabetic <span class="sc">+</span> acutemi <span class="sc">+</span> </span>
<span id="cb608-2"><a href="1037-psw.html#cb608-2" aria-hidden="true" tabindex="-1"></a>               ejecfrac <span class="sc">+</span> ves1proc,</span>
<span id="cb608-3"><a href="1037-psw.html#cb608-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> lindner, <span class="at">family =</span> <span class="fu">binomial</span>())</span>
<span id="cb608-4"><a href="1037-psw.html#cb608-4" aria-hidden="true" tabindex="-1"></a>ps <span class="ot">&lt;-</span> psfit<span class="sc">$</span>fitted.values</span></code></pre></div>
<p>逆概率加权以全部研究对象（ATE）为目标人群，通过加权是每一组研究对象的协变量分布于全部研究对象相似。</p>
<p>该种加权方法下，研究对象的权重为该对象所在组的概率的倒数。</p>
<ul>
<li>干预组：1/ps</li>
<li>对照组：1/(1-ps)</li>
</ul>
<p>下面根据计算出的PS计算每一个样本的权重：</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="1037-psw.html#cb609-1" aria-hidden="true" tabindex="-1"></a>iptw <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(lindner<span class="sc">$</span>abcix <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span>ps, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>ps))</span>
<span id="cb609-2"><a href="1037-psw.html#cb609-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb609-3"><a href="1037-psw.html#cb609-3" aria-hidden="true" tabindex="-1"></a>lindner<span class="sc">$</span>iptw <span class="ot">&lt;-</span> iptw</span></code></pre></div>
<p>加权后可以再次看看数据是否已经均衡：</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="1037-psw.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(covariates,<span class="at">treat =</span> lindner<span class="sc">$</span>abcix, <span class="at">s.d.denom =</span> <span class="st">&quot;pooled&quot;</span>,</span>
<span id="cb610-2"><a href="1037-psw.html#cb610-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">weights =</span> lindner<span class="sc">$</span>iptw,</span>
<span id="cb610-3"><a href="1037-psw.html#cb610-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">m.threshold =</span> <span class="fl">0.1</span>, <span class="at">un =</span> <span class="cn">TRUE</span>,</span>
<span id="cb610-4"><a href="1037-psw.html#cb610-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">v.threshold =</span> <span class="dv">2</span></span>
<span id="cb610-5"><a href="1037-psw.html#cb610-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb610-6"><a href="1037-psw.html#cb610-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance Measures</span></span>
<span id="cb610-7"><a href="1037-psw.html#cb610-7" aria-hidden="true" tabindex="-1"></a><span class="do">##               Type Diff.Un V.Ratio.Un Diff.Adj        M.Threshold V.Ratio.Adj</span></span>
<span id="cb610-8"><a href="1037-psw.html#cb610-8" aria-hidden="true" tabindex="-1"></a><span class="do">## lifepres   Contin.  0.1941     0.3239   0.3310 Not Balanced, &gt;0.1      0.2185</span></span>
<span id="cb610-9"><a href="1037-psw.html#cb610-9" aria-hidden="true" tabindex="-1"></a><span class="do">## stent       Binary  0.1210          .   0.0036     Balanced, &lt;0.1           .</span></span>
<span id="cb610-10"><a href="1037-psw.html#cb610-10" aria-hidden="true" tabindex="-1"></a><span class="do">## height     Contin. -0.0003     1.0201  -0.0175     Balanced, &lt;0.1      0.8647</span></span>
<span id="cb610-11"><a href="1037-psw.html#cb610-11" aria-hidden="true" tabindex="-1"></a><span class="do">## female      Binary -0.0550          .   0.0101     Balanced, &lt;0.1           .</span></span>
<span id="cb610-12"><a href="1037-psw.html#cb610-12" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic    Binary -0.0636          .  -0.0175     Balanced, &lt;0.1           .</span></span>
<span id="cb610-13"><a href="1037-psw.html#cb610-13" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi     Binary  0.1187          .  -0.0028     Balanced, &lt;0.1           .</span></span>
<span id="cb610-14"><a href="1037-psw.html#cb610-14" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac   Contin. -0.1821     1.0238  -0.0119     Balanced, &lt;0.1      0.9784</span></span>
<span id="cb610-15"><a href="1037-psw.html#cb610-15" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_0  Binary  0.0009          .   0.0009     Balanced, &lt;0.1           .</span></span>
<span id="cb610-16"><a href="1037-psw.html#cb610-16" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_1  Binary -0.1894          .   0.0211     Balanced, &lt;0.1           .</span></span>
<span id="cb610-17"><a href="1037-psw.html#cb610-17" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_2  Binary  0.1360          .  -0.0073     Balanced, &lt;0.1           .</span></span>
<span id="cb610-18"><a href="1037-psw.html#cb610-18" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_3  Binary  0.0357          .  -0.0155     Balanced, &lt;0.1           .</span></span>
<span id="cb610-19"><a href="1037-psw.html#cb610-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_4  Binary  0.0153          .  -0.0002     Balanced, &lt;0.1           .</span></span>
<span id="cb610-20"><a href="1037-psw.html#cb610-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_5  Binary  0.0014          .   0.0010     Balanced, &lt;0.1           .</span></span>
<span id="cb610-21"><a href="1037-psw.html#cb610-21" aria-hidden="true" tabindex="-1"></a><span class="do">##                 V.Threshold</span></span>
<span id="cb610-22"><a href="1037-psw.html#cb610-22" aria-hidden="true" tabindex="-1"></a><span class="do">## lifepres   Not Balanced, &gt;2</span></span>
<span id="cb610-23"><a href="1037-psw.html#cb610-23" aria-hidden="true" tabindex="-1"></a><span class="do">## stent                      </span></span>
<span id="cb610-24"><a href="1037-psw.html#cb610-24" aria-hidden="true" tabindex="-1"></a><span class="do">## height         Balanced, &lt;2</span></span>
<span id="cb610-25"><a href="1037-psw.html#cb610-25" aria-hidden="true" tabindex="-1"></a><span class="do">## female                     </span></span>
<span id="cb610-26"><a href="1037-psw.html#cb610-26" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic                   </span></span>
<span id="cb610-27"><a href="1037-psw.html#cb610-27" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi                    </span></span>
<span id="cb610-28"><a href="1037-psw.html#cb610-28" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac       Balanced, &lt;2</span></span>
<span id="cb610-29"><a href="1037-psw.html#cb610-29" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_0                 </span></span>
<span id="cb610-30"><a href="1037-psw.html#cb610-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_1                 </span></span>
<span id="cb610-31"><a href="1037-psw.html#cb610-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_2                 </span></span>
<span id="cb610-32"><a href="1037-psw.html#cb610-32" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_3                 </span></span>
<span id="cb610-33"><a href="1037-psw.html#cb610-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_4                 </span></span>
<span id="cb610-34"><a href="1037-psw.html#cb610-34" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc_5                 </span></span>
<span id="cb610-35"><a href="1037-psw.html#cb610-35" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb610-36"><a href="1037-psw.html#cb610-36" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance tally for mean differences</span></span>
<span id="cb610-37"><a href="1037-psw.html#cb610-37" aria-hidden="true" tabindex="-1"></a><span class="do">##                    count</span></span>
<span id="cb610-38"><a href="1037-psw.html#cb610-38" aria-hidden="true" tabindex="-1"></a><span class="do">## Balanced, &lt;0.1        12</span></span>
<span id="cb610-39"><a href="1037-psw.html#cb610-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Not Balanced, &gt;0.1     1</span></span>
<span id="cb610-40"><a href="1037-psw.html#cb610-40" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb610-41"><a href="1037-psw.html#cb610-41" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable with the greatest mean difference</span></span>
<span id="cb610-42"><a href="1037-psw.html#cb610-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  Variable Diff.Adj        M.Threshold</span></span>
<span id="cb610-43"><a href="1037-psw.html#cb610-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  lifepres    0.331 Not Balanced, &gt;0.1</span></span>
<span id="cb610-44"><a href="1037-psw.html#cb610-44" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb610-45"><a href="1037-psw.html#cb610-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Balance tally for variance ratios</span></span>
<span id="cb610-46"><a href="1037-psw.html#cb610-46" aria-hidden="true" tabindex="-1"></a><span class="do">##                  count</span></span>
<span id="cb610-47"><a href="1037-psw.html#cb610-47" aria-hidden="true" tabindex="-1"></a><span class="do">## Balanced, &lt;2         2</span></span>
<span id="cb610-48"><a href="1037-psw.html#cb610-48" aria-hidden="true" tabindex="-1"></a><span class="do">## Not Balanced, &gt;2     1</span></span>
<span id="cb610-49"><a href="1037-psw.html#cb610-49" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb610-50"><a href="1037-psw.html#cb610-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Variable with the greatest variance ratio</span></span>
<span id="cb610-51"><a href="1037-psw.html#cb610-51" aria-hidden="true" tabindex="-1"></a><span class="do">##  Variable V.Ratio.Adj      V.Threshold</span></span>
<span id="cb610-52"><a href="1037-psw.html#cb610-52" aria-hidden="true" tabindex="-1"></a><span class="do">##  lifepres      0.2185 Not Balanced, &gt;2</span></span>
<span id="cb610-53"><a href="1037-psw.html#cb610-53" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb610-54"><a href="1037-psw.html#cb610-54" aria-hidden="true" tabindex="-1"></a><span class="do">## Effective sample sizes</span></span>
<span id="cb610-55"><a href="1037-psw.html#cb610-55" aria-hidden="true" tabindex="-1"></a><span class="do">##            Control Treated</span></span>
<span id="cb610-56"><a href="1037-psw.html#cb610-56" aria-hidden="true" tabindex="-1"></a><span class="do">## Unadjusted  298.    698.  </span></span>
<span id="cb610-57"><a href="1037-psw.html#cb610-57" aria-hidden="true" tabindex="-1"></a><span class="do">## Adjusted    202.27  671.09</span></span></code></pre></div>
<p>可以看到除了<code>lifepres</code>之外，其他全都均衡了，效果还是挺不错的。加权后，干预组和对照组的样本量已经变了哦！</p>
<p>如果想要画出加权后数据的基线资料表，可以借助<code>survey</code>包。</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="1037-psw.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survey)</span>
<span id="cb611-2"><a href="1037-psw.html#cb611-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: grid</span></span>
<span id="cb611-3"><a href="1037-psw.html#cb611-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: Matrix</span></span>
<span id="cb611-4"><a href="1037-psw.html#cb611-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Loading required package: survival</span></span>
<span id="cb611-5"><a href="1037-psw.html#cb611-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb611-6"><a href="1037-psw.html#cb611-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Attaching package: &#39;survey&#39;</span></span>
<span id="cb611-7"><a href="1037-psw.html#cb611-7" aria-hidden="true" tabindex="-1"></a><span class="do">## The following object is masked from &#39;package:graphics&#39;:</span></span>
<span id="cb611-8"><a href="1037-psw.html#cb611-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb611-9"><a href="1037-psw.html#cb611-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     dotchart</span></span>
<span id="cb611-10"><a href="1037-psw.html#cb611-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-11"><a href="1037-psw.html#cb611-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取加权后的数据</span></span>
<span id="cb611-12"><a href="1037-psw.html#cb611-12" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">svydesign</span>(<span class="at">ids =</span> <span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> lindner, <span class="at">weights =</span> <span class="sc">~</span> iptw)</span>
<span id="cb611-13"><a href="1037-psw.html#cb611-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-14"><a href="1037-psw.html#cb611-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用tableone中的函数创建加权后的三线表</span></span>
<span id="cb611-15"><a href="1037-psw.html#cb611-15" aria-hidden="true" tabindex="-1"></a>tab_IPTW<span class="ot">=</span><span class="fu">svyCreateTableOne</span>(<span class="at">vars=</span>covs, <span class="at">strata=</span><span class="st">&quot;abcix&quot;</span>,<span class="at">data=</span>df ,<span class="at">test=</span>T) </span>
<span id="cb611-16"><a href="1037-psw.html#cb611-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab_IPTW,<span class="at">showAllLevels=</span><span class="cn">TRUE</span>,<span class="at">smd=</span><span class="cn">TRUE</span>)</span>
<span id="cb611-17"><a href="1037-psw.html#cb611-17" aria-hidden="true" tabindex="-1"></a><span class="do">##                       Stratified by abcix</span></span>
<span id="cb611-18"><a href="1037-psw.html#cb611-18" aria-hidden="true" tabindex="-1"></a><span class="do">##                        level 0               1              p      test SMD   </span></span>
<span id="cb611-19"><a href="1037-psw.html#cb611-19" aria-hidden="true" tabindex="-1"></a><span class="do">##   n                          1004.38         994.47                           </span></span>
<span id="cb611-20"><a href="1037-psw.html#cb611-20" aria-hidden="true" tabindex="-1"></a><span class="do">##   lifepres (mean (SD))         10.74 (3.05)   11.42 (1.43)   0.024       0.288</span></span>
<span id="cb611-21"><a href="1037-psw.html#cb611-21" aria-hidden="true" tabindex="-1"></a><span class="do">##   stent (%)            0       333.7 (33.2)   326.8 (32.9)   0.921       0.008</span></span>
<span id="cb611-22"><a href="1037-psw.html#cb611-22" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1       670.7 (66.8)   667.7 (67.1)                    </span></span>
<span id="cb611-23"><a href="1037-psw.html#cb611-23" aria-hidden="true" tabindex="-1"></a><span class="do">##   height (mean (SD))          171.60 (11.39) 171.41 (10.60)  0.849       0.017</span></span>
<span id="cb611-24"><a href="1037-psw.html#cb611-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   female (%)           0       668.5 (66.6)   651.8 (65.5)   0.782       0.021</span></span>
<span id="cb611-25"><a href="1037-psw.html#cb611-25" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1       335.9 (33.4)   342.7 (34.5)                    </span></span>
<span id="cb611-26"><a href="1037-psw.html#cb611-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   diabetic (%)         0       762.7 (75.9)   772.6 (77.7)   0.610       0.042</span></span>
<span id="cb611-27"><a href="1037-psw.html#cb611-27" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1       241.7 (24.1)   221.8 (22.3)                    </span></span>
<span id="cb611-28"><a href="1037-psw.html#cb611-28" aria-hidden="true" tabindex="-1"></a><span class="do">##   acutemi (%)          0       857.6 (85.4)   851.8 (85.7)   0.942       0.008</span></span>
<span id="cb611-29"><a href="1037-psw.html#cb611-29" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1       146.8 (14.6)   142.6 (14.3)                    </span></span>
<span id="cb611-30"><a href="1037-psw.html#cb611-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   ejecfrac (mean (SD))         51.07 (10.23)  50.95 (10.12)  0.879       0.012</span></span>
<span id="cb611-31"><a href="1037-psw.html#cb611-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   ves1proc (%)         0         3.0 ( 0.3)     3.9 ( 0.4)   0.937       0.088</span></span>
<span id="cb611-32"><a href="1037-psw.html#cb611-32" aria-hidden="true" tabindex="-1"></a><span class="do">##                        1       664.1 (66.1)   678.6 (68.2)                    </span></span>
<span id="cb611-33"><a href="1037-psw.html#cb611-33" aria-hidden="true" tabindex="-1"></a><span class="do">##                        2       261.6 (26.0)   251.7 (25.3)                    </span></span>
<span id="cb611-34"><a href="1037-psw.html#cb611-34" aria-hidden="true" tabindex="-1"></a><span class="do">##                        3        61.3 ( 6.1)    45.3 ( 4.6)                    </span></span>
<span id="cb611-35"><a href="1037-psw.html#cb611-35" aria-hidden="true" tabindex="-1"></a><span class="do">##                        4        14.4 ( 1.4)    14.0 ( 1.4)                    </span></span>
<span id="cb611-36"><a href="1037-psw.html#cb611-36" aria-hidden="true" tabindex="-1"></a><span class="do">##                        5         0.0 ( 0.0)     1.0 ( 0.1)</span></span></code></pre></div>
<p><strong>加权之后，就可以做各种分析了，比如回归分析等，分析时把权重因素也考虑进去即可。</strong></p>
<p>这里演示逻辑回归，根据因变量的类型，可选择不同的回归方法。</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="1037-psw.html#cb612-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">glm</span>(sixMonthSurvive<span class="sc">~</span>abcix<span class="sc">+</span>stent<span class="sc">+</span>height<span class="sc">+</span>female<span class="sc">+</span>diabetic<span class="sc">+</span>acutemi<span class="sc">+</span></span>
<span id="cb612-2"><a href="1037-psw.html#cb612-2" aria-hidden="true" tabindex="-1"></a>           ejecfrac<span class="sc">+</span>ves1proc,</span>
<span id="cb612-3"><a href="1037-psw.html#cb612-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> lindner, <span class="at">family =</span> <span class="fu">binomial</span>(),</span>
<span id="cb612-4"><a href="1037-psw.html#cb612-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">weights =</span> iptw <span class="co"># 把权重加进去</span></span>
<span id="cb612-5"><a href="1037-psw.html#cb612-5" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb612-6"><a href="1037-psw.html#cb612-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb612-7"><a href="1037-psw.html#cb612-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(f)</span>
<span id="cb612-8"><a href="1037-psw.html#cb612-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-9"><a href="1037-psw.html#cb612-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb612-10"><a href="1037-psw.html#cb612-10" aria-hidden="true" tabindex="-1"></a><span class="do">## glm(formula = sixMonthSurvive ~ abcix + stent + height + female + </span></span>
<span id="cb612-11"><a href="1037-psw.html#cb612-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     diabetic + acutemi + ejecfrac + ves1proc, family = binomial(), </span></span>
<span id="cb612-12"><a href="1037-psw.html#cb612-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     data = lindner, weights = iptw)</span></span>
<span id="cb612-13"><a href="1037-psw.html#cb612-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-14"><a href="1037-psw.html#cb612-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Deviance Residuals: </span></span>
<span id="cb612-15"><a href="1037-psw.html#cb612-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min       1Q   Median       3Q      Max  </span></span>
<span id="cb612-16"><a href="1037-psw.html#cb612-16" aria-hidden="true" tabindex="-1"></a><span class="do">## -4.9894   0.0958   0.1640   0.3071   2.8009  </span></span>
<span id="cb612-17"><a href="1037-psw.html#cb612-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-18"><a href="1037-psw.html#cb612-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb612-19"><a href="1037-psw.html#cb612-19" aria-hidden="true" tabindex="-1"></a><span class="do">##               Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb612-20"><a href="1037-psw.html#cb612-20" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)  8.598e+00  1.585e+03   0.005  0.99567    </span></span>
<span id="cb612-21"><a href="1037-psw.html#cb612-21" aria-hidden="true" tabindex="-1"></a><span class="do">## abcix1       1.785e+00  3.215e-01   5.551 2.84e-08 ***</span></span>
<span id="cb612-22"><a href="1037-psw.html#cb612-22" aria-hidden="true" tabindex="-1"></a><span class="do">## stent1      -6.401e-01  3.024e-01  -2.117  0.03426 *  </span></span>
<span id="cb612-23"><a href="1037-psw.html#cb612-23" aria-hidden="true" tabindex="-1"></a><span class="do">## height       3.491e-02  1.154e-02   3.025  0.00248 ** </span></span>
<span id="cb612-24"><a href="1037-psw.html#cb612-24" aria-hidden="true" tabindex="-1"></a><span class="do">## female1      8.123e-03  3.143e-01   0.026  0.97938    </span></span>
<span id="cb612-25"><a href="1037-psw.html#cb612-25" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic1   -7.314e-01  2.813e-01  -2.599  0.00934 ** </span></span>
<span id="cb612-26"><a href="1037-psw.html#cb612-26" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi1    -1.540e+00  3.011e-01  -5.116 3.11e-07 ***</span></span>
<span id="cb612-27"><a href="1037-psw.html#cb612-27" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac     5.923e-02  1.057e-02   5.604 2.10e-08 ***</span></span>
<span id="cb612-28"><a href="1037-psw.html#cb612-28" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc1   -1.378e+01  1.585e+03  -0.009  0.99306    </span></span>
<span id="cb612-29"><a href="1037-psw.html#cb612-29" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc2   -1.184e+01  1.585e+03  -0.007  0.99404    </span></span>
<span id="cb612-30"><a href="1037-psw.html#cb612-30" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc3   -1.569e+01  1.585e+03  -0.010  0.99210    </span></span>
<span id="cb612-31"><a href="1037-psw.html#cb612-31" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc4   -7.180e-02  1.787e+03   0.000  0.99997    </span></span>
<span id="cb612-32"><a href="1037-psw.html#cb612-32" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc5   -1.817e+00  4.262e+03   0.000  0.99966    </span></span>
<span id="cb612-33"><a href="1037-psw.html#cb612-33" aria-hidden="true" tabindex="-1"></a><span class="do">## ---</span></span>
<span id="cb612-34"><a href="1037-psw.html#cb612-34" aria-hidden="true" tabindex="-1"></a><span class="do">## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb612-35"><a href="1037-psw.html#cb612-35" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-36"><a href="1037-psw.html#cb612-36" aria-hidden="true" tabindex="-1"></a><span class="do">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb612-37"><a href="1037-psw.html#cb612-37" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-38"><a href="1037-psw.html#cb612-38" aria-hidden="true" tabindex="-1"></a><span class="do">##     Null deviance: 732.98  on 995  degrees of freedom</span></span>
<span id="cb612-39"><a href="1037-psw.html#cb612-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Residual deviance: 469.49  on 983  degrees of freedom</span></span>
<span id="cb612-40"><a href="1037-psw.html#cb612-40" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC: 485.36</span></span>
<span id="cb612-41"><a href="1037-psw.html#cb612-41" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb612-42"><a href="1037-psw.html#cb612-42" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of Fisher Scoring iterations: 16</span></span></code></pre></div>
<blockquote>
<p>但是这种方法存在问题，我在<a href="https://stackoverflow.com/questions/7026549/weight-data-with-r-part-ii">stackoverflow</a>中的帖子中看到有人指出，R自带的<code>lm</code>和<code>glm</code>中的<code>weights</code>参数并不是样本的权重，这点可以查看帮助文档确定，所以如果想要使用加权后的数据进行线性回归和逻辑回归，需要使用其他的R包，比如survey包。</p>
</blockquote>
<p>除了上面介绍的手动计算权重的方法，也可以通过多个R包实现，比如<code>PSW</code>/<code>PSweight</code>/<code>twang</code>等，大家感兴趣的可以自己查看相关说明。</p>
</div>
<div id="重叠加权" class="section level2 hasAnchor" number="37.3">
<h2><span class="header-section-number">37.3</span> 重叠加权<a href="1037-psw.html#重叠加权" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>重叠加权的目标人群是两组协变量相似的人，即PS值分布重叠的人，其估计的效应为重叠人群平均处理效应（ATO）。</p>
<ul>
<li>干预组：1-ps</li>
<li>对照组：ps</li>
</ul>
<p>重叠加权的优缺点可以看这篇文章：<a href="https://mp.weixin.qq.com/s/OgsRAuMFD9kuiT1Dsze62g">最强的倾向性评分方法—重叠加权</a></p>
<p>使用<code>PSweight</code>包演示重叠加权，这个包不仅可以用于二分类，还可以用于多分类。</p>
<p>还是使用<code>lindner</code>这个数据集。</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="1037-psw.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 数据准备</span></span>
<span id="cb613-2"><a href="1037-psw.html#cb613-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb613-3"><a href="1037-psw.html#cb613-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(lindner, <span class="at">package =</span> <span class="st">&quot;twang&quot;</span>) </span>
<span id="cb613-4"><a href="1037-psw.html#cb613-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb613-5"><a href="1037-psw.html#cb613-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 构建估计PS的formula</span></span>
<span id="cb613-6"><a href="1037-psw.html#cb613-6" aria-hidden="true" tabindex="-1"></a>formula.ps <span class="ot">&lt;-</span> abcix <span class="sc">~</span> stent <span class="sc">+</span> height <span class="sc">+</span> female <span class="sc">+</span> diabetic <span class="sc">+</span> acutemi <span class="sc">+</span> ejecfrac <span class="sc">+</span> ves1proc</span></code></pre></div>
<p>进行重叠加权：</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="1037-psw.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(PSweight)</span>
<span id="cb614-2"><a href="1037-psw.html#cb614-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-3"><a href="1037-psw.html#cb614-3" aria-hidden="true" tabindex="-1"></a>PSweight <span class="ot">&lt;-</span> <span class="fu">PSweight</span>(<span class="at">ps.formula =</span> formula.ps, <span class="at">data =</span> lindner, </span>
<span id="cb614-4"><a href="1037-psw.html#cb614-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">weight =</span> <span class="st">&quot;overlap&quot;</span>, <span class="co"># 重叠加权</span></span>
<span id="cb614-5"><a href="1037-psw.html#cb614-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">yname =</span> <span class="st">&quot;cardbill&quot;</span>, <span class="co"># 因变量</span></span>
<span id="cb614-6"><a href="1037-psw.html#cb614-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb614-7"><a href="1037-psw.html#cb614-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ps.method =</span> <span class="st">&quot;glm&quot;</span>, </span>
<span id="cb614-8"><a href="1037-psw.html#cb614-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">out.method =</span> <span class="st">&quot;glm&quot;</span></span>
<span id="cb614-9"><a href="1037-psw.html#cb614-9" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb614-10"><a href="1037-psw.html#cb614-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-11"><a href="1037-psw.html#cb614-11" aria-hidden="true" tabindex="-1"></a><span class="co">#返回结果，效应估计及其标准误、置信区间、P值</span></span>
<span id="cb614-12"><a href="1037-psw.html#cb614-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(PSweight)</span>
<span id="cb614-13"><a href="1037-psw.html#cb614-13" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb614-14"><a href="1037-psw.html#cb614-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Closed-form inference: </span></span>
<span id="cb614-15"><a href="1037-psw.html#cb614-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb614-16"><a href="1037-psw.html#cb614-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Original group value:  0, 1 </span></span>
<span id="cb614-17"><a href="1037-psw.html#cb614-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb614-18"><a href="1037-psw.html#cb614-18" aria-hidden="true" tabindex="-1"></a><span class="do">## Contrast: </span></span>
<span id="cb614-19"><a href="1037-psw.html#cb614-19" aria-hidden="true" tabindex="-1"></a><span class="do">##             0 1</span></span>
<span id="cb614-20"><a href="1037-psw.html#cb614-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Contrast 1 -1 1</span></span>
<span id="cb614-21"><a href="1037-psw.html#cb614-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb614-22"><a href="1037-psw.html#cb614-22" aria-hidden="true" tabindex="-1"></a><span class="do">##            Estimate Std.Error     lwr    upr Pr(&gt;|z|)</span></span>
<span id="cb614-23"><a href="1037-psw.html#cb614-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Contrast 1  1134.91    879.51 -588.90 2858.7   0.1969</span></span></code></pre></div>
<p>计算数据均衡性：</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="1037-psw.html#cb615-1" aria-hidden="true" tabindex="-1"></a>SumStat<span class="ot">&lt;-</span><span class="fu">SumStat</span>(<span class="at">ps.formula =</span> formula.ps, <span class="at">data =</span> lindner, <span class="at">weight =</span> <span class="st">&quot;overlap&quot;</span>)</span>
<span id="cb615-2"><a href="1037-psw.html#cb615-2" aria-hidden="true" tabindex="-1"></a>SumStat[[<span class="st">&quot;ess&quot;</span>]] <span class="co">#有效样本量</span></span>
<span id="cb615-3"><a href="1037-psw.html#cb615-3" aria-hidden="true" tabindex="-1"></a><span class="do">##   unweighted  overlap</span></span>
<span id="cb615-4"><a href="1037-psw.html#cb615-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 0        298 287.4367</span></span>
<span id="cb615-5"><a href="1037-psw.html#cb615-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 1        698 569.5826</span></span>
<span id="cb615-6"><a href="1037-psw.html#cb615-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SumStat) <span class="co">#均衡性检验图形</span></span></code></pre></div>
<p><img src="1037-psw_files/figure-html/unnamed-chunk-13-1.png" width="90%" /></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="1037-psw.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(SumStat) <span class="co">#均衡性检验</span></span>
<span id="cb616-2"><a href="1037-psw.html#cb616-2" aria-hidden="true" tabindex="-1"></a><span class="do">## unweighted result</span></span>
<span id="cb616-3"><a href="1037-psw.html#cb616-3" aria-hidden="true" tabindex="-1"></a><span class="do">##           Mean 0  Mean 1   SMD</span></span>
<span id="cb616-4"><a href="1037-psw.html#cb616-4" aria-hidden="true" tabindex="-1"></a><span class="do">## stent      0.584   0.705 0.254</span></span>
<span id="cb616-5"><a href="1037-psw.html#cb616-5" aria-hidden="true" tabindex="-1"></a><span class="do">## height   171.446 171.443 0.000</span></span>
<span id="cb616-6"><a href="1037-psw.html#cb616-6" aria-hidden="true" tabindex="-1"></a><span class="do">## female     0.386   0.331 0.115</span></span>
<span id="cb616-7"><a href="1037-psw.html#cb616-7" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic   0.268   0.205 0.150</span></span>
<span id="cb616-8"><a href="1037-psw.html#cb616-8" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi    0.060   0.179 0.371</span></span>
<span id="cb616-9"><a href="1037-psw.html#cb616-9" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac  52.289  50.403 0.182</span></span>
<span id="cb616-10"><a href="1037-psw.html#cb616-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc   1.205   1.463 0.427</span></span>
<span id="cb616-11"><a href="1037-psw.html#cb616-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb616-12"><a href="1037-psw.html#cb616-12" aria-hidden="true" tabindex="-1"></a><span class="do">## overlap result</span></span>
<span id="cb616-13"><a href="1037-psw.html#cb616-13" aria-hidden="true" tabindex="-1"></a><span class="do">##           Mean 0  Mean 1 SMD</span></span>
<span id="cb616-14"><a href="1037-psw.html#cb616-14" aria-hidden="true" tabindex="-1"></a><span class="do">## stent      0.633   0.633   0</span></span>
<span id="cb616-15"><a href="1037-psw.html#cb616-15" aria-hidden="true" tabindex="-1"></a><span class="do">## height   171.464 171.464   0</span></span>
<span id="cb616-16"><a href="1037-psw.html#cb616-16" aria-hidden="true" tabindex="-1"></a><span class="do">## female     0.359   0.359   0</span></span>
<span id="cb616-17"><a href="1037-psw.html#cb616-17" aria-hidden="true" tabindex="-1"></a><span class="do">## diabetic   0.242   0.242   0</span></span>
<span id="cb616-18"><a href="1037-psw.html#cb616-18" aria-hidden="true" tabindex="-1"></a><span class="do">## acutemi    0.078   0.078   0</span></span>
<span id="cb616-19"><a href="1037-psw.html#cb616-19" aria-hidden="true" tabindex="-1"></a><span class="do">## ejecfrac  51.830  51.830   0</span></span>
<span id="cb616-20"><a href="1037-psw.html#cb616-20" aria-hidden="true" tabindex="-1"></a><span class="do">## ves1proc   1.257   1.257   0</span></span></code></pre></div>
<p>加权后，可以进行后续的各种分析，这里就不演示了。</p>
</div>
<div id="参考资料-6" class="section level2 hasAnchor" number="37.4">
<h2><span class="header-section-number">37.4</span> 参考资料<a href="1037-psw.html#参考资料-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>涂博祥, 秦婴逸, 吴骋, 等. 倾向性评分加权方法介绍及R软件实现[J]. 中国循证医学杂志, 2022, 22(3): 365–372.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="1036-pssc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="1038-p4trend.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
