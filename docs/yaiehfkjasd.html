<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>13 R语言tidy风格医学统计学 | R语言实战医学统计</title>
<meta name="author" content="阿越就是我">
<meta name="description" content="上面的介绍多数是基于R语言自带的函数进行医学统计学分析，下面介绍一个比较现代化、用法也更加简单直接的方法。 提供一个简单直观的管道友好的框架，与整洁的设计理念一致，用于执行基本的统计检验，包括t检验，Wilcoxon检验，方差分析，Kruskal-Wallis和相关性分析。每个分析的输出会自动转换成一个整洁的数据框架，以方便可视化。...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="13 R语言tidy风格医学统计学 | R语言实战医学统计">
<meta property="og:type" content="book">
<meta property="og:description" content="上面的介绍多数是基于R语言自带的函数进行医学统计学分析，下面介绍一个比较现代化、用法也更加简单直接的方法。 提供一个简单直观的管道友好的框架，与整洁的设计理念一致，用于执行基本的统计检验，包括t检验，Wilcoxon检验，方差分析，Kruskal-Wallis和相关性分析。每个分析的输出会自动转换成一个整洁的数据框架，以方便可视化。...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="13 R语言tidy风格医学统计学 | R语言实战医学统计">
<meta name="twitter:description" content="上面的介绍多数是基于R语言自带的函数进行医学统计学分析，下面介绍一个比较现代化、用法也更加简单直接的方法。 提供一个简单直观的管道友好的框架，与整洁的设计理念一致，用于执行基本的统计检验，包括t检验，Wilcoxon检验，方差分析，Kruskal-Wallis和相关性分析。每个分析的输出会自动转换成一个整洁的数据框架，以方便可视化。...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R语言实战医学统计</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">前言</a></li>
<li class="book-part">基础统计分析</li>
<li><a class="" href="sdjfl.html"><span class="header-section-number">1</span> t检验</a></li>
<li><a class="" href="xnclg.html"><span class="header-section-number">2</span> 多样本均数比较的方差分析</a></li>
<li><a class="" href="njlkga.html"><span class="header-section-number">3</span> 多因素方差分析</a></li>
<li><a class="" href="iegljgk.html"><span class="header-section-number">4</span> 重复测量方差分析</a></li>
<li><a class="" href="lasijdlfjd.html"><span class="header-section-number">5</span> 协方差分析</a></li>
<li><a class="" href="aspljsffjd.html"><span class="header-section-number">6</span> 卡方检验</a></li>
<li><a class="" href="lidukj.html"><span class="header-section-number">7</span> 秩和检验</a></li>
<li><a class="" href="yruugkjh.html"><span class="header-section-number">8</span> 球对称检验</a></li>
<li><a class="" href="rugnjkdfgl.html"><span class="header-section-number">9</span> R语言Cochran Armitage检验</a></li>
<li><a class="" href="ytlrwijj.html"><span class="header-section-number">10</span> R语言方差分析注意事项</a></li>
<li><a class="" href="terlajskd.html"><span class="header-section-number">11</span> 样本量计算</a></li>
<li><a class="" href="ytsgs.html"><span class="header-section-number">12</span> 随机分组</a></li>
<li><a class="active" href="yaiehfkjasd.html"><span class="header-section-number">13</span> R语言tidy风格医学统计学</a></li>
<li><a class="" href="tjslrkjga.html"><span class="header-section-number">14</span> R语言多个变量同时进行t检验</a></li>
<li><a class="" href="oirjglsj.html"><span class="header-section-number">15</span> 双变量回归与相关</a></li>
<li><a class="" href="jhgkjahdj.html"><span class="header-section-number">16</span> 偏相关和典型相关</a></li>
<li class="book-part">高级统计分析</li>
<li><a class="" href="raljflksdj.html"><span class="header-section-number">17</span> 多元线性回归</a></li>
<li><a class="" href="rlkdfjj.html"><span class="header-section-number">18</span> Logistic回归</a></li>
<li><a class="" href="tuishgh.html"><span class="header-section-number">19</span> 分类变量进行回归分析时的编码方案</a></li>
<li><a class="" href="erutgjdflk.html"><span class="header-section-number">20</span> R语言判别分析</a></li>
<li><a class="" href="lksdjgljdsl.html"><span class="header-section-number">21</span> R语言聚类分析</a></li>
<li><a class="" href="ejtlj.html"><span class="header-section-number">22</span> R语言主成分分析</a></li>
<li><a class="" href="iurgsdh.html"><span class="header-section-number">23</span> R语言因子分析</a></li>
<li><a class="" href="ljhgjsj.html"><span class="header-section-number">24</span> 二分类资料ROC曲线绘制</a></li>
<li><a class="" href="xlkjgj.html"><span class="header-section-number">25</span> 生存资料ROC曲线绘制</a></li>
<li><a class="" href="lsjdglj.html"><span class="header-section-number">26</span> 生存资料ROC的最佳截点和平滑曲线</a></li>
<li><a class="" href="oljgja.html"><span class="header-section-number">27</span> ROC曲线的显著性检验</a></li>
<li><a class="" href="uxijsjg.html"><span class="header-section-number">28</span> ROC阴性结果还是阳性结果</a></li>
<li><a class="" href="yrlhksdg.html"><span class="header-section-number">29</span> ROC曲线ggplot2绘制</a></li>
<li><a class="" href="sjgjaklj.html"><span class="header-section-number">30</span> R语言计算AUC(ROC)注意事项</a></li>
<li><a class="" href="oljgji.html"><span class="header-section-number">31</span> 多指标联合诊断的ROC曲线</a></li>
<li><a class="" href="djgkas.html"><span class="header-section-number">32</span> R语言生存分析</a></li>
<li><a class="" href="oiewjrtsjl.html"><span class="header-section-number">33</span> R语言超详细的生存曲线可视化</a></li>
<li class="book-part">文献中常用的统计方法</li>
<li><a class="" href="lxjjgjja.html"><span class="header-section-number">34</span> Fine-Gray检验、竞争风险模型列线图绘制</a></li>
<li><a class="" href="ysdkfjhsjk.html"><span class="header-section-number">35</span> R语言倾向性评分：匹配</a></li>
<li><a class="" href="yxkskjhfk.html"><span class="header-section-number">36</span> R语言倾向性评分：回归和分层</a></li>
<li><a class="" href="yplksjhfk.html"><span class="header-section-number">37</span> R语言倾向性评分：加权</a></li>
<li><a class="" href="qdkjfgj.html"><span class="header-section-number">38</span> p for trend/ p for interaction/ per 1 sd 的R语言实现</a></li>
<li><a class="" href="jddsfsdf.html"><span class="header-section-number">39</span> R语言多项式拟合及样条回归</a></li>
<li><a class="" href="subgroupanalysis.html"><span class="header-section-number">40</span> R语言亚组分析及森林图绘制</a></li>
<li><a class="" href="subgrouponecode.html"><span class="header-section-number">41</span> 亚组分析1行代码实现</a></li>
<li class="book-part">附录</li>
<li class="book-part">附录</li>
<li><a class="" href="jdkhfgjad.html"><span class="header-section-number">A</span> 软件安装及其他合集</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/ayueme/ayueme.github.io">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="yaiehfkjasd" class="section level1" number="13">
<h1>
<span class="header-section-number">13</span> R语言tidy风格医学统计学<a class="anchor" aria-label="anchor" href="#yaiehfkjasd"><i class="fas fa-link"></i></a>
</h1>
<p>上面的介绍多数是基于R语言自带的函数进行医学统计学分析，下面介绍一个比较现代化、用法也更加简单直接的方法。</p>
<p>提供一个简单直观的管道友好的框架，与整洁的设计理念一致，用于执行基本的统计检验，包括t检验，Wilcoxon检验，方差分析，Kruskal-Wallis和相关性分析。每个分析的输出会自动转换成一个整洁的数据框架，以方便可视化。</p>
<p>附加功能可用于重塑，重新排序，操作和可视化相关矩阵。功能还包括析因实验的分析，包括重复测量设计、析因设计、正交设计等。</p>
<p>可以计算几个效应大小指标，包括方差分析eta平方，t检验的Cohen’s d和分类变量之间的关联的Cramer’s v。 该软件包包含用于识别单变量和多变量异常值、评估正态性和方差齐性的辅助函数。</p>
<div id="主要函数" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> 主要函数<a class="anchor" aria-label="anchor" href="#%E4%B8%BB%E8%A6%81%E5%87%BD%E6%95%B0"><i class="fas fa-link"></i></a>
</h2>
<div id="描述性统计" class="section level3" number="13.1.1">
<h3>
<span class="header-section-number">13.1.1</span> 描述性统计<a class="anchor" aria-label="anchor" href="#%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code>get_summary_stat()</code>:计算描述性的统计指标；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/freq_table.html">freq_table()</a></code>: 分类变量的频率表；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/get_mode.html">get_mode()</a></code>: 众数；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/outliers.html">identify_outliers()</a></code>: 使用boxplot鉴别离群值；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/mahalanobis_distance.html">mahalanobis_distance()</a></code>: 计算Mahalanobi距离和离群点；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">shapiro_test()</a></code> and <code><a href="https://rpkgs.datanovia.com/rstatix/reference/shapiro_test.html">mshapiro_test()</a></code>: 正态性检验.</li>
</ul>
</div>
<div id="比较均值" class="section level3" number="13.1.2">
<h3>
<span class="header-section-number">13.1.2</span> 比较均值<a class="anchor" aria-label="anchor" href="#%E6%AF%94%E8%BE%83%E5%9D%87%E5%80%BC"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test()</a></code>: 单样本、配对样本、独立样本t检验；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_test.html">wilcox_test()</a></code>: 单样本、配对样本、独立样本秩和检验；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/sign_test.html">sign_test()</a></code>: 符号检验；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test()</a></code>: 基于<code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>改写，可以做：独立测量、重复测量、混合anova；</li>
<li>
<code>get_anova_test_table()</code>: 从<code><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test()</a></code> 提取结果，可自动执行球形检验.；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/welch_anova_test.html">welch_anova_test()</a></code>: Welch one-Way ANOVA test. 基于<code><a href="https://rdrr.io/r/stats/oneway.test.html">stats::oneway.test()</a></code>改写；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/kruskal_test.html">kruskal_test()</a></code>: kruskal-wallis rank sum test；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/friedman_test.html">friedman_test()</a></code>: Friedman rank sum test；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/get_comparisons.html">get_comparisons()</a></code>: 创建需要比较的组；</li>
<li>
<code>get_pvalue_position</code>: 使用<code>ggplot2</code>添加p值时可自动计算添加坐标</li>
</ul>
</div>
<div id="增强r中的anova" class="section level3" number="13.1.3">
<h3>
<span class="header-section-number">13.1.3</span> 增强R中的ANOVA<a class="anchor" aria-label="anchor" href="#%E5%A2%9E%E5%BC%BAr%E4%B8%AD%E7%9A%84anova"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/factorial_design.html">factorial_design()</a></code>: 建立因子化的设计，方便使用<code><a href="https://rdrr.io/pkg/car/man/Anova.html">car::Anova()</a></code>进行分析，对于重复测量Anova非常有帮助；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_summary.html">anova_summary()</a></code>: 提取美观的Anova检验的结果，包括从<code>car:Anova()</code>或者<code>stats:aov()</code>中，主要结果包含Anova结果表、一般效应量、和一些假设检验，比如球形检验。</li>
</ul>
</div>
<div id="事后检验post-hoc" class="section level3" number="13.1.4">
<h3>
<span class="header-section-number">13.1.4</span> 事后检验（post-hoc）<a class="anchor" aria-label="anchor" href="#%E4%BA%8B%E5%90%8E%E6%A3%80%E9%AA%8Cpost-hoc"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/tukey_hsd.html">tukey_hsd()</a></code>: tukey post-hoc tests;</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/dunn_test.html">dunn_test()</a></code>: 计算Kruskal-Wallis的成对比较；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/games_howell_test.html">games_howell_test()</a></code>: Games-Howell test；</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/emmeans_test.html">emmeans_test()</a></code>: estimated marginal means</li>
</ul>
</div>
<div id="比较比例" class="section level3" number="13.1.5">
<h3>
<span class="header-section-number">13.1.5</span> 比较比例<a class="anchor" aria-label="anchor" href="#%E6%AF%94%E8%BE%83%E6%AF%94%E4%BE%8B"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/prop_test.html">prop_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/prop_test.html">pairwise_prop_test()</a></code> and <code><a href="https://rpkgs.datanovia.com/rstatix/reference/prop_test.html">row_wise_prop_test()</a></code>. Performs one-sample and two-samples z-test of proportions. Wrappers around the R base function prop.test() but have the advantage of performing pairwise and row-wise z-test of two proportions, the post-hoc tests following a significant chi-square test of homogeneity for 2xc and rx2 contingency tables.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">fisher_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">pairwise_fisher_test()</a></code> and <code><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">row_wise_fisher_test()</a></code>: Fisher’s exact test for count data. Wrappers around the R base function fisher.test() but have the advantage of performing pairwise and row-wise fisher tests, the post-hoc tests following a significant chi-square test of homogeneity for 2xc and rx2 contingency tables.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/chisq_test.html">chisq_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/chisq_test.html">pairwise_chisq_gof_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/chisq_test.html">pairwise_chisq_test_against_p()</a></code>: Performs chi-squared tests, including goodness-of-fit, homogeneity and independence tests.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/binom_test.html">binom_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/binom_test.html">pairwise_binom_test()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/binom_test.html">pairwise_binom_test_against_p()</a></code>: Performs exact binomial test and pairwise comparisons following a significant exact multinomial test. Alternative to the chi-square test of goodness-of-fit-test when the sample.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/multinom_test.html">multinom_test()</a></code>: performs an exact multinomial test. Alternative to the chi-square test of goodness-of-fit-test when the sample size is small.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/mcnemar_test.html">mcnemar_test()</a></code>: performs McNemar chi-squared test to compare paired proportions. Provides pairwise comparisons between multiple groups.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cochran_qtest.html">cochran_qtest()</a></code>: extension of the McNemar Chi-squared test for comparing more than two paired proportions.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/prop_trend_test.html">prop_trend_test()</a></code>: Performs chi-squared test for trend in proportion. This test is also known as Cochran-Armitage trend test</li>
</ul>
</div>
<div id="比较方差" class="section level3" number="13.1.6">
<h3>
<span class="header-section-number">13.1.6</span> 比较方差<a class="anchor" aria-label="anchor" href="#%E6%AF%94%E8%BE%83%E6%96%B9%E5%B7%AE"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/levene_test.html">levene_test()</a></code>: Pipe-friendly framework to easily compute Levene’s test for homogeneity of variance across groups.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/box_m.html">box_m()</a></code>: Box’s M-test for homogeneity of covariance matrices</li>
</ul>
</div>
<div id="计算效应量" class="section level3" number="13.1.7">
<h3>
<span class="header-section-number">13.1.7</span> 计算效应量<a class="anchor" aria-label="anchor" href="#%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E9%87%8F"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cohens_d.html">cohens_d()</a></code>: Compute cohen’s d measure of effect size for t-tests.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_effsize.html">wilcox_effsize()</a></code>: Compute Wilcoxon effect size (r).</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/eta_squared.html">eta_squared()</a></code> and <code><a href="https://rpkgs.datanovia.com/rstatix/reference/eta_squared.html">partial_eta_squared()</a></code>: Compute effect size for ANOVA.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/kruskal_effsize.html">kruskal_effsize()</a></code>: Compute the effect size for Kruskal-Wallis test as the eta squared based on the H-statistic.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/friedman_effsize.html">friedman_effsize()</a></code>: Compute the effect size of Friedman test using the Kendall’s W value.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cramer_v.html">cramer_v()</a></code>: Compute Cramer’s V, which measures the strength of the association between categorical variables</li>
</ul>
</div>
<div id="相关性分析" class="section level3" number="13.1.8">
<h3>
<span class="header-section-number">13.1.8</span> 相关性分析<a class="anchor" aria-label="anchor" href="#%E7%9B%B8%E5%85%B3%E6%80%A7%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h3>
<div id="计算相关性" class="section level4" number="13.1.8.1">
<h4>
<span class="header-section-number">13.1.8.1</span> 计算相关性<a class="anchor" aria-label="anchor" href="#%E8%AE%A1%E7%AE%97%E7%9B%B8%E5%85%B3%E6%80%A7"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_test.html">cor_test()</a></code>: correlation test between two or more variables using Pearson, Spearman or Kendall methods.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_mat()</a></code>: compute correlation matrix with p-values. Returns a data frame containing the matrix of the correlation coefficients. The output has an attribute named “pvalue”, which contains the matrix of the correlation test p-values.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_get_pval()</a></code>: extract a correlation matrix p-values from an object of class cor_mat().</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_pmat()</a></code>: compute the correlation matrix, but returns only the p-values of the correlation tests.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/as_cor_mat.html">as_cor_mat()</a></code>: convert a cor_test object into a correlation matrix format.</li>
</ul>
</div>
<div id="重塑相关矩阵" class="section level4" number="13.1.8.2">
<h4>
<span class="header-section-number">13.1.8.2</span> 重塑相关矩阵<a class="anchor" aria-label="anchor" href="#%E9%87%8D%E5%A1%91%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_reorder.html">cor_reorder()</a></code>: reorder correlation matrix, according to the coefficients, using the hierarchical clustering method.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_reshape.html">cor_gather()</a></code>: takes a correlation matrix and collapses (or melt) it into long format data frame (paired list)</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_reshape.html">cor_spread()</a></code>: spread a long correlation data frame into wide format (correlation matrix).</li>
</ul>
</div>
<div id="相关矩阵取子集" class="section level4" number="13.1.8.3">
<h4>
<span class="header-section-number">13.1.8.3</span> 相关矩阵取子集<a class="anchor" aria-label="anchor" href="#%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5%E5%8F%96%E5%AD%90%E9%9B%86"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_select.html">cor_select()</a></code>: subset a correlation matrix by selecting variables of interest.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/pull_triangle.html">pull_triangle()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/pull_triangle.html">pull_upper_triangle()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/pull_triangle.html">pull_lower_triangle()</a></code>: pull upper and lower triangular parts of a (correlation) matrix.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/replace_triangle.html">replace_triangle()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/replace_triangle.html">replace_upper_triangle()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/replace_triangle.html">replace_lower_triangle()</a></code>: replace upper and lower triangular parts of a (correlation) matrix.</li>
</ul>
</div>
<div id="可视化相关矩阵" class="section level4" number="13.1.8.4">
<h4>
<span class="header-section-number">13.1.8.4</span> 可视化相关矩阵<a class="anchor" aria-label="anchor" href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_as_symbols.html">cor_as_symbols()</a></code>: replaces the correlation coefficients, in a matrix, by symbols according to the value.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_plot.html">cor_plot()</a></code>: visualize correlation matrix using base plot.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mark_significant.html">cor_mark_significant()</a></code>: add significance levels to a correlation matrix</li>
</ul>
</div>
</div>
<div id="添加p值和显著性标记" class="section level3" number="13.1.9">
<h3>
<span class="header-section-number">13.1.9</span> 添加P值和显著性标记<a class="anchor" aria-label="anchor" href="#%E6%B7%BB%E5%8A%A0p%E5%80%BC%E5%92%8C%E6%98%BE%E8%91%97%E6%80%A7%E6%A0%87%E8%AE%B0"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html">adjust_pvalue()</a></code>: add an adjusted p-values column to a data frame containing statistical test p-values</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/add_significance.html">add_significance()</a></code>: add a column containing the p-value significance level</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/p_value.html">p_round()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/p_value.html">p_format()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/p_value.html">p_mark_significant()</a></code>: rounding and formatting p-values</li>
</ul>
</div>
<div id="提取统计信息" class="section level3" number="13.1.10">
<h3>
<span class="header-section-number">13.1.10</span> 提取统计信息<a class="anchor" aria-label="anchor" href="#%E6%8F%90%E5%8F%96%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/get_test_label.html">get_pwc_label()</a></code>: Extract label from pairwise comparisons.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/get_test_label.html">get_test_label()</a></code>: Extract label from statistical tests.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/get_test_label.html">create_test_label()</a></code>: Create labels from user specified test results</li>
</ul>
</div>
<div id="数据处理辅助函数" class="section level3" number="13.1.11">
<h3>
<span class="header-section-number">13.1.11</span> 数据处理辅助函数<a class="anchor" aria-label="anchor" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_select.html">df_select()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_arrange.html">df_arrange()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_group_by.html">df_group_by()</a></code>: wrappers arround dplyr functions for supporting standard and non standard evaluations.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_nest_by.html">df_nest_by()</a></code>: Nest a tibble data frame using grouping specification. Supports standard and non standard evaluations.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_split_by.html">df_split_by()</a></code>: Split a data frame by groups into subsets or data panel. Very similar to the function <code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_nest_by.html">df_nest_by()</a></code>. The only difference is that, it adds labels to each data subset. Labels are the combination of the grouping variable levels.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_unite.html">df_unite()</a></code>: Unite multiple columns into one.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_unite.html">df_unite_factors()</a></code>: Unite factor columns. First, order factors levels then merge them into one column. The output column is a factor.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_label_value.html">df_label_both()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_label_value.html">df_label_value()</a></code>: functions to label data frames rows by by one or multiple grouping variables.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/df_get_var_names.html">df_get_var_names()</a></code>: Returns user specified variable names. Supports standard and non standard evaluation</li>
</ul>
</div>
<div id="其他" class="section level3" number="13.1.12">
<h3>
<span class="header-section-number">13.1.12</span> 其他<a class="anchor" aria-label="anchor" href="#%E5%85%B6%E4%BB%96"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/doo.html">doo()</a></code>: alternative to dplyr::do for doing anything. Technically it uses <code><a href="https://tidyr.tidyverse.org/reference/nest.html">nest()</a></code> + <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> + <code><a href="https://purrr.tidyverse.org/reference/map.html">map()</a></code> to apply arbitrary computation to a grouped data frame.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/sample_n_by.html">sample_n_by()</a></code>: sample n rows by group from a table</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/factors.html">convert_as_factor()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/factors.html">set_ref_level()</a></code>, <code><a href="https://rpkgs.datanovia.com/rstatix/reference/factors.html">reorder_levels()</a></code>: Provides pipe-friendly functions to convert simultaneously multiple variables into a factor variable.</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/make_clean_names.html">make_clean_names()</a></code>: Pipe-friendly function to make syntactically valid column names (for input data frame) or names (for input vector).</li>
<li>
<code><a href="https://rpkgs.datanovia.com/rstatix/reference/counts_to_cases.html">counts_to_cases()</a></code>: converts a contingency table or a data frame of counts into a data frame of individual observations</li>
</ul>
</div>
</div>
<div id="安装和加载" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> 安装和加载<a class="anchor" aria-label="anchor" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E5%8A%A0%E8%BD%BD"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"kassambara/rstatix"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 或者cran</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"rstatix"</span><span class="op">)</span></span></code></pre></div>
<p>加载包：</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/rstatix/">rstatix</a></span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'rstatix'</span></span>
<span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span></span>
<span><span class="co">## Loading required package: ggplot2</span></span></code></pre></div>
</div>
<div id="描述性统计-1" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> 描述性统计<a class="anchor" aria-label="anchor" href="#%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1-1"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 指定列</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, type <span class="op">=</span> <span class="st">"full"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 2 × 13</span></span>
<span><span class="co">##   variable        n   min   max median    q1    q3   iqr   mad  mean    sd    se</span></span>
<span><span class="co">##   &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1 Sepal.Leng…   150   4.3   7.9    5.8   5.1   6.4   1.3 1.04   5.84 0.828 0.068</span></span>
<span><span class="co">## 2 Sepal.Width   150   2     4.4    3     2.8   3.3   0.5 0.445  3.06 0.436 0.036</span></span>
<span><span class="co">## # ℹ 1 more variable: ci &lt;dbl&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 所有列</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"common"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 4 × 10</span></span>
<span><span class="co">##   variable         n   min   max median   iqr  mean    sd    se    ci</span></span>
<span><span class="co">##   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1 Sepal.Length   150   4.3   7.9   5.8    1.3  5.84 0.828 0.068 0.134</span></span>
<span><span class="co">## 2 Sepal.Width    150   2     4.4   3      0.5  3.06 0.436 0.036 0.07 </span></span>
<span><span class="co">## 3 Petal.Length   150   1     6.9   4.35   3.5  3.76 1.76  0.144 0.285</span></span>
<span><span class="co">## 4 Petal.Width    150   0.1   2.5   1.3    1.5  1.20 0.762 0.062 0.123</span></span></code></pre></div>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 分组展示</span></span>
<span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_summary_stats.html">get_summary_stats</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, type <span class="op">=</span> <span class="st">"mean_sd"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 3 × 5</span></span>
<span><span class="co">##   Species    variable         n  mean    sd</span></span>
<span><span class="co">##   &lt;fct&gt;      &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1 setosa     Sepal.Length    50  5.01 0.352</span></span>
<span><span class="co">## 2 versicolor Sepal.Length    50  5.94 0.516</span></span>
<span><span class="co">## 3 virginica  Sepal.Length    50  6.59 0.636</span></span></code></pre></div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 众数</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/get_mode.html">get_mode</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Sepal.Length</span><span class="op">)</span></span>
<span><span class="co">## [1] 5</span></span></code></pre></div>
</div>
<div id="t检验" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> t检验<a class="anchor" aria-label="anchor" href="#t%E6%A3%80%E9%AA%8C"><i class="fas fa-link"></i></a>
</h2>
<p>以t检验为例。</p>
<div id="单样本t检验-1" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">13.4.1</span> 单样本t检验<a class="anchor" aria-label="anchor" href="#%E5%8D%95%E6%A0%B7%E6%9C%ACt%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<p>还是以之前推文中的<strong>例3-5</strong>的数据：</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">'datasets/例03-05.sav'</span>,to.data.frame <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                         reencode <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span></span>
<span><span class="co">## re-encoding from utf-8</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">##   no  hb</span></span>
<span><span class="co">## 1  1 112</span></span>
<span><span class="co">## 2  2 137</span></span>
<span><span class="co">## 3  3 129</span></span>
<span><span class="co">## 4  4 126</span></span>
<span><span class="co">## 5  5  88</span></span>
<span><span class="co">## 6  6  90</span></span></code></pre></div>
<p>单样本t检验：</p>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">hb</span> <span class="op">~</span> <span class="fl">1</span>, mu <span class="op">=</span> <span class="fl">140</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 7</span></span>
<span><span class="co">##   .y.   group1 group2         n statistic    df      p</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">## 1 hb    1      null model    36     -2.14    35 0.0397</span></span></code></pre></div>
<p>结果和<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>一样哦！</p>
</div>
<div id="配对t检验" class="section level3" number="13.4.2">
<h3>
<span class="header-section-number">13.4.2</span> 配对t检验<a class="anchor" aria-label="anchor" href="#%E9%85%8D%E5%AF%B9t%E6%A3%80%E9%AA%8C"><i class="fas fa-link"></i></a>
</h3>
<p>使用之前推文中的<strong>例3-6</strong>数据：</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/foreign/">foreign</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">'datasets/例03-06.sav'</span>,to.data.frame <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                         reencode <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span></span>
<span><span class="co">## re-encoding from utf-8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">##   no    x1    x2</span></span>
<span><span class="co">## 1  1 0.840 0.580</span></span>
<span><span class="co">## 2  2 0.591 0.509</span></span>
<span><span class="co">## 3  3 0.674 0.500</span></span>
<span><span class="co">## 4  4 0.632 0.316</span></span>
<span><span class="co">## 5  5 0.687 0.337</span></span>
<span><span class="co">## 6  6 0.978 0.517</span></span></code></pre></div>
<p>进行配对样本t检验：</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">st</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, names_to <span class="op">=</span> <span class="st">"X"</span>, values_to <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">values</span> <span class="op">~</span> <span class="va">X</span>, paired <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">st</span></span>
<span><span class="co">## # A tibble: 1 × 8</span></span>
<span><span class="co">##   .y.    group1 group2    n1    n2 statistic    df         p</span></span>
<span><span class="co">## * &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">## 1 values x1     x2        10    10      7.93     9 0.0000238</span></span></code></pre></div>
<p>结果和<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>也是一样的哦！</p>
<p>可视化也可直接完成！</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, names_to <span class="op">=</span> <span class="st">"X"</span>, values_to <span class="op">=</span> <span class="st">"values"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggpaired.html">ggpaired</a></span><span class="op">(</span>x<span class="op">=</span><span class="st">"X"</span>,y<span class="op">=</span><span class="st">"values"</span>,color <span class="op">=</span> <span class="st">"X"</span>,id<span class="op">=</span><span class="st">"no"</span>,line.size <span class="op">=</span> <span class="fl">0.5</span>,line.color <span class="op">=</span> <span class="st">"grey"</span>,palette <span class="op">=</span> <span class="st">"lancet"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span><span class="va">st</span>,label <span class="op">=</span> <span class="st">"配对t检验 p = {p}"</span>,y.position <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-12-1.png" width="90%"></div>
</div>
<div id="两样本t检验-1" class="section level3" number="13.4.3">
<h3>
<span class="header-section-number">13.4.3</span> 两样本t检验<a class="anchor" aria-label="anchor" href="#%E4%B8%A4%E6%A0%B7%E6%9C%ACt%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用之前推文中的<strong>例3-8</strong>的数据</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">'datasets/例03-07.sav'</span>,to.data.frame <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'阿卡波糖'</span>,<span class="fl">20</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">'拜糖平'</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">##   no    x    group</span></span>
<span><span class="co">## 1  1 -0.7 阿卡波糖</span></span>
<span><span class="co">## 2  2 -5.6 阿卡波糖</span></span>
<span><span class="co">## 3  3  2.0 阿卡波糖</span></span>
<span><span class="co">## 4  4  2.8 阿卡波糖</span></span>
<span><span class="co">## 5  5  0.7 阿卡波糖</span></span>
<span><span class="co">## 6  6  3.5 阿卡波糖</span></span></code></pre></div>
<p>进行独立样本t检验：</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">group</span>, paired <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">dt</span></span>
<span><span class="co">## # A tibble: 1 × 8</span></span>
<span><span class="co">##   .y.   group1   group2    n1    n2 statistic    df     p</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">## 1 x     阿卡波糖 拜糖平    20    20    -0.642  36.1 0.525</span></span></code></pre></div>
<p>和自带的结果是一样的哦！</p>
<p>顺便可视化一起做了：</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span><span class="va">df</span>, x<span class="op">=</span><span class="st">"group"</span>, y<span class="op">=</span><span class="st">"x"</span>,color <span class="op">=</span> <span class="st">"group"</span>, palette <span class="op">=</span> <span class="st">"lancet"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span><span class="va">dt</span>, label <span class="op">=</span> <span class="st">"t-test, p = {p}"</span>,y.position <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-15-1.png" width="90%"></div>
</div>
<div id="分组后进行比较" class="section level3" number="13.4.4">
<h3>
<span class="header-section-number">13.4.4</span> 分组后进行比较<a class="anchor" aria-label="anchor" href="#%E5%88%86%E7%BB%84%E5%90%8E%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">ToothGrowth</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">dose</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">##    len supp dose</span></span>
<span><span class="co">## 1  4.2   VC  0.5</span></span>
<span><span class="co">## 2 11.5   VC  0.5</span></span>
<span><span class="co">## 3  7.3   VC  0.5</span></span>
<span><span class="co">## 4  5.8   VC  0.5</span></span>
<span><span class="co">## 5  6.4   VC  0.5</span></span>
<span><span class="co">## 6 10.0   VC  0.5</span></span></code></pre></div>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">dose</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">supp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/adjust_pvalue.html">adjust_pvalue</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/add_significance.html">add_significance</a></span><span class="op">(</span><span class="st">"p.adj"</span><span class="op">)</span></span>
<span><span class="va">stat.test</span></span>
<span><span class="co">## # A tibble: 3 × 11</span></span>
<span><span class="co">##   dose  .y.   group1 group2    n1    n2 statistic    df       p   p.adj</span></span>
<span><span class="co">##   &lt;fct&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">## 1 0.5   len   OJ     VC        10    10    3.17    15.0 0.00636 0.0127 </span></span>
<span><span class="co">## 2 1     len   OJ     VC        10    10    4.03    15.4 0.00104 0.00312</span></span>
<span><span class="co">## 3 2     len   OJ     VC        10    10   -0.0461  14.0 0.964   0.964  </span></span>
<span><span class="co">## # ℹ 1 more variable: p.adj.signif &lt;chr&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>, x <span class="op">=</span> <span class="st">"supp"</span>, y <span class="op">=</span> <span class="st">"len"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"supp"</span>, palette <span class="op">=</span> <span class="st">"jco"</span>, facet.by <span class="op">=</span> <span class="st">"dose"</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span><span class="va">stat.test</span>, label <span class="op">=</span> <span class="st">"p.adj"</span>, y.position <span class="op">=</span> <span class="fl">35</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-18-1.png" width="90%"></div>
</div>
<div id="多组间的两两比较" class="section level3" number="13.4.5">
<h3>
<span class="header-section-number">13.4.5</span> 多组间的两两比较<a class="anchor" aria-label="anchor" href="#%E5%A4%9A%E7%BB%84%E9%97%B4%E7%9A%84%E4%B8%A4%E4%B8%A4%E6%AF%94%E8%BE%83"><i class="fas fa-link"></i></a>
</h3>
<p>如果有大于2个分组，会自动进行两两比较。</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 两两之间做t检验，自动完成</span></span>
<span><span class="va">pairwise.test</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span><span class="op">)</span></span>
<span><span class="va">pairwise.test</span></span>
<span><span class="co">## # A tibble: 3 × 10</span></span>
<span><span class="co">##   .y.   group1 group2    n1    n2 statistic    df        p    p.adj p.adj.signif</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span><span class="co">## 1 len   0.5    1         20    20     -6.48  38.0 1.27e- 7 2.54e- 7 ****        </span></span>
<span><span class="co">## 2 len   0.5    2         20    20    -11.8   36.9 4.40e-14 1.32e-13 ****        </span></span>
<span><span class="co">## 3 len   1      2         20    20     -4.90  37.1 1.91e- 5 1.91e- 5 ****</span></span></code></pre></div>
<p>可视化：</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"dose"</span>, y <span class="op">=</span> <span class="st">"len"</span>, color <span class="op">=</span> <span class="st">"dose"</span>, palette <span class="op">=</span> <span class="st">"lancet"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span></span>
<span>    <span class="va">pairwise.test</span>, label <span class="op">=</span> <span class="st">"p.adj"</span>,</span>
<span>    y.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">29</span>, <span class="fl">35</span>, <span class="fl">39</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-20-1.png" width="90%"></div>
<p>还可以指定和某一个组进行比较：</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># T-test: 都和指定的组进行比较</span></span>
<span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span>, ref.group <span class="op">=</span> <span class="st">"0.5"</span><span class="op">)</span></span>
<span><span class="va">stat.test</span></span>
<span><span class="co">## # A tibble: 2 × 10</span></span>
<span><span class="co">##   .y.   group1 group2    n1    n2 statistic    df        p    p.adj p.adj.signif</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span><span class="co">## 1 len   0.5    1         20    20     -6.48  38.0 1.27e- 7 1.27e- 7 ****        </span></span>
<span><span class="co">## 2 len   0.5    2         20    20    -11.8   36.9 4.40e-14 8.80e-14 ****</span></span></code></pre></div>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Box plot</span></span>
<span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"dose"</span>, y <span class="op">=</span> <span class="st">"len"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span></span>
<span>    <span class="va">stat.test</span>, label <span class="op">=</span> <span class="st">"p.adj.signif"</span>,</span>
<span>    y.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">29</span>, <span class="fl">35</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-22-1.png" width="90%"></div>
<p>和全部数据进行比较：</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stat.test</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/t_test.html">t_test</a></span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span>, ref.group <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="va">stat.test</span></span>
<span><span class="co">## # A tibble: 3 × 10</span></span>
<span><span class="co">##   .y.   group1 group2    n1    n2 statistic    df         p   p.adj p.adj.signif</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       </span></span>
<span><span class="co">## 1 len   all    0.5       60    20     5.82   56.4   2.90e-7 8.70e-7 ****        </span></span>
<span><span class="co">## 2 len   all    1         60    20    -0.660  57.5   5.12e-1 5.12e-1 ns          </span></span>
<span><span class="co">## 3 len   all    2         60    20    -5.61   66.5   4.25e-7 8.70e-7 ****</span></span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggboxplot.html">ggboxplot</a></span><span class="op">(</span><span class="va">df</span>, x <span class="op">=</span> <span class="st">"dose"</span>, y <span class="op">=</span> <span class="st">"len"</span>, fill <span class="op">=</span> <span class="st">"dose"</span>, </span>
<span>          palette <span class="op">=</span> <span class="st">"lancet"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html">stat_pvalue_manual</a></span><span class="op">(</span><span class="va">stat.test</span>, label <span class="op">=</span> <span class="st">"p.adj.signif"</span>, y.position <span class="op">=</span> <span class="fl">35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">len</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-24-1.png" width="90%"></div>
</div>
</div>
<div id="方差分析" class="section level2" number="13.5">
<h2>
<span class="header-section-number">13.5</span> 方差分析<a class="anchor" aria-label="anchor" href="#%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h2>
<div id="完全随机设计方差分析" class="section level3" number="13.5.1">
<h3>
<span class="header-section-number">13.5.1</span> 完全随机设计方差分析<a class="anchor" aria-label="anchor" href="#%E5%AE%8C%E5%85%A8%E9%9A%8F%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例4-2</strong>的数据。</p>
<p>首先是构造数据，本次数据自己从书上摘录。。</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">trt</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"group1"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"group2"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"group3"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"group4"</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weight</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.53</span>,<span class="fl">4.59</span>,<span class="fl">4.34</span>,<span class="fl">2.66</span>,<span class="fl">3.59</span>,<span class="fl">3.13</span>,<span class="fl">3.30</span>,<span class="fl">4.04</span>,<span class="fl">3.53</span>,<span class="fl">3.56</span>,<span class="fl">3.85</span>,<span class="fl">4.07</span>,<span class="fl">1.37</span>,</span>
<span>          <span class="fl">3.93</span>,<span class="fl">2.33</span>,<span class="fl">2.98</span>,<span class="fl">4.00</span>,<span class="fl">3.55</span>,<span class="fl">2.64</span>,<span class="fl">2.56</span>,<span class="fl">3.50</span>,<span class="fl">3.25</span>,<span class="fl">2.96</span>,<span class="fl">4.30</span>,<span class="fl">3.52</span>,<span class="fl">3.93</span>,</span>
<span>          <span class="fl">4.19</span>,<span class="fl">2.96</span>,<span class="fl">4.16</span>,<span class="fl">2.59</span>,<span class="fl">2.42</span>,<span class="fl">3.36</span>,<span class="fl">4.32</span>,<span class="fl">2.34</span>,<span class="fl">2.68</span>,<span class="fl">2.95</span>,<span class="fl">2.36</span>,<span class="fl">2.56</span>,<span class="fl">2.52</span>,</span>
<span>          <span class="fl">2.27</span>,<span class="fl">2.98</span>,<span class="fl">3.72</span>,<span class="fl">2.65</span>,<span class="fl">2.22</span>,<span class="fl">2.90</span>,<span class="fl">1.98</span>,<span class="fl">2.63</span>,<span class="fl">2.86</span>,<span class="fl">2.93</span>,<span class="fl">2.17</span>,<span class="fl">2.72</span>,<span class="fl">1.56</span>,</span>
<span>          <span class="fl">3.11</span>,<span class="fl">1.81</span>,<span class="fl">1.77</span>,<span class="fl">2.80</span>,<span class="fl">3.57</span>,<span class="fl">2.97</span>,<span class="fl">4.02</span>,<span class="fl">2.31</span>,<span class="fl">2.86</span>,<span class="fl">2.28</span>,<span class="fl">2.39</span>,<span class="fl">2.28</span>,<span class="fl">2.48</span>,</span>
<span>          <span class="fl">2.28</span>,<span class="fl">3.48</span>,<span class="fl">2.42</span>,<span class="fl">2.41</span>,<span class="fl">2.66</span>,<span class="fl">3.29</span>,<span class="fl">2.70</span>,<span class="fl">2.66</span>,<span class="fl">3.68</span>,<span class="fl">2.65</span>,<span class="fl">2.66</span>,<span class="fl">2.32</span>,<span class="fl">2.61</span>,</span>
<span>          <span class="fl">3.64</span>,<span class="fl">2.58</span>,<span class="fl">3.65</span>,<span class="fl">3.21</span>,<span class="fl">2.23</span>,<span class="fl">2.32</span>,<span class="fl">2.68</span>,<span class="fl">3.04</span>,<span class="fl">2.81</span>,<span class="fl">3.02</span>,<span class="fl">1.97</span>,<span class="fl">1.68</span>,<span class="fl">0.89</span>,</span>
<span>          <span class="fl">1.06</span>,<span class="fl">1.08</span>,<span class="fl">1.27</span>,<span class="fl">1.63</span>,<span class="fl">1.89</span>,<span class="fl">1.31</span>,<span class="fl">2.51</span>,<span class="fl">1.88</span>,<span class="fl">1.41</span>,<span class="fl">3.19</span>,<span class="fl">1.92</span>,<span class="fl">0.94</span>,<span class="fl">2.11</span>,</span>
<span>          <span class="fl">2.81</span>,<span class="fl">1.98</span>,<span class="fl">1.74</span>,<span class="fl">2.16</span>,<span class="fl">3.37</span>,<span class="fl">2.97</span>,<span class="fl">1.69</span>,<span class="fl">1.19</span>,<span class="fl">2.17</span>,<span class="fl">2.28</span>,<span class="fl">1.72</span>,<span class="fl">2.47</span>,<span class="fl">1.02</span>,</span>
<span>          <span class="fl">2.52</span>,<span class="fl">2.10</span>,<span class="fl">3.71</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">trt</span>,<span class="va">weight</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></span>
<span><span class="co">##      trt weight</span></span>
<span><span class="co">## 1 group1   3.53</span></span>
<span><span class="co">## 2 group1   4.59</span></span>
<span><span class="co">## 3 group1   4.34</span></span>
<span><span class="co">## 4 group1   2.66</span></span>
<span><span class="co">## 5 group1   3.59</span></span>
<span><span class="co">## 6 group1   3.13</span></span></code></pre></div>
<p>进行完全随机设计资料的方差分析：</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">trt</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Effect DFn DFd      F        p p&lt;.05   ges</span></span>
<span><span class="co">## 1    trt   3 116 24.884 1.67e-12     * 0.392</span></span></code></pre></div>
</div>
<div id="随机区组设计资料的方差分析-1" class="section level3" number="13.5.2">
<h3>
<span class="header-section-number">13.5.2</span> 随机区组设计资料的方差分析<a class="anchor" aria-label="anchor" href="#%E9%9A%8F%E6%9C%BA%E5%8C%BA%E7%BB%84%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用<strong>例4-3</strong>的数据。</p>
<p>首先是构造数据，本次数据自己从书上摘录。。</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.82</span>,<span class="fl">0.65</span>,<span class="fl">0.51</span>,<span class="fl">0.73</span>,<span class="fl">0.54</span>,<span class="fl">0.23</span>,<span class="fl">0.43</span>,<span class="fl">0.34</span>,<span class="fl">0.28</span>,<span class="fl">0.41</span>,<span class="fl">0.21</span>,</span>
<span>            <span class="fl">0.31</span>,<span class="fl">0.68</span>,<span class="fl">0.43</span>,<span class="fl">0.24</span><span class="op">)</span></span>
<span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data4_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">weight</span>,<span class="va">block</span>,<span class="va">group</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">data4_4</span><span class="op">)</span></span>
<span><span class="co">##   weight block group</span></span>
<span><span class="co">## 1   0.82     1     A</span></span>
<span><span class="co">## 2   0.65     1     B</span></span>
<span><span class="co">## 3   0.51     1     C</span></span>
<span><span class="co">## 4   0.73     2     A</span></span>
<span><span class="co">## 5   0.54     2     B</span></span>
<span><span class="co">## 6   0.23     2     C</span></span></code></pre></div>
<p>数据一共3列，第一列是小白鼠肉瘤重量，第二列是区组因素（5个区组），第三列是分组（一共3组）</p>
<p>进行随机区组设计资料的方差分析：</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data4_4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="va">block</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Effect DFn DFd      F     p p&lt;.05   ges</span></span>
<span><span class="co">## 1  group   2   8 11.937 0.004     * 0.749</span></span>
<span><span class="co">## 2  block   4   8  5.978 0.016     * 0.749</span></span></code></pre></div>
</div>
<div id="拉丁方设计方差分析-1" class="section level3" number="13.5.3">
<h3>
<span class="header-section-number">13.5.3</span> 拉丁方设计方差分析<a class="anchor" aria-label="anchor" href="#%E6%8B%89%E4%B8%81%E6%96%B9%E8%AE%BE%E8%AE%A1%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例4-5</strong>的数据。</p>
<p>首先是构造数据，本次数据自己从书上摘录。。</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">psize</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">87</span>,<span class="fl">75</span>,<span class="fl">81</span>,<span class="fl">75</span>,<span class="fl">84</span>,<span class="fl">66</span>,<span class="fl">73</span>,<span class="fl">81</span>,<span class="fl">87</span>,<span class="fl">85</span>,<span class="fl">64</span>,<span class="fl">79</span>,<span class="fl">73</span>,<span class="fl">73</span>,<span class="fl">74</span>,<span class="fl">78</span>,<span class="fl">73</span>,<span class="fl">77</span>,<span class="fl">77</span>,<span class="fl">68</span>,</span>
<span>           <span class="fl">69</span>,<span class="fl">74</span>,<span class="fl">76</span>,<span class="fl">73</span>,<span class="fl">64</span>,<span class="fl">64</span>,<span class="fl">72</span>,<span class="fl">76</span>,<span class="fl">70</span>,<span class="fl">81</span>,<span class="fl">75</span>,<span class="fl">77</span>,<span class="fl">82</span>,<span class="fl">61</span>,<span class="fl">82</span>,<span class="fl">61</span><span class="op">)</span></span>
<span><span class="va">drug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"C"</span>,<span class="st">"B"</span>,<span class="st">"E"</span>,<span class="st">"D"</span>,<span class="st">"A"</span>,<span class="st">"F"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"D"</span>,<span class="st">"C"</span>,<span class="st">"F"</span>,<span class="st">"E"</span>,<span class="st">"F"</span>,<span class="st">"E"</span>,<span class="st">"B"</span>,</span>
<span>          <span class="st">"A"</span>,<span class="st">"D"</span>,<span class="st">"C"</span>,<span class="st">"A"</span>,<span class="st">"F"</span>,<span class="st">"C"</span>,<span class="st">"B"</span>,<span class="st">"E"</span>,<span class="st">"D"</span>,<span class="st">"D"</span>,<span class="st">"C"</span>,<span class="st">"F"</span>,<span class="st">"E"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,</span>
<span>          <span class="st">"E"</span>,<span class="st">"D"</span>,<span class="st">"A"</span>,<span class="st">"F"</span>,<span class="st">"C"</span>,<span class="st">"B"</span><span class="op">)</span></span>
<span><span class="va">col_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">row_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,each<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">psize</span>,<span class="va">drug</span>,<span class="va">col_block</span>,<span class="va">row_block</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">col_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">col_block</span><span class="op">)</span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">row_block</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">row_block</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    36 obs. of  4 variables:</span></span>
<span><span class="co">##  $ psize    : num  87 75 81 75 84 66 73 81 87 85 ...</span></span>
<span><span class="co">##  $ drug     : chr  "C" "B" "E" "D" ...</span></span>
<span><span class="co">##  $ col_block: Factor w/ 6 levels "1","2","3","4",..: 1 2 3 4 5 6 1 2 3 4 ...</span></span>
<span><span class="co">##  $ row_block: Factor w/ 6 levels "1","2","3","4",..: 1 1 1 1 1 1 2 2 2 2 ...</span></span></code></pre></div>
<p>数据一共4列，第一列是皮肤疱疹大小，第二列是不同药物（处理因素，共5种），第三列是列区组因素，第四列是行区组因素。</p>
<p>进行拉丁方设计的方差分析：</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">psize</span> <span class="op">~</span> <span class="va">drug</span> <span class="op">+</span> <span class="va">col_block</span> <span class="op">+</span> <span class="va">row_block</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##      Effect DFn DFd     F     p p&lt;.05   ges</span></span>
<span><span class="co">## 1      drug   5  20 3.906 0.012     * 0.494</span></span>
<span><span class="co">## 2 col_block   5  20 0.500 0.772       0.111</span></span>
<span><span class="co">## 3 row_block   5  20 1.466 0.245       0.268</span></span></code></pre></div>
</div>
<div id="两阶段交叉设计资料方差分析-1" class="section level3" number="13.5.4">
<h3>
<span class="header-section-number">13.5.4</span> 两阶段交叉设计资料方差分析<a class="anchor" aria-label="anchor" href="#%E4%B8%A4%E9%98%B6%E6%AE%B5%E4%BA%A4%E5%8F%89%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例4-6</strong>的数据。</p>
<p>首先是构造数据，本次数据自己从书上摘录。。</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">760</span>,<span class="fl">770</span>,<span class="fl">860</span>,<span class="fl">855</span>,<span class="fl">568</span>,<span class="fl">602</span>,<span class="fl">780</span>,<span class="fl">800</span>,<span class="fl">960</span>,<span class="fl">958</span>,<span class="fl">940</span>,<span class="fl">952</span>,<span class="fl">635</span>,<span class="fl">650</span>,<span class="fl">440</span>,<span class="fl">450</span>,</span>
<span>             <span class="fl">528</span>,<span class="fl">530</span>,<span class="fl">800</span>,<span class="fl">803</span><span class="op">)</span></span>
<span><span class="va">phase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"phase_1"</span>,<span class="st">"phase_2"</span><span class="op">)</span>,<span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span>,</span>
<span>          <span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span>,<span class="st">"A"</span><span class="op">)</span></span>
<span><span class="va">testid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,each<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">testid</span>,<span class="va">phase</span>,<span class="va">type</span>,<span class="va">contain</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    20 obs. of  4 variables:</span></span>
<span><span class="co">##  $ testid : int  1 1 2 2 3 3 4 4 5 5 ...</span></span>
<span><span class="co">##  $ phase  : chr  "phase_1" "phase_2" "phase_1" "phase_2" ...</span></span>
<span><span class="co">##  $ type   : chr  "A" "B" "B" "A" ...</span></span>
<span><span class="co">##  $ contain: num  760 770 860 855 568 602 780 800 960 958 ...</span></span>
<span></span>
<span><span class="va">mydata</span><span class="op">$</span><span class="va">testid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">$</span><span class="va">testid</span><span class="op">)</span></span></code></pre></div>
<p>数据一共4列，第一列是受试者id，第二列是不同阶段，第三列是测定方法，第四列是测量值。</p>
<p>进行两阶段交叉设计资料方差分析：</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">contain</span> <span class="op">~</span> <span class="va">phase</span> <span class="op">+</span> <span class="va">type</span> <span class="op">+</span> <span class="va">testid</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Effect DFn DFd        F        p p&lt;.05   ges</span></span>
<span><span class="co">## 1  phase   1   8    9.925 1.40e-02     * 0.554</span></span>
<span><span class="co">## 2   type   1   8    4.019 8.00e-02       0.334</span></span>
<span><span class="co">## 3 testid   9   8 1240.195 1.32e-11     * 0.999</span></span></code></pre></div>
<p>结果和课本一致！</p>
</div>
<div id="析因设计资料的方差分析" class="section level3" number="13.5.5">
<h3>
<span class="header-section-number">13.5.5</span> 析因设计资料的方差分析<a class="anchor" aria-label="anchor" href="#%E6%9E%90%E5%9B%A0%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例11-1</strong>的数据，自己手动摘录：</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df11_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"外膜缝合"</span>,<span class="st">"束膜缝合"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"缝合1个月"</span>,<span class="st">"缝合2个月"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">10</span>,<span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">70</span>,<span class="fl">60</span>,<span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">50</span>,<span class="fl">30</span>,<span class="fl">50</span>,<span class="fl">50</span>,<span class="fl">70</span>,<span class="fl">60</span>,<span class="fl">30</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df11_1</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    20 obs. of  3 variables:</span></span>
<span><span class="co">##  $ x1: chr  "外膜缝合" "外膜缝合" "外膜缝合" "外膜缝合" ...</span></span>
<span><span class="co">##  $ x2: chr  "缝合1个月" "缝合1个月" "缝合1个月" "缝合1个月" ...</span></span>
<span><span class="co">##  $ y : num  10 10 40 50 10 30 30 70 60 30 ...</span></span></code></pre></div>
<p>数据一共3列，第1列是缝合方法，第2列是时间，第3列是轴突通过率。</p>
<p>进行析因设计资料的方差分析：</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df11_1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Effect DFn DFd     F     p p&lt;.05   ges</span></span>
<span><span class="co">## 1     x1   1  16 0.600 0.450       0.036</span></span>
<span><span class="co">## 2     x2   1  16 8.067 0.012     * 0.335</span></span>
<span><span class="co">## 3  x1:x2   1  16 0.067 0.800       0.004</span></span></code></pre></div>
</div>
<div id="正交设计资料的方差分析-1" class="section level3" number="13.5.6">
<h3>
<span class="header-section-number">13.5.6</span> 正交设计资料的方差分析<a class="anchor" aria-label="anchor" href="#%E6%AD%A3%E4%BA%A4%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例11-4</strong>的数据</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df11_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5度"</span>,<span class="st">"25度"</span><span class="op">)</span>,each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">5.0</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  d <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.0</span>, <span class="fl">8.0</span>,<span class="fl">8.0</span>,<span class="fl">6.0</span>,<span class="fl">8.0</span>,<span class="fl">6.0</span>,<span class="fl">6.0</span>,<span class="fl">8.0</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">86</span>,<span class="fl">95</span>,<span class="fl">91</span>,<span class="fl">94</span>,<span class="fl">91</span>,<span class="fl">96</span>,<span class="fl">83</span>,<span class="fl">88</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df11_4</span><span class="op">$</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df11_4</span><span class="op">$</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="va">df11_4</span><span class="op">$</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df11_4</span><span class="op">$</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="va">df11_4</span><span class="op">$</span><span class="va">c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df11_4</span><span class="op">$</span><span class="va">c</span><span class="op">)</span></span>
<span><span class="va">df11_4</span><span class="op">$</span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df11_4</span><span class="op">$</span><span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df11_4</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    8 obs. of  5 variables:</span></span>
<span><span class="co">##  $ a: Factor w/ 2 levels "25度","5度": 2 2 2 2 1 1 1 1</span></span>
<span><span class="co">##  $ b: Factor w/ 2 levels "0.5","5": 1 1 2 2 1 1 2 2</span></span>
<span><span class="co">##  $ c: Factor w/ 2 levels "10","30": 1 2 1 2 1 2 1 2</span></span>
<span><span class="co">##  $ d: Factor w/ 2 levels "6","8": 1 2 2 1 2 1 1 2</span></span>
<span><span class="co">##  $ x: num  86 95 91 94 91 96 83 88</span></span></code></pre></div>
<p>进行正交设计资料的方差分析：</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df11_4</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">x</span> <span class="op">~</span> <span class="va">a</span> <span class="op">+</span> <span class="va">b</span> <span class="op">+</span> <span class="va">c</span> <span class="op">+</span> <span class="va">d</span> <span class="op">+</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   Effect DFn DFd    F     p p&lt;.05   ges</span></span>
<span><span class="co">## 1      a   1   2  3.2 0.216       0.615</span></span>
<span><span class="co">## 2      b   1   2  7.2 0.115       0.783</span></span>
<span><span class="co">## 3      c   1   2 24.2 0.039     * 0.924</span></span>
<span><span class="co">## 4      d   1   2  1.8 0.312       0.474</span></span>
<span><span class="co">## 5    a:b   1   2 20.0 0.047     * 0.909</span></span></code></pre></div>
</div>
<div id="重复测量数据两因素两水平的方差分析-1" class="section level3" number="13.5.7">
<h3>
<span class="header-section-number">13.5.7</span> 重复测量数据两因素两水平的方差分析<a class="anchor" aria-label="anchor" href="#%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%95%B0%E6%8D%AE%E4%B8%A4%E5%9B%A0%E7%B4%A0%E4%B8%A4%E6%B0%B4%E5%B9%B3%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例12-1</strong>的数据，直接读取：</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df12_1</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">"datasets/12-1.sav"</span>, to.data.frame <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## re-encoding from CP936</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df12_1</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    20 obs. of  5 variables:</span></span>
<span><span class="co">##  $ n    : num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ x1   : num  130 124 136 128 122 118 116 138 126 124 ...</span></span>
<span><span class="co">##  $ x2   : num  114 110 126 116 102 100 98 122 108 106 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 2 levels "处理组","对照组": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ d    : num  16 14 10 12 20 18 18 16 18 18 ...</span></span>
<span><span class="co">##  - attr(*, "variable.labels")= Named chr [1:5] "编号" "治疗前血压" "治疗后血压" "组别" ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:5] "n" "x1" "x2" "group" ...</span></span>
<span><span class="co">##  - attr(*, "codepage")= int 936</span></span></code></pre></div>
<p>数据一共5列（第5列是自己算出来的，其实原始数据只有4列），第1 列是编号，第2列是治疗前血压，第3例是治疗后血压，第4列是分组，第5列是血压前后差值。</p>
<p>进行重复测量数据两因素两水平的方差分析前，先把数据转换一下格式：</p>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df12_11</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">df12_1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>,names_to <span class="op">=</span> <span class="st">"time"</span>,values_to <span class="op">=</span> <span class="st">"hp"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.character</span>, <span class="va">as.factor</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df12_11</span><span class="op">$</span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df12_11</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df12_11</span><span class="op">)</span></span>
<span><span class="co">## tibble [40 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ n    : Factor w/ 20 levels "1","2","3","4",..: 1 1 2 2 3 3 4 4 5 5 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 2 levels "处理组","对照组": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ time : Factor w/ 2 levels "x1","x2": 1 2 1 2 1 2 1 2 1 2 ...</span></span>
<span><span class="co">##  $ hp   : num [1:40] 130 114 124 110 136 126 128 116 122 102 ...</span></span></code></pre></div>
<p>进行重复测量数据两因素两水平的方差分析:</p>
<p>hp是因变量，time是测量时间（治疗前和治疗后各测量一次），group是分组因素（两种治疗方法），n是受试者编号</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df12_11</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">time</span> <span class="op">*</span> <span class="va">group</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##       Effect DFn DFd      F        p p&lt;.05   ges</span></span>
<span><span class="co">## 1      group   1  18  1.574 2.26e-01       0.071</span></span>
<span><span class="co">## 2       time   1  18 55.008 7.08e-07     * 0.278</span></span>
<span><span class="co">## 3 group:time   1  18 18.771 4.01e-04     * 0.116</span></span></code></pre></div>
<p>这个结果也是和课本一样的，只不过没有显示组内误差的情况！</p>
</div>
<div id="重复测量数据两因素多水平的分析-1" class="section level3" number="13.5.8">
<h3>
<span class="header-section-number">13.5.8</span> 重复测量数据两因素多水平的分析<a class="anchor" aria-label="anchor" href="#%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%95%B0%E6%8D%AE%E4%B8%A4%E5%9B%A0%E7%B4%A0%E5%A4%9A%E6%B0%B4%E5%B9%B3%E7%9A%84%E5%88%86%E6%9E%90-1"><i class="fas fa-link"></i></a>
</h3>
<p>使用课本<strong>例12-3</strong>的数据，直接读取：</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df12_3</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">"datasets/例12-03.sav"</span>,to.data.frame <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df12_3</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    15 obs. of  7 variables:</span></span>
<span><span class="co">##  $ No   : num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 3 levels "A","B","C": 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ t0   : num  120 118 119 121 127 121 122 128 117 118 ...</span></span>
<span><span class="co">##  $ t1   : num  108 109 112 112 121 120 121 129 115 114 ...</span></span>
<span><span class="co">##  $ t2   : num  112 115 119 119 127 118 119 126 111 116 ...</span></span>
<span><span class="co">##  $ t3   : num  120 126 124 126 133 131 129 135 123 123 ...</span></span>
<span><span class="co">##  $ t4   : num  117 123 118 120 126 137 133 142 131 133 ...</span></span>
<span><span class="co">##  - attr(*, "variable.labels")= Named chr [1:7] "\xd0\xf2\xba\xc5" "\xd7\xe9\xb1\xf0" "" "" ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:7] "No" "group" "t0" "t1" ...</span></span></code></pre></div>
<p>数据一共7列，第1列是患者编号，第2列是诱导方法（3种），第3-7列是5个时间点的血压。</p>
<p>首先转换数据格式：</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df12_31</span> <span class="op">&lt;-</span> <span class="va">df12_3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, names_to <span class="op">=</span> <span class="st">"times"</span>, values_to <span class="op">=</span> <span class="st">"hp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df12_31</span><span class="op">$</span><span class="va">No</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df12_31</span><span class="op">$</span><span class="va">No</span><span class="op">)</span></span>
<span><span class="va">df12_31</span><span class="op">$</span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df12_31</span><span class="op">$</span><span class="va">times</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df12_31</span><span class="op">)</span></span>
<span><span class="co">## tibble [75 × 4] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">##  $ No   : Factor w/ 15 levels "1","2","3","4",..: 1 1 1 1 1 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 3 levels "A","B","C": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ times: Factor w/ 5 levels "t0","t1","t2",..: 1 2 3 4 5 1 2 3 4 5 ...</span></span>
<span><span class="co">##  $ hp   : num [1:75] 120 108 112 120 117 118 109 115 126 123 ...</span></span></code></pre></div>
<p>进行重复测量两因素多水平的方差分析：</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df12_31</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/anova_test.html">anova_test</a></span><span class="op">(</span><span class="va">hp</span> <span class="op">~</span> <span class="va">times</span> <span class="op">*</span> <span class="va">group</span> <span class="op">+</span> <span class="fu">Error</span><span class="op">(</span><span class="va">No</span><span class="op">/</span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## ANOVA Table (type II tests)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $ANOVA</span></span>
<span><span class="co">##        Effect DFn DFd       F        p p&lt;.05   ges</span></span>
<span><span class="co">## 1       group   2  12   5.783 1.70e-02     * 0.430</span></span>
<span><span class="co">## 2       times   4  48 106.558 3.02e-23     * 0.659</span></span>
<span><span class="co">## 3 group:times   8  48  19.101 1.62e-12     * 0.409</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Mauchly's Test for Sphericity`</span></span>
<span><span class="co">##        Effect     W     p p&lt;.05</span></span>
<span><span class="co">## 1       times 0.293 0.178      </span></span>
<span><span class="co">## 2 group:times 0.293 0.178      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $`Sphericity Corrections`</span></span>
<span><span class="co">##        Effect   GGe      DF[GG]    p[GG] p[GG]&lt;.05   HFe      DF[HF]    p[HF]</span></span>
<span><span class="co">## 1       times 0.679 2.71, 32.58 1.87e-16         * 0.896 3.59, 43.03 4.65e-21</span></span>
<span><span class="co">## 2 group:times 0.679 5.43, 32.58 4.26e-09         * 0.896 7.17, 43.03 2.04e-11</span></span>
<span><span class="co">##   p[HF]&lt;.05</span></span>
<span><span class="co">## 1         *</span></span>
<span><span class="co">## 2         *</span></span></code></pre></div>
<p>这个结果也是和课本一样的，而且直接给出了球形检验的结果！非常方便。</p>
</div>
</div>
<div id="相关分析" class="section level2" number="13.6">
<h2>
<span class="header-section-number">13.6</span> 相关分析<a class="anchor" aria-label="anchor" href="#%E7%9B%B8%E5%85%B3%E5%88%86%E6%9E%90"><i class="fas fa-link"></i></a>
</h2>
<p>以R语言自带的<code>mtcars</code>数据集为例。</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">disp</span>, <span class="va">hp</span>, <span class="va">drat</span>, <span class="va">wt</span>, <span class="va">qsec</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">##                    mpg disp  hp drat    wt  qsec</span></span>
<span><span class="co">## Mazda RX4         21.0  160 110 3.90 2.620 16.46</span></span>
<span><span class="co">## Mazda RX4 Wag     21.0  160 110 3.90 2.875 17.02</span></span>
<span><span class="co">## Datsun 710        22.8  108  93 3.85 2.320 18.61</span></span>
<span><span class="co">## Hornet 4 Drive    21.4  258 110 3.08 3.215 19.44</span></span>
<span><span class="co">## Hornet Sportabout 18.7  360 175 3.15 3.440 17.02</span></span>
<span><span class="co">## Valiant           18.1  225 105 2.76 3.460 20.22</span></span></code></pre></div>
<div id="两个变量" class="section level3" number="13.6.1">
<h3>
<span class="header-section-number">13.6.1</span> 两个变量<a class="anchor" aria-label="anchor" href="#%E4%B8%A4%E4%B8%AA%E5%8F%98%E9%87%8F"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 8</span></span>
<span><span class="co">##   var1  var2    cor statistic        p conf.low conf.high method </span></span>
<span><span class="co">##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span><span class="co">## 1 wt    mpg   -0.87     -9.56 1.29e-10   -0.934    -0.744 Pearson</span></span></code></pre></div>
</div>
<div id="一个变量和其他所有变量" class="section level3" number="13.6.2">
<h3>
<span class="header-section-number">13.6.2</span> 一个变量和其他所有变量<a class="anchor" aria-label="anchor" href="#%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F%E5%92%8C%E5%85%B6%E4%BB%96%E6%89%80%E6%9C%89%E5%8F%98%E9%87%8F"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_test.html">cor_test</a></span><span class="op">(</span><span class="va">mpg</span>, method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 5 × 8</span></span>
<span><span class="co">##   var1  var2    cor statistic        p conf.low conf.high method </span></span>
<span><span class="co">##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span><span class="co">## 1 mpg   disp  -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson</span></span>
<span><span class="co">## 2 mpg   hp    -0.78     -6.74 1.79e- 7  -0.885     -0.586 Pearson</span></span>
<span><span class="co">## 3 mpg   drat   0.68      5.10 1.78e- 5   0.436      0.832 Pearson</span></span>
<span><span class="co">## 4 mpg   wt    -0.87     -9.56 1.29e-10  -0.934     -0.744 Pearson</span></span>
<span><span class="co">## 5 mpg   qsec   0.42      2.53 1.71e- 2   0.0820     0.670 Pearson</span></span></code></pre></div>
</div>
<div id="所有变量间两两相关性" class="section level3" number="13.6.3">
<h3>
<span class="header-section-number">13.6.3</span> 所有变量间两两相关性<a class="anchor" aria-label="anchor" href="#%E6%89%80%E6%9C%89%E5%8F%98%E9%87%8F%E9%97%B4%E4%B8%A4%E4%B8%A4%E7%9B%B8%E5%85%B3%E6%80%A7"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_test.html">cor_test</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 36 × 8</span></span>
<span><span class="co">##    var1  var2    cor statistic        p conf.low conf.high method </span></span>
<span><span class="co">##    &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;  </span></span>
<span><span class="co">##  1 mpg   mpg    1       Inf    0          1          1     Pearson</span></span>
<span><span class="co">##  2 mpg   disp  -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson</span></span>
<span><span class="co">##  3 mpg   hp    -0.78     -6.74 1.79e- 7  -0.885     -0.586 Pearson</span></span>
<span><span class="co">##  4 mpg   drat   0.68      5.10 1.78e- 5   0.436      0.832 Pearson</span></span>
<span><span class="co">##  5 mpg   wt    -0.87     -9.56 1.29e-10  -0.934     -0.744 Pearson</span></span>
<span><span class="co">##  6 mpg   qsec   0.42      2.53 1.71e- 2   0.0820     0.670 Pearson</span></span>
<span><span class="co">##  7 disp  mpg   -0.85     -8.75 9.38e-10  -0.923     -0.708 Pearson</span></span>
<span><span class="co">##  8 disp  disp   1       Inf    0          1          1     Pearson</span></span>
<span><span class="co">##  9 disp  hp     0.79      7.08 7.14e- 8   0.611      0.893 Pearson</span></span>
<span><span class="co">## 10 disp  drat  -0.71     -5.53 5.28e- 6  -0.849     -0.481 Pearson</span></span>
<span><span class="co">## # ℹ 26 more rows</span></span></code></pre></div>
<p>可以看到所有的输出都是整洁格式的，而且都给出了详细的统计值。</p>
</div>
<div id="相关矩阵" class="section level3" number="13.6.4">
<h3>
<span class="header-section-number">13.6.4</span> 相关矩阵<a class="anchor" aria-label="anchor" href="#%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5"><i class="fas fa-link"></i></a>
</h3>
<p>当然也提供了相关矩阵的方法。</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.mat</span> <span class="op">&lt;-</span> <span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_mat</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cor.mat</span></span>
<span><span class="co">## # A tibble: 6 × 7</span></span>
<span><span class="co">##   rowname   mpg  disp    hp   drat    wt   qsec</span></span>
<span><span class="co">## * &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">## 1 mpg      1    -0.85 -0.78  0.68  -0.87  0.42 </span></span>
<span><span class="co">## 2 disp    -0.85  1     0.79 -0.71   0.89 -0.43 </span></span>
<span><span class="co">## 3 hp      -0.78  0.79  1    -0.45   0.66 -0.71 </span></span>
<span><span class="co">## 4 drat     0.68 -0.71 -0.45  1     -0.71  0.091</span></span>
<span><span class="co">## 5 wt      -0.87  0.89  0.66 -0.71   1    -0.17 </span></span>
<span><span class="co">## 6 qsec     0.42 -0.43 -0.71  0.091 -0.17  1</span></span></code></pre></div>
<p>展示P值矩阵：</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.mat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mat.html">cor_get_pval</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 6 × 7</span></span>
<span><span class="co">##   rowname      mpg     disp           hp       drat        wt       qsec</span></span>
<span><span class="co">##   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">## 1 mpg     0        9.38e-10 0.000000179  0.0000178  1.29e- 10 0.0171    </span></span>
<span><span class="co">## 2 disp    9.38e-10 0        0.0000000714 0.00000528 1.22e- 11 0.0131    </span></span>
<span><span class="co">## 3 hp      1.79e- 7 7.14e- 8 0            0.00999    4.15e-  5 0.00000577</span></span>
<span><span class="co">## 4 drat    1.78e- 5 5.28e- 6 0.00999      0          4.78e-  6 0.62      </span></span>
<span><span class="co">## 5 wt      1.29e-10 1.22e-11 0.0000415    0.00000478 2.27e-236 0.339     </span></span>
<span><span class="co">## 6 qsec    1.71e- 2 1.31e- 2 0.00000577   0.62       3.39e-  1 0</span></span></code></pre></div>
<p>使用*代替p值：</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.mat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_as_symbols.html">cor_as_symbols</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/pull_triangle.html">pull_lower_triangle</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##   rowname mpg disp hp drat wt qsec</span></span>
<span><span class="co">## 1     mpg                         </span></span>
<span><span class="co">## 2    disp   *                     </span></span>
<span><span class="co">## 3      hp   *    *                </span></span>
<span><span class="co">## 4    drat   +    +  .             </span></span>
<span><span class="co">## 5      wt   *    *  +    +        </span></span>
<span><span class="co">## 6    qsec   .    .  +</span></span></code></pre></div>
<p>星号和相关性一起显示：</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.mat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_mark_significant.html">cor_mark_significant</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">##   rowname       mpg      disp        hp      drat    wt qsec</span></span>
<span><span class="co">## 1     mpg                                                   </span></span>
<span><span class="co">## 2    disp -0.85****                                         </span></span>
<span><span class="co">## 3      hp -0.78****  0.79****                               </span></span>
<span><span class="co">## 4    drat  0.68**** -0.71****   -0.45**                     </span></span>
<span><span class="co">## 5      wt -0.87****  0.89****  0.66**** -0.71****           </span></span>
<span><span class="co">## 6    qsec     0.42*    -0.43* -0.71****     0.091 -0.17</span></span></code></pre></div>
<p>简单的可视化：</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cor.mat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_reorder.html">cor_reorder</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/cor_plot.html">cor_plot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="1013-rstastix_files/figure-html/unnamed-chunk-51-1.png" width="90%"></div>
<p>这个图明显是使用<code>corrplot</code>包画出来的，可以直接使用此包画出更好看的图，我的公众号中已有专门介绍<code>corrplot</code>包的推文！</p>
</div>
</div>
<div id="秩和检验" class="section level2" number="13.7">
<h2>
<span class="header-section-number">13.7</span> 秩和检验<a class="anchor" aria-label="anchor" href="#%E7%A7%A9%E5%92%8C%E6%A3%80%E9%AA%8C"><i class="fas fa-link"></i></a>
</h2>
<p>协方差分析、裂区设计、嵌套设计、都支持！语法完全一样。结果也一样。</p>
<div id="配对样本比较的wilcoxon符号秩检验-1" class="section level3" number="13.7.1">
<h3>
<span class="header-section-number">13.7.1</span> 配对样本比较的Wilcoxon符号秩检验<a class="anchor" aria-label="anchor" href="#%E9%85%8D%E5%AF%B9%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84wilcoxon%E7%AC%A6%E5%8F%B7%E7%A7%A9%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<p>课本例8-1的数据</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">60</span>,<span class="fl">142</span>,<span class="fl">195</span>,<span class="fl">80</span>,<span class="fl">242</span>,<span class="fl">220</span>,<span class="fl">190</span>,<span class="fl">25</span>,<span class="fl">198</span>,<span class="fl">38</span>,<span class="fl">236</span>,<span class="fl">95</span><span class="op">)</span></span>
<span><span class="va">test2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">76</span>,<span class="fl">152</span>,<span class="fl">243</span>,<span class="fl">82</span>,<span class="fl">240</span>,<span class="fl">220</span>,<span class="fl">205</span>,<span class="fl">38</span>,<span class="fl">243</span>,<span class="fl">44</span>,<span class="fl">190</span>,<span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test1</span>,<span class="va">test2</span><span class="op">)</span>,group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    24 obs. of  2 variables:</span></span>
<span><span class="co">##  $ y    : num  60 142 195 80 242 220 190 25 198 38 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 2 levels "1","2": 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>没有<code>correct</code>选项</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_test.html">wilcox_test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>,paired <span class="op">=</span> <span class="cn">T</span>,exact <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 7</span></span>
<span><span class="co">##   .y.   group1 group2    n1    n2 statistic      p</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">## 1 y     1      2         12    12      11.5 0.0618</span></span></code></pre></div>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">df</span>,paired<span class="op">=</span><span class="cn">T</span>,exact<span class="op">=</span><span class="cn">F</span>,correct<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon signed rank test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  y by group</span></span>
<span><span class="co">## V = 11.5, p-value = 0.05581</span></span>
<span><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
</div>
<div id="两独立样本比较的wilcoxon符号秩检验-1" class="section level3" number="13.7.2">
<h3>
<span class="header-section-number">13.7.2</span> 两独立样本比较的Wilcoxon符号秩检验<a class="anchor" aria-label="anchor" href="#%E4%B8%A4%E7%8B%AC%E7%AB%8B%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84wilcoxon%E7%AC%A6%E5%8F%B7%E7%A7%A9%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RD1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.78</span>,<span class="fl">3.23</span>,<span class="fl">4.20</span>,<span class="fl">4.87</span>,<span class="fl">5.12</span>,<span class="fl">6.21</span>,<span class="fl">7.18</span>,<span class="fl">8.05</span>,<span class="fl">8.56</span>,<span class="fl">9.60</span><span class="op">)</span></span>
<span><span class="va">RD2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.23</span>,<span class="fl">3.50</span>,<span class="fl">4.04</span>,<span class="fl">4.15</span>,<span class="fl">4.28</span>,<span class="fl">4.34</span>,<span class="fl">4.47</span>,<span class="fl">4.64</span>,<span class="fl">4.75</span>,<span class="fl">4.82</span>,<span class="fl">4.95</span>,<span class="fl">5.10</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">RD1</span>,<span class="va">RD2</span><span class="op">)</span>,group<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    22 obs. of  2 variables:</span></span>
<span><span class="co">##  $ y    : num  2.78 3.23 4.2 4.87 5.12 6.21 7.18 8.05 8.56 9.6 ...</span></span>
<span><span class="co">##  $ group: Factor w/ 2 levels "1","2": 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">RD1</span>,<span class="va">RD2</span>,paired <span class="op">=</span> <span class="cn">F</span>, correct <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Wilcoxon rank sum test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  RD1 and RD2</span></span>
<span><span class="co">## W = 86.5, p-value = 0.08049</span></span>
<span><span class="co">## alternative hypothesis: true location shift is not equal to 0</span></span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/wilcox_test.html">wilcox_test</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 7</span></span>
<span><span class="co">##   .y.   group1 group2    n1    n2 statistic      p</span></span>
<span><span class="co">## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">## 1 y     1      2         10    12      86.5 0.0864</span></span></code></pre></div>
</div>
<div id="完全随机设计多个样本比较的-kruskal-wallis-h-检验-1" class="section level3" number="13.7.3">
<h3>
<span class="header-section-number">13.7.3</span> 完全随机设计多个样本比较的 Kruskal-Wallis H 检验<a class="anchor" aria-label="anchor" href="#%E5%AE%8C%E5%85%A8%E9%9A%8F%E6%9C%BA%E8%AE%BE%E8%AE%A1%E5%A4%9A%E4%B8%AA%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84-kruskal-wallis-h-%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">death_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">32.5</span>,<span class="fl">35.5</span>,<span class="fl">40.5</span>,<span class="fl">46</span>,<span class="fl">49</span>,<span class="fl">16</span>,<span class="fl">20.5</span>,<span class="fl">22.5</span>,<span class="fl">29</span>,<span class="fl">36</span>,<span class="fl">6.5</span>,</span>
<span>                <span class="fl">9.0</span>,<span class="fl">12.5</span>,<span class="fl">18</span>,<span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">drug</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Drug_A"</span>,<span class="st">"drug_B"</span>,<span class="st">"drug_C"</span><span class="op">)</span>,each<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">death_rate</span>,<span class="va">drug</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    15 obs. of  2 variables:</span></span>
<span><span class="co">##  $ death_rate: num  32.5 35.5 40.5 46 49 16 20.5 22.5 29 36 ...</span></span>
<span><span class="co">##  $ drug      : chr  "Drug_A" "Drug_A" "Drug_A" "Drug_A" ...</span></span></code></pre></div>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">death_rate</span> <span class="op">~</span> <span class="va">drug</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Kruskal-Wallis rank sum test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  death_rate by drug</span></span>
<span><span class="co">## Kruskal-Wallis chi-squared = 9.74, df = 2, p-value = 0.007673</span></span></code></pre></div>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/kruskal_test.html">kruskal_test</a></span><span class="op">(</span><span class="va">death_rate</span> <span class="op">~</span> <span class="va">drug</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 6</span></span>
<span><span class="co">##   .y.            n statistic    df       p method        </span></span>
<span><span class="co">## * &lt;chr&gt;      &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;         </span></span>
<span><span class="co">## 1 death_rate    15      9.74     2 0.00767 Kruskal-Wallis</span></span></code></pre></div>
</div>
<div id="随记区组设计多个样本比较的-friedman-m-检验-1" class="section level3" number="13.7.4">
<h3>
<span class="header-section-number">13.7.4</span> 随记区组设计多个样本比较的 Friedman M 检验<a class="anchor" aria-label="anchor" href="#%E9%9A%8F%E8%AE%B0%E5%8C%BA%E7%BB%84%E8%AE%BE%E8%AE%A1%E5%A4%9A%E4%B8%AA%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84-friedman-m-%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
</div>
</div>
<div id="卡方检验" class="section level2" number="13.8">
<h2>
<span class="header-section-number">13.8</span> 卡方检验<a class="anchor" aria-label="anchor" href="#%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C"><i class="fas fa-link"></i></a>
</h2>
<div id="四格表资料的卡方检验-1" class="section level3" number="13.8.1">
<h3>
<span class="header-section-number">13.8.1</span> 四格表资料的卡方检验<a class="anchor" aria-label="anchor" href="#%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99%E7%9A%84%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ID</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">treat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"treated"</span>,<span class="fl">104</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"placebo"</span>,<span class="fl">96</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">treat</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">treat</span><span class="op">)</span></span>
<span><span class="va">impro</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"marked"</span>,<span class="fl">99</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"marked"</span>,<span class="fl">75</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"none"</span>,<span class="fl">21</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">impro</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">impro</span><span class="op">)</span></span>
<span><span class="va">data1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ID</span>,<span class="va">treat</span>,<span class="va">impro</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">data1</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    200 obs. of  3 variables:</span></span>
<span><span class="co">##  $ ID   : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ treat: Factor w/ 2 levels "placebo","treated": 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">##  $ impro: Factor w/ 2 levels "marked","none": 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gmodels</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gmodels/man/CrossTable.html">CrossTable</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">treat</span>, <span class="va">data1</span><span class="op">$</span><span class="va">impro</span>, digits <span class="op">=</span> <span class="fl">4</span>, </span>
<span>           expected <span class="op">=</span> <span class="cn">T</span>, chisq <span class="op">=</span> <span class="cn">T</span>, fisher <span class="op">=</span> <span class="cn">T</span>, mcnemar <span class="op">=</span> <span class="cn">T</span>, </span>
<span>           format <span class="op">=</span> <span class="st">"SPSS"</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Cell Contents</span></span>
<span><span class="co">## |-------------------------|</span></span>
<span><span class="co">## |                   Count |</span></span>
<span><span class="co">## |         Expected Values |</span></span>
<span><span class="co">## | Chi-square contribution |</span></span>
<span><span class="co">## |             Row Percent |</span></span>
<span><span class="co">## |          Column Percent |</span></span>
<span><span class="co">## |           Total Percent |</span></span>
<span><span class="co">## |-------------------------|</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Total Observations in Table:  200 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##              | data1$impro </span></span>
<span><span class="co">##  data1$treat |   marked  |     none  | Row Total | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|</span></span>
<span><span class="co">##      placebo |       75  |       21  |       96  | </span></span>
<span><span class="co">##              |  83.5200  |  12.4800  |           | </span></span>
<span><span class="co">##              |   0.8691  |   5.8165  |           | </span></span>
<span><span class="co">##              |  78.1250% |  21.8750% |  48.0000% | </span></span>
<span><span class="co">##              |  43.1034% |  80.7692% |           | </span></span>
<span><span class="co">##              |  37.5000% |  10.5000% |           | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|</span></span>
<span><span class="co">##      treated |       99  |        5  |      104  | </span></span>
<span><span class="co">##              |  90.4800  |  13.5200  |           | </span></span>
<span><span class="co">##              |   0.8023  |   5.3691  |           | </span></span>
<span><span class="co">##              |  95.1923% |   4.8077% |  52.0000% | </span></span>
<span><span class="co">##              |  56.8966% |  19.2308% |           | </span></span>
<span><span class="co">##              |  49.5000% |   2.5000% |           | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|</span></span>
<span><span class="co">## Column Total |      174  |       26  |      200  | </span></span>
<span><span class="co">##              |  87.0000% |  13.0000% |           | </span></span>
<span><span class="co">## -------------|-----------|-----------|-----------|</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Statistics for All Table Factors</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Pearson's Chi-squared test </span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## Chi^2 =  12.85707     d.f. =  1     p =  0.0003362066 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Pearson's Chi-squared test with Yates' continuity correction </span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## Chi^2 =  11.3923     d.f. =  1     p =  0.0007374901 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## McNemar's Chi-squared test </span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## Chi^2 =  50.7     d.f. =  1     p =  1.076196e-12 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## McNemar's Chi-squared test with continuity correction </span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## Chi^2 =  49.40833     d.f. =  1     p =  2.078608e-12 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">## Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## ------------------------------------------------------------</span></span>
<span><span class="co">## Sample estimate odds ratio:  0.1818332 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">## p =  0.0005286933 </span></span>
<span><span class="co">## 95% confidence interval:  0.05117986 0.5256375 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Alternative hypothesis: true odds ratio is less than 1</span></span>
<span><span class="co">## p =  0.0002823226 </span></span>
<span><span class="co">## 95% confidence interval:  0 0.4569031 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Alternative hypothesis: true odds ratio is greater than 1</span></span>
<span><span class="co">## p =  0.9999541 </span></span>
<span><span class="co">## 95% confidence interval:  0.06281418 Inf </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  </span></span>
<span><span class="co">##        Minimum expected frequency: 12.48</span></span></code></pre></div>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/chisq_test.html">chisq_test</a></span><span class="op">(</span><span class="va">treat</span>, <span class="va">impro</span>,correct <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 6</span></span>
<span><span class="co">##       n statistic        p    df method          p.signif</span></span>
<span><span class="co">## * &lt;int&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;chr&gt;   </span></span>
<span><span class="co">## 1   200      12.9 0.000336     1 Chi-square test ***</span></span></code></pre></div>
</div>
<div id="配对四格表资料" class="section level3" number="13.8.2">
<h3>
<span class="header-section-number">13.8.2</span> 配对四格表资料<a class="anchor" aria-label="anchor" href="#%E9%85%8D%E5%AF%B9%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ana</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">33</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span>,</span>
<span>              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>免疫荧光 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"阳性"</span>,<span class="st">"阴性"</span><span class="op">)</span>,</span>
<span>                              乳胶凝集 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"阳性"</span>,<span class="st">"阴性"</span><span class="op">)</span></span>
<span>                              <span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span></span>
<span><span class="va">ana</span></span>
<span><span class="co">##         乳胶凝集</span></span>
<span><span class="co">## 免疫荧光 阳性 阴性</span></span>
<span><span class="co">##     阳性   11   12</span></span>
<span><span class="co">##     阴性    2   33</span></span></code></pre></div>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/mcnemar.test.html">mcnemar.test</a></span><span class="op">(</span><span class="va">ana</span>, correct <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  McNemar's Chi-squared test with continuity correction</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  ana</span></span>
<span><span class="co">## McNemar's chi-squared = 5.7857, df = 1, p-value = 0.01616</span></span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/mcnemar_test.html">mcnemar_test</a></span><span class="op">(</span><span class="va">ana</span>, correct <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 6</span></span>
<span><span class="co">##       n statistic    df      p p.signif method      </span></span>
<span><span class="co">## * &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;       </span></span>
<span><span class="co">## 1    58      5.79     1 0.0162 *        McNemar test</span></span></code></pre></div>
</div>
<div id="四格表资料的-fisher-确切概率法-1" class="section level3" number="13.8.3">
<h3>
<span class="header-section-number">13.8.3</span> 四格表资料的 Fisher 确切概率法<a class="anchor" aria-label="anchor" href="#%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99%E7%9A%84-fisher-%E7%A1%AE%E5%88%87%E6%A6%82%E7%8E%87%E6%B3%95-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hbv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">18</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span>,</span>
<span>              dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>组别 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"预防注射组"</span>,<span class="st">"非预防组"</span><span class="op">)</span>,</span>
<span>                              效果 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"阳性"</span>,<span class="st">"阴性"</span><span class="op">)</span></span>
<span>                              <span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span><span class="va">hbv</span></span>
<span><span class="co">##             效果</span></span>
<span><span class="co">## 组别       阳性 阴性</span></span>
<span><span class="co">##   预防注射组    4   18</span></span>
<span><span class="co">##   非预防组      5    6</span></span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">hbv</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  hbv</span></span>
<span><span class="co">## p-value = 0.121</span></span>
<span><span class="co">## alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.03974151 1.76726409</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## odds ratio </span></span>
<span><span class="co">##  0.2791061</span></span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/fisher_test.html">fisher_test</a></span><span class="op">(</span><span class="va">hbv</span>,detailed <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 8</span></span>
<span><span class="co">##       n estimate     p conf.low conf.high method            alternative p.signif</span></span>
<span><span class="co">## * &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;             &lt;chr&gt;       &lt;chr&gt;   </span></span>
<span><span class="co">## 1    33    0.279 0.121   0.0397      1.77 Fisher's Exact t… two.sided   ns</span></span></code></pre></div>
</div>
<div id="卡方拟合优度检验" class="section level3" number="13.8.4">
<h3>
<span class="header-section-number">13.8.4</span> 卡方拟合优度检验<a class="anchor" aria-label="anchor" href="#%E5%8D%A1%E6%96%B9%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6%E6%A3%80%E9%AA%8C"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">26</span>,<span class="fl">51</span>,<span class="fl">75</span>,<span class="fl">63</span>,<span class="fl">38</span>,<span class="fl">17</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0854</span>,<span class="fl">0.2102</span>,<span class="fl">0.2585</span>,<span class="fl">0.2120</span>,<span class="fl">0.1304</span>,<span class="fl">0.0641</span>,<span class="fl">0.0394</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, p <span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Chi-squared test for given probabilities</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  x</span></span>
<span><span class="co">## X-squared = 2.0377, df = 6, p-value = 0.9162</span></span></code></pre></div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/rstatix/reference/chisq_test.html">chisq_test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>,p<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 1 × 6</span></span>
<span><span class="co">##       n statistic     p    df method          p.signif</span></span>
<span><span class="co">## * &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;           &lt;chr&gt;   </span></span>
<span><span class="co">## 1     7      2.04 0.916     6 Chi-square test ns</span></span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="ytsgs.html"><span class="header-section-number">12</span> 随机分组</a></div>
<div class="next"><a href="tjslrkjga.html"><span class="header-section-number">14</span> R语言多个变量同时进行t检验</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#yaiehfkjasd"><span class="header-section-number">13</span> R语言tidy风格医学统计学</a></li>
<li>
<a class="nav-link" href="#%E4%B8%BB%E8%A6%81%E5%87%BD%E6%95%B0"><span class="header-section-number">13.1</span> 主要函数</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1"><span class="header-section-number">13.1.1</span> 描述性统计</a></li>
<li><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E5%9D%87%E5%80%BC"><span class="header-section-number">13.1.2</span> 比较均值</a></li>
<li><a class="nav-link" href="#%E5%A2%9E%E5%BC%BAr%E4%B8%AD%E7%9A%84anova"><span class="header-section-number">13.1.3</span> 增强R中的ANOVA</a></li>
<li><a class="nav-link" href="#%E4%BA%8B%E5%90%8E%E6%A3%80%E9%AA%8Cpost-hoc"><span class="header-section-number">13.1.4</span> 事后检验（post-hoc）</a></li>
<li><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E6%AF%94%E4%BE%8B"><span class="header-section-number">13.1.5</span> 比较比例</a></li>
<li><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E6%96%B9%E5%B7%AE"><span class="header-section-number">13.1.6</span> 比较方差</a></li>
<li><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%95%88%E5%BA%94%E9%87%8F"><span class="header-section-number">13.1.7</span> 计算效应量</a></li>
<li><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E6%80%A7%E5%88%86%E6%9E%90"><span class="header-section-number">13.1.8</span> 相关性分析</a></li>
<li><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0p%E5%80%BC%E5%92%8C%E6%98%BE%E8%91%97%E6%80%A7%E6%A0%87%E8%AE%B0"><span class="header-section-number">13.1.9</span> 添加P值和显著性标记</a></li>
<li><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF"><span class="header-section-number">13.1.10</span> 提取统计信息</a></li>
<li><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="header-section-number">13.1.11</span> 数据处理辅助函数</a></li>
<li><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="header-section-number">13.1.12</span> 其他</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E5%8A%A0%E8%BD%BD"><span class="header-section-number">13.2</span> 安装和加载</a></li>
<li><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1-1"><span class="header-section-number">13.3</span> 描述性统计</a></li>
<li>
<a class="nav-link" href="#t%E6%A3%80%E9%AA%8C"><span class="header-section-number">13.4</span> t检验</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%8D%95%E6%A0%B7%E6%9C%ACt%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.4.1</span> 单样本t检验</a></li>
<li><a class="nav-link" href="#%E9%85%8D%E5%AF%B9t%E6%A3%80%E9%AA%8C"><span class="header-section-number">13.4.2</span> 配对t检验</a></li>
<li><a class="nav-link" href="#%E4%B8%A4%E6%A0%B7%E6%9C%ACt%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.4.3</span> 两样本t检验</a></li>
<li><a class="nav-link" href="#%E5%88%86%E7%BB%84%E5%90%8E%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83"><span class="header-section-number">13.4.4</span> 分组后进行比较</a></li>
<li><a class="nav-link" href="#%E5%A4%9A%E7%BB%84%E9%97%B4%E7%9A%84%E4%B8%A4%E4%B8%A4%E6%AF%94%E8%BE%83"><span class="header-section-number">13.4.5</span> 多组间的两两比较</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="header-section-number">13.5</span> 方差分析</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E9%9A%8F%E6%9C%BA%E8%AE%BE%E8%AE%A1%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="header-section-number">13.5.1</span> 完全随机设计方差分析</a></li>
<li><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%8C%BA%E7%BB%84%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.2</span> 随机区组设计资料的方差分析</a></li>
<li><a class="nav-link" href="#%E6%8B%89%E4%B8%81%E6%96%B9%E8%AE%BE%E8%AE%A1%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.3</span> 拉丁方设计方差分析</a></li>
<li><a class="nav-link" href="#%E4%B8%A4%E9%98%B6%E6%AE%B5%E4%BA%A4%E5%8F%89%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.4</span> 两阶段交叉设计资料方差分析</a></li>
<li><a class="nav-link" href="#%E6%9E%90%E5%9B%A0%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90"><span class="header-section-number">13.5.5</span> 析因设计资料的方差分析</a></li>
<li><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E8%AE%BE%E8%AE%A1%E8%B5%84%E6%96%99%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.6</span> 正交设计资料的方差分析</a></li>
<li><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%95%B0%E6%8D%AE%E4%B8%A4%E5%9B%A0%E7%B4%A0%E4%B8%A4%E6%B0%B4%E5%B9%B3%E7%9A%84%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.7</span> 重复测量数据两因素两水平的方差分析</a></li>
<li><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E6%B5%8B%E9%87%8F%E6%95%B0%E6%8D%AE%E4%B8%A4%E5%9B%A0%E7%B4%A0%E5%A4%9A%E6%B0%B4%E5%B9%B3%E7%9A%84%E5%88%86%E6%9E%90-1"><span class="header-section-number">13.5.8</span> 重复测量数据两因素多水平的分析</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E5%88%86%E6%9E%90"><span class="header-section-number">13.6</span> 相关分析</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E4%B8%A4%E4%B8%AA%E5%8F%98%E9%87%8F"><span class="header-section-number">13.6.1</span> 两个变量</a></li>
<li><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F%E5%92%8C%E5%85%B6%E4%BB%96%E6%89%80%E6%9C%89%E5%8F%98%E9%87%8F"><span class="header-section-number">13.6.2</span> 一个变量和其他所有变量</a></li>
<li><a class="nav-link" href="#%E6%89%80%E6%9C%89%E5%8F%98%E9%87%8F%E9%97%B4%E4%B8%A4%E4%B8%A4%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="header-section-number">13.6.3</span> 所有变量间两两相关性</a></li>
<li><a class="nav-link" href="#%E7%9B%B8%E5%85%B3%E7%9F%A9%E9%98%B5"><span class="header-section-number">13.6.4</span> 相关矩阵</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%E7%A7%A9%E5%92%8C%E6%A3%80%E9%AA%8C"><span class="header-section-number">13.7</span> 秩和检验</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E9%85%8D%E5%AF%B9%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84wilcoxon%E7%AC%A6%E5%8F%B7%E7%A7%A9%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.7.1</span> 配对样本比较的Wilcoxon符号秩检验</a></li>
<li><a class="nav-link" href="#%E4%B8%A4%E7%8B%AC%E7%AB%8B%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84wilcoxon%E7%AC%A6%E5%8F%B7%E7%A7%A9%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.7.2</span> 两独立样本比较的Wilcoxon符号秩检验</a></li>
<li><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E9%9A%8F%E6%9C%BA%E8%AE%BE%E8%AE%A1%E5%A4%9A%E4%B8%AA%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84-kruskal-wallis-h-%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.7.3</span> 完全随机设计多个样本比较的 Kruskal-Wallis H 检验</a></li>
<li><a class="nav-link" href="#%E9%9A%8F%E8%AE%B0%E5%8C%BA%E7%BB%84%E8%AE%BE%E8%AE%A1%E5%A4%9A%E4%B8%AA%E6%A0%B7%E6%9C%AC%E6%AF%94%E8%BE%83%E7%9A%84-friedman-m-%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.7.4</span> 随记区组设计多个样本比较的 Friedman M 检验</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C"><span class="header-section-number">13.8</span> 卡方检验</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99%E7%9A%84%E5%8D%A1%E6%96%B9%E6%A3%80%E9%AA%8C-1"><span class="header-section-number">13.8.1</span> 四格表资料的卡方检验</a></li>
<li><a class="nav-link" href="#%E9%85%8D%E5%AF%B9%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99"><span class="header-section-number">13.8.2</span> 配对四格表资料</a></li>
<li><a class="nav-link" href="#%E5%9B%9B%E6%A0%BC%E8%A1%A8%E8%B5%84%E6%96%99%E7%9A%84-fisher-%E7%A1%AE%E5%88%87%E6%A6%82%E7%8E%87%E6%B3%95-1"><span class="header-section-number">13.8.3</span> 四格表资料的 Fisher 确切概率法</a></li>
<li><a class="nav-link" href="#%E5%8D%A1%E6%96%B9%E6%8B%9F%E5%90%88%E4%BC%98%E5%BA%A6%E6%A3%80%E9%AA%8C"><span class="header-section-number">13.8.4</span> 卡方拟合优度检验</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/ayueme/ayueme.github.io/blob/main/1013-rstastix.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/ayueme/ayueme.github.io/edit/main/1013-rstastix.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R语言实战医学统计</strong>" was written by 阿越就是我. It was last built on 2023-09-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
