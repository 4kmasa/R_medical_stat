<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>18 Logistic回归 | R语言实战医学统计</title>
<meta name="author" content="阿越就是我">
<meta name="description" content="18.1 二项logistic回归 R语言中的factor()函数可以把变量变为因子类型，默认是没有等级之分的（可以理解为无序分类变量nominal）！当然也可以通过添加参数ordered=T变成有序因子（等级资料，有序分类ordinal）。 因变量是二分类变量时，可以使用二项逻辑回归（binomial logistic...">
<meta name="generator" content="bookdown 0.33 with bs4_book()">
<meta property="og:title" content="18 Logistic回归 | R语言实战医学统计">
<meta property="og:type" content="book">
<meta property="og:description" content="18.1 二项logistic回归 R语言中的factor()函数可以把变量变为因子类型，默认是没有等级之分的（可以理解为无序分类变量nominal）！当然也可以通过添加参数ordered=T变成有序因子（等级资料，有序分类ordinal）。 因变量是二分类变量时，可以使用二项逻辑回归（binomial logistic...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="18 Logistic回归 | R语言实战医学统计">
<meta name="twitter:description" content="18.1 二项logistic回归 R语言中的factor()函数可以把变量变为因子类型，默认是没有等级之分的（可以理解为无序分类变量nominal）！当然也可以通过添加参数ordered=T变成有序因子（等级资料，有序分类ordinal）。 因变量是二分类变量时，可以使用二项逻辑回归（binomial logistic...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="bs4_style.css">
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">R语言实战医学统计</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">前言</a></li>
<li class="book-part">基础统计分析</li>
<li><a class="" href="sdjfl.html"><span class="header-section-number">1</span> t检验</a></li>
<li><a class="" href="xnclg.html"><span class="header-section-number">2</span> 多样本均数比较的方差分析</a></li>
<li><a class="" href="njlkga.html"><span class="header-section-number">3</span> 多因素方差分析</a></li>
<li><a class="" href="iegljgk.html"><span class="header-section-number">4</span> 重复测量方差分析</a></li>
<li><a class="" href="lasijdlfjd.html"><span class="header-section-number">5</span> 协方差分析</a></li>
<li><a class="" href="aspljsffjd.html"><span class="header-section-number">6</span> 卡方检验</a></li>
<li><a class="" href="lidukj.html"><span class="header-section-number">7</span> 秩和检验</a></li>
<li><a class="" href="yruugkjh.html"><span class="header-section-number">8</span> 球对称检验</a></li>
<li><a class="" href="rugnjkdfgl.html"><span class="header-section-number">9</span> R语言Cochran Armitage检验</a></li>
<li><a class="" href="ytlrwijj.html"><span class="header-section-number">10</span> R语言方差分析注意事项</a></li>
<li><a class="" href="terlajskd.html"><span class="header-section-number">11</span> 样本量计算</a></li>
<li><a class="" href="ytsgs.html"><span class="header-section-number">12</span> 随机分组</a></li>
<li><a class="" href="yaiehfkjasd.html"><span class="header-section-number">13</span> R语言tidy风格医学统计学</a></li>
<li><a class="" href="tjslrkjga.html"><span class="header-section-number">14</span> R语言多个变量同时进行t检验</a></li>
<li><a class="" href="oirjglsj.html"><span class="header-section-number">15</span> 双变量回归与相关</a></li>
<li><a class="" href="jhgkjahdj.html"><span class="header-section-number">16</span> 偏相关和典型相关</a></li>
<li class="book-part">高级统计分析</li>
<li><a class="" href="raljflksdj.html"><span class="header-section-number">17</span> 多元线性回归</a></li>
<li><a class="active" href="rlkdfjj.html"><span class="header-section-number">18</span> Logistic回归</a></li>
<li><a class="" href="tuishgh.html"><span class="header-section-number">19</span> 分类变量进行回归分析时的编码方案</a></li>
<li><a class="" href="erutgjdflk.html"><span class="header-section-number">20</span> R语言判别分析</a></li>
<li><a class="" href="lksdjgljdsl.html"><span class="header-section-number">21</span> R语言聚类分析</a></li>
<li><a class="" href="ejtlj.html"><span class="header-section-number">22</span> R语言主成分分析</a></li>
<li><a class="" href="iurgsdh.html"><span class="header-section-number">23</span> R语言因子分析</a></li>
<li><a class="" href="ljhgjsj.html"><span class="header-section-number">24</span> 二分类资料ROC曲线绘制</a></li>
<li><a class="" href="xlkjgj.html"><span class="header-section-number">25</span> 生存资料ROC曲线绘制</a></li>
<li><a class="" href="lsjdglj.html"><span class="header-section-number">26</span> 生存资料ROC曲线的最佳截点和平滑曲线</a></li>
<li><a class="" href="oljgja.html"><span class="header-section-number">27</span> ROC曲线的显著性检验</a></li>
<li><a class="" href="uxijsjg.html"><span class="header-section-number">28</span> ROC阴性结果还是阳性结果</a></li>
<li><a class="" href="yrlhksdg.html"><span class="header-section-number">29</span> ROC曲线ggplot2绘制</a></li>
<li><a class="" href="sjgjaklj.html"><span class="header-section-number">30</span> R语言计算AUC(ROC)注意事项</a></li>
<li><a class="" href="oljgji.html"><span class="header-section-number">31</span> 多指标联合诊断的ROC曲线</a></li>
<li><a class="" href="djgkas.html"><span class="header-section-number">32</span> R语言生存分析</a></li>
<li><a class="" href="oiewjrtsjl.html"><span class="header-section-number">33</span> R语言超详细的生存曲线可视化</a></li>
<li class="book-part">文献中常用的统计方法</li>
<li><a class="" href="lxjjgjja.html"><span class="header-section-number">34</span> Fine-Gray检验、竞争风险模型列线图绘制</a></li>
<li><a class="" href="ysdkfjhsjk.html"><span class="header-section-number">35</span> R语言倾向性评分：匹配</a></li>
<li><a class="" href="yxkskjhfk.html"><span class="header-section-number">36</span> R语言倾向性评分：回归和分层</a></li>
<li><a class="" href="yplksjhfk.html"><span class="header-section-number">37</span> R语言倾向性评分：加权</a></li>
<li><a class="" href="qdkjfgj.html"><span class="header-section-number">38</span> p for trend/ p for interaction/ per 1 sd 的R语言实现</a></li>
<li><a class="" href="jddsfsdf.html"><span class="header-section-number">39</span> R语言多项式拟合及样条回归</a></li>
<li><a class="" href="subgroupanalysis.html"><span class="header-section-number">40</span> R语言亚组分析及森林图绘制</a></li>
<li class="book-part">附录</li>
<li class="book-part">附录</li>
<li><a class="" href="jdkhfgjad.html"><span class="header-section-number">A</span> 软件安装和其他合集</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/ayueme/ayueme.github.io">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="rlkdfjj" class="section level1" number="18">
<h1>
<span class="header-section-number">18</span> Logistic回归<a class="anchor" aria-label="anchor" href="#rlkdfjj"><i class="fas fa-link"></i></a>
</h1>
<div id="二项logistic回归" class="section level2" number="18.1">
<h2>
<span class="header-section-number">18.1</span> 二项logistic回归<a class="anchor" aria-label="anchor" href="#%E4%BA%8C%E9%A1%B9logistic%E5%9B%9E%E5%BD%92"><i class="fas fa-link"></i></a>
</h2>
<p>R语言中的<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>函数可以把变量变为因子类型，默认是没有等级之分的（可以理解为无序分类变量nominal）！当然也可以通过添加参数<code>ordered=T</code>变成有序因子（等级资料，有序分类ordinal）。</p>
<p>因变量是二分类变量时，可以使用二项逻辑回归（binomial logistic regression），自变量可以是数值变量、无序多分类变量、有序多分类变量。</p>
<p>本次数据使用孙振球版《医学统计学》第4版<strong>例16-2</strong>的数据，直接读取。</p>
<p>为了探讨冠心病发生的危险因素，对26例冠心病患者和28例对照者进行病例-对照研究，试用逻辑回归筛选危险因素。</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df16_2</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">"datasets/例16-02.sav"</span>, </span>
<span>                             to.data.frame <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                             use.value.labels <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                             reencode  <span class="op">=</span> <span class="st">"utf-8"</span><span class="op">)</span></span>
<span><span class="co">## re-encoding from utf-8</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df16_2</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    54 obs. of  11 variables:</span></span>
<span><span class="co">##  $ .... : num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ x1   : num  3 2 2 2 3 3 2 3 2 1 ...</span></span>
<span><span class="co">##  $ x2   : num  1 0 1 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ x3   : num  0 1 0 0 0 1 1 1 0 0 ...</span></span>
<span><span class="co">##  $ x4   : num  1 1 1 1 1 1 0 1 0 1 ...</span></span>
<span><span class="co">##  $ x5   : num  0 0 0 0 0 0 0 1 0 0 ...</span></span>
<span><span class="co">##  $ x6   : num  0 0 0 0 1 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ x7   : num  1 1 1 1 1 2 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x8   : num  1 0 0 0 1 1 0 0 1 0 ...</span></span>
<span><span class="co">##  $ y    : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">##  $ PGR_1: num  1 0 0 0 1 1 0 0 0 0 ...</span></span>
<span><span class="co">##  - attr(*, "variable.labels")= Named chr [1:11] "" "" "" "" ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:11] "...." "x1" "x2" "x3" ...</span></span></code></pre></div>
<p>数据一共11列，第1列是编号，第2-9列是自变量，第10列是因变量。</p>
<p>具体说明：
- x1：年龄，小于45岁是1,45-55是2,55-65是3,65以上是4；
- x2：高血压病史，1代表有，0代表无；
- x3：高血压家族史，1代表有，0代表无；
- x4：吸烟，1代表吸烟，0代表不吸烟；
- x5：高血脂病史，1代表有，0代表无；
- x6：动物脂肪摄入，0表示低，1表示高
- x7：BMI，小于24是1,24-26是2，大于26是3；
- x8：A型性格，1代表是，0代表否；
- y：是否是冠心病，1代表是，0代表否</p>
<p><em>这里的<code>x1~y</code>虽然是数值型，但并不是真的代表数字大小，只是为了方便标识</em>，进行了转换，因此在进行logistic回归之前，我们要把数值型变量变成无序分类或有序分类变量，在R语言中可以通过<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>函数变成因子型实现。</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 变成因子型</span></span>
<span><span class="va">df16_2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">df16_2</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span>, <span class="va">factor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df16_2</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    54 obs. of  11 variables:</span></span>
<span><span class="co">##  $ .... : num  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">##  $ x1   : Factor w/ 4 levels "1","2","3","4": 3 2 2 2 3 3 2 3 2 1 ...</span></span>
<span><span class="co">##  $ x2   : Factor w/ 2 levels "0","1": 2 1 2 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x3   : Factor w/ 2 levels "0","1": 1 2 1 1 1 2 2 2 1 1 ...</span></span>
<span><span class="co">##  $ x4   : Factor w/ 2 levels "0","1": 2 2 2 2 2 2 1 2 1 2 ...</span></span>
<span><span class="co">##  $ x5   : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 2 1 1 ...</span></span>
<span><span class="co">##  $ x6   : Factor w/ 2 levels "0","1": 1 1 1 1 2 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x7   : Factor w/ 3 levels "1","2","3": 1 1 1 1 1 2 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x8   : Factor w/ 2 levels "0","1": 2 1 1 1 2 2 1 1 2 1 ...</span></span>
<span><span class="co">##  $ y    : Factor w/ 2 levels "0","1": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ PGR_1: num  1 0 0 0 1 1 0 0 0 0 ...</span></span>
<span><span class="co">##  - attr(*, "variable.labels")= Named chr [1:11] "" "" "" "" ...</span></span>
<span><span class="co">##   ..- attr(*, "names")= chr [1:11] "...." "x1" "x2" "x3" ...</span></span></code></pre></div>
<p>需要注意的是自变量x1和x7，这两个应该是有序分类变量，这种自变量在进行逻辑回归时，可以进行哑变量设置，即给定一个参考，让其他所有组都和参考相比，比如这里，我们把x1变成因子型后，R语言在进行logistic回归时，会默认选择第一个为参考。</p>
<p>接下来进行二项逻辑回归，<strong>在R语言中，默认是以因子的第一个为参考的，不仅是自变量，因变量也是如此！</strong> 和SPSS的默认方式不太一样。</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span> <span class="op">+</span> <span class="va">x5</span> <span class="op">+</span> <span class="va">x6</span> <span class="op">+</span> <span class="va">x7</span> <span class="op">+</span> <span class="va">x8</span>, </span>
<span>         data <span class="op">=</span> <span class="va">df16_2</span>, </span>
<span>         family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8, family = binomial(), </span></span>
<span><span class="co">##     data = df16_2)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">## -2.1727  -0.4719  -0.1409   0.5315   2.5914  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">## (Intercept) -5.46026    2.07370  -2.633  0.00846 **</span></span>
<span><span class="co">## x12          0.85285    1.54399   0.552  0.58070   </span></span>
<span><span class="co">## x13          0.47754    1.59320   0.300  0.76438   </span></span>
<span><span class="co">## x14          3.44227    2.10985   1.632  0.10278   </span></span>
<span><span class="co">## x21          1.14905    0.93176   1.233  0.21750   </span></span>
<span><span class="co">## x31          1.66039    1.16857   1.421  0.15535   </span></span>
<span><span class="co">## x41          0.85994    1.32437   0.649  0.51613   </span></span>
<span><span class="co">## x51          0.73600    0.97088   0.758  0.44840   </span></span>
<span><span class="co">## x61          3.92067    1.57004   2.497  0.01252 * </span></span>
<span><span class="co">## x72         -0.03467    1.13363  -0.031  0.97560   </span></span>
<span><span class="co">## x73         -0.38230    1.61710  -0.236  0.81311   </span></span>
<span><span class="co">## x81          2.46322    1.10484   2.229  0.02578 * </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 74.786  on 53  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 40.028  on 42  degrees of freedom</span></span>
<span><span class="co">## AIC: 64.028</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 6</span></span></code></pre></div>
<p><strong>结果详解：</strong></p>
<p><code>Deviance Residuals</code>:表示偏差残差统计量。在理想情况下应服从正态分布，均值应为0。</p>
<p>在此例中，中位数的符号为负（-0.01406），表明整体向左偏移，中位数的大小表明偏移的程度。第一个四分位数（1Q）和第三个四分位数（3Q）为两侧“尾巴”分布的幅度。这里3Q大于1Q（绝对值），表明这个曲线是向右倾斜的。最大和最小残差可用来检验数据中的离群值。</p>
<p>结果中<code>Estimate</code>是回归系数和截距，<code>Std. Error</code>表示回归系数的标准误，<code>z value</code>是统计量值（z的平方就是Wald值），<code>Pr(&gt;|z|)</code>是P值。</p>
<p>β值（这里就是Estimate）是指回归系数和截距（常数项），可以是负数（负相关时回归系数出现负值）；</p>
<p>OR是比值比（odds ratio），OR = exp(β)，其取值范围是0至正无穷，不可能是负数；</p>
<p>Wald是一个卡方值，等于β除以它的标准误（这里是Std. Error），然后取平方（也就是z值的平方），因此也不可能是负数。Wald用于对β值进行检验，考察β值是否等于0。若β值等于0，其对应的OR值，也就是Exp(β)为1，表明两组没有显著差异。Wald值越大，β值越不可能等于0。</p>
<p>结果中出现了<code>x12/x13/x14</code>这种，这是因为R语言在做回归时，如果设置了哑变量，默认是以第一个为参考的，其余都是和第一个进行比较，这也是R中自动进行哑变量编码的方式。</p>
<p><code>Null deviance</code>:无效偏差（零偏差），<code>Residual deviance</code>:残差偏差，无效偏差和残差偏差之间的差异越大越好，用来评价模型与实际数据的吻合情况。</p>
<p>AIC：赤池信息准则，表示模型拟合程度的好坏，AIC越低表示模型拟合越好。</p>
<p>最后还有一个Fisher Scoring的迭代次数，这个和最大似然函数的计算有关。</p>
<p>我们可以通过函数的方式分别获取模型信息。</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># β值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## (Intercept)         x12         x13         x14         x21         x31 </span></span>
<span><span class="co">## -5.46025547  0.85285212  0.47754497  3.44227124  1.14905003  1.66039360 </span></span>
<span><span class="co">##         x41         x51         x61         x72         x73         x81 </span></span>
<span><span class="co">##  0.85994185  0.73600239  3.92067487 -0.03467497 -0.38230011  2.46321944</span></span>
<span></span>
<span><span class="co"># β值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## (Intercept)         x12         x13         x14         x21         x31 </span></span>
<span><span class="co">## -5.46025547  0.85285212  0.47754497  3.44227124  1.14905003  1.66039360 </span></span>
<span><span class="co">##         x41         x51         x61         x72         x73         x81 </span></span>
<span><span class="co">##  0.85994185  0.73600239  3.92067487 -0.03467497 -0.38230011  2.46321944</span></span>
<span></span>
<span><span class="co"># β值的95%可信区间</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## Waiting for profiling to be done...</span></span>
<span><span class="co">##                   2.5 %    97.5 %</span></span>
<span><span class="co">## (Intercept) -10.3696980 -1.983104</span></span>
<span><span class="co">## x12          -2.0317236  4.405067</span></span>
<span><span class="co">## x13          -2.5429244  4.085370</span></span>
<span><span class="co">## x14          -0.2319302  8.343123</span></span>
<span><span class="co">## x21          -0.6458070  3.099838</span></span>
<span><span class="co">## x31          -0.5431686  4.205175</span></span>
<span><span class="co">## x41          -1.6713365  3.801261</span></span>
<span><span class="co">## x51          -1.1846658  2.725051</span></span>
<span><span class="co">## x61           1.3290533  7.677657</span></span>
<span><span class="co">## x72          -2.3618580  2.224863</span></span>
<span><span class="co">## x73          -3.8303437  2.725470</span></span>
<span><span class="co">## x81           0.5105394  4.997352</span></span>
<span></span>
<span><span class="co"># OR值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  (Intercept)          x12          x13          x14          x21          x31 </span></span>
<span><span class="co">##  0.004252469  2.346329320  1.612111759 31.257871683  3.155194147  5.261381340 </span></span>
<span><span class="co">##          x41          x51          x61          x72          x73          x81 </span></span>
<span><span class="co">##  2.363023282  2.087573511 50.434470096  0.965919321  0.682290259 11.742555242</span></span>
<span></span>
<span><span class="co"># OR值的95%的可信区间</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## Waiting for profiling to be done...</span></span>
<span><span class="co">##                    2.5 %       97.5 %</span></span>
<span><span class="co">## (Intercept) 3.136876e-05    0.1376413</span></span>
<span><span class="co">## x12         1.311093e-01   81.8646261</span></span>
<span><span class="co">## x13         7.863610e-02   59.4639513</span></span>
<span><span class="co">## x14         7.930015e-01 4201.1887167</span></span>
<span><span class="co">## x21         5.242393e-01   22.1943589</span></span>
<span><span class="co">## x31         5.809047e-01   67.0323349</span></span>
<span><span class="co">## x41         1.879956e-01   44.7576059</span></span>
<span><span class="co">## x51         3.058484e-01   15.2571993</span></span>
<span><span class="co">## x61         3.777465e+00 2159.5535363</span></span>
<span><span class="co">## x72         9.424495e-02    9.2522177</span></span>
<span><span class="co">## x73         2.170216e-02   15.2635868</span></span>
<span><span class="co">## x81         1.666190e+00  148.0206875</span></span></code></pre></div>
<p>这里x21的OR值是2.346329320，代表：45~55岁的人群患冠心病的风险是小于45岁人群的2.346329320倍，但是这个结果并没有统计学意义！</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Wald值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="co">## (Intercept)         x12         x13         x14         x21         x31 </span></span>
<span><span class="co">## 6.933188870 0.305111544 0.089843733 2.661883233 1.520790277 2.018903576 </span></span>
<span><span class="co">##         x41         x51         x61         x72         x73         x81 </span></span>
<span><span class="co">## 0.421615676 0.574682148 6.235929079 0.000935592 0.055890396 4.970577395</span></span>
<span></span>
<span><span class="co"># P值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">## (Intercept)         x12         x13         x14         x21         x31 </span></span>
<span><span class="co">##  0.00846107  0.58069555  0.76437591  0.10277898  0.21749994  0.15535128 </span></span>
<span><span class="co">##         x41         x51         x61         x72         x73         x81 </span></span>
<span><span class="co">##  0.51613195  0.44840433  0.01251839  0.97559855  0.81311338  0.02578204</span></span>
<span></span>
<span><span class="co"># 预测值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># 或者 predict(f,type = "response")</span></span>
<span><span class="co">##           1           2           3           4           5           6 </span></span>
<span><span class="co">## 0.375076515 0.110360122 0.069240725 0.023034427 0.905605901 0.491543165 </span></span>
<span><span class="co">##           7           8           9          10          11          12 </span></span>
<span><span class="co">## 0.049878030 0.151052146 0.104875967 0.009948712 0.208062753 0.046013662 </span></span>
<span><span class="co">##          13          14          15          16          17          18 </span></span>
<span><span class="co">## 0.009879122 0.497751927 0.500211100 0.074509703 0.023034427 0.105543397 </span></span>
<span><span class="co">##          19          20          21          22          23          24 </span></span>
<span><span class="co">## 0.359548891 0.441102099 0.048627400 0.734770361 0.366272916 0.009879122 </span></span>
<span><span class="co">##          25          26          27          28          29          30 </span></span>
<span><span class="co">## 0.049878030 0.366272916 0.009879122 0.101665098 0.995553588 0.950848767 </span></span>
<span><span class="co">##          31          32          33          34          35          36 </span></span>
<span><span class="co">## 0.712839656 0.995611072 0.216828996 0.984826081 0.543195397 0.905612594 </span></span>
<span><span class="co">##          37          38          39          40          41          42 </span></span>
<span><span class="co">## 0.868286980 0.993760333 0.868286980 0.034813473 0.902606657 0.966930037 </span></span>
<span><span class="co">##          43          44          45          46          47          48 </span></span>
<span><span class="co">## 0.375076515 0.964725296 0.840087511 0.818110300 0.881331876 0.676305952 </span></span>
<span><span class="co">##          49          50          51          52          53          54 </span></span>
<span><span class="co">## 0.780828686 0.555921773 0.986103872 0.816157300 0.466253375 0.655579178</span></span>
<span></span>
<span><span class="co"># 偏差</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/deviance.html">deviance</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## [1] 40.02758</span></span>
<span></span>
<span><span class="co"># 残差自由度</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co">## [1] 42</span></span>
<span></span>
<span><span class="co"># 伪R^2</span></span>
<span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/PseudoR2.html">PseudoR2</a></span><span class="op">(</span><span class="va">f</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"McFadden"</span>, <span class="st">"CoxSnell"</span>, <span class="st">"Nagelkerke"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##   McFadden   CoxSnell Nagelkerke </span></span>
<span><span class="co">##  0.4647704  0.4746397  0.6331426</span></span></code></pre></div>
<p>这里需要说明以下<code>fitted(f)</code>，也就是<code>predict(f,type = "response")</code>得到的结果是<em>预测概率</em>，范围是0-1之间的。</p>
<p>对于logistic回归来说，如果不使用<code>type</code>函数，默认是<code>type = "link"</code>，返回的是logit(P)的值。</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 默认返回logit(P)的值</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 返回概率</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">f</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<p>模型整体的假设检验：</p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 先构建一个只有截距的模型</span></span>
<span><span class="va">f0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df16_2</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 原模型和这个空模型进行比较</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">f0</span>,<span class="va">f</span>,test<span class="op">=</span><span class="st">"Chisq"</span><span class="op">)</span></span>
<span><span class="co">## Analysis of Deviance Table</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ 1</span></span>
<span><span class="co">## Model 2: y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8</span></span>
<span><span class="co">##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    </span></span>
<span><span class="co">## 1        53     74.786                          </span></span>
<span><span class="co">## 2        42     40.028 11   34.758 0.0002716 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>P&lt;0.001，说明我们的模型是有意义的。</p>
<p>逐步回归法的logistic回归，可以使用<code><a href="https://rdrr.io/r/stats/step.html">step()</a></code>函数：</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 向前</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span><span class="va">f</span>, direction <span class="op">=</span> <span class="st">"forward"</span><span class="op">)</span></span>
<span><span class="co">## Start:  AIC=64.03</span></span>
<span><span class="co">## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8, family = binomial(), </span></span>
<span><span class="co">##     data = df16_2)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">## -2.1727  -0.4719  -0.1409   0.5315   2.5914  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)   </span></span>
<span><span class="co">## (Intercept) -5.46026    2.07370  -2.633  0.00846 **</span></span>
<span><span class="co">## x12          0.85285    1.54399   0.552  0.58070   </span></span>
<span><span class="co">## x13          0.47754    1.59320   0.300  0.76438   </span></span>
<span><span class="co">## x14          3.44227    2.10985   1.632  0.10278   </span></span>
<span><span class="co">## x21          1.14905    0.93176   1.233  0.21750   </span></span>
<span><span class="co">## x31          1.66039    1.16857   1.421  0.15535   </span></span>
<span><span class="co">## x41          0.85994    1.32437   0.649  0.51613   </span></span>
<span><span class="co">## x51          0.73600    0.97088   0.758  0.44840   </span></span>
<span><span class="co">## x61          3.92067    1.57004   2.497  0.01252 * </span></span>
<span><span class="co">## x72         -0.03467    1.13363  -0.031  0.97560   </span></span>
<span><span class="co">## x73         -0.38230    1.61710  -0.236  0.81311   </span></span>
<span><span class="co">## x81          2.46322    1.10484   2.229  0.02578 * </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 74.786  on 53  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 40.028  on 42  degrees of freedom</span></span>
<span><span class="co">## AIC: 64.028</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 6</span></span>
<span></span>
<span><span class="co"># 向后</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span><span class="va">f</span>, direction <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span></span>
<span><span class="co">## Start:  AIC=64.03</span></span>
<span><span class="co">## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x7    2   40.086 60.086</span></span>
<span><span class="co">## - x1    3   43.933 61.933</span></span>
<span><span class="co">## - x4    1   40.466 62.466</span></span>
<span><span class="co">## - x5    1   40.605 62.605</span></span>
<span><span class="co">## - x2    1   41.600 63.600</span></span>
<span><span class="co">## &lt;none&gt;      40.028 64.028</span></span>
<span><span class="co">## - x3    1   42.196 64.196</span></span>
<span><span class="co">## - x8    1   46.365 68.365</span></span>
<span><span class="co">## - x6    1   50.469 72.469</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=60.09</span></span>
<span><span class="co">## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x1    3   44.541 58.541</span></span>
<span><span class="co">## - x5    1   40.611 58.611</span></span>
<span><span class="co">## - x4    1   40.814 58.814</span></span>
<span><span class="co">## - x2    1   41.616 59.616</span></span>
<span><span class="co">## &lt;none&gt;      40.086 60.086</span></span>
<span><span class="co">## - x3    1   42.747 60.747</span></span>
<span><span class="co">## - x8    1   47.255 65.255</span></span>
<span><span class="co">## - x6    1   51.415 69.415</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=58.54</span></span>
<span><span class="co">## y ~ x2 + x3 + x4 + x5 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x5    1   45.746 57.746</span></span>
<span><span class="co">## - x4    1   45.779 57.779</span></span>
<span><span class="co">## - x3    1   45.853 57.853</span></span>
<span><span class="co">## &lt;none&gt;      44.541 58.541</span></span>
<span><span class="co">## - x2    1   46.763 58.763</span></span>
<span><span class="co">## - x8    1   50.136 62.136</span></span>
<span><span class="co">## - x6    1   54.588 66.588</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=57.75</span></span>
<span><span class="co">## y ~ x2 + x3 + x4 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x4    1   47.537 57.537</span></span>
<span><span class="co">## &lt;none&gt;      45.746 57.746</span></span>
<span><span class="co">## - x2    1   48.470 58.470</span></span>
<span><span class="co">## - x3    1   49.083 59.083</span></span>
<span><span class="co">## - x8    1   51.976 61.976</span></span>
<span><span class="co">## - x6    1   56.634 66.634</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=57.54</span></span>
<span><span class="co">## y ~ x2 + x3 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## &lt;none&gt;      47.537 57.537</span></span>
<span><span class="co">## - x3    1   50.276 58.276</span></span>
<span><span class="co">## - x2    1   51.418 59.418</span></span>
<span><span class="co">## - x8    1   53.869 61.869</span></span>
<span><span class="co">## - x6    1   59.649 67.649</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ x2 + x3 + x6 + x8, family = binomial(), data = df16_2)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">## -2.2486  -0.7361  -0.3070   0.6264   1.9791  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.0314     0.8965  -3.381 0.000722 ***</span></span>
<span><span class="co">## x21           1.4715     0.7656   1.922 0.054617 .  </span></span>
<span><span class="co">## x31           1.2251     0.7543   1.624 0.104359    </span></span>
<span><span class="co">## x61           3.6124     1.3391   2.698 0.006985 ** </span></span>
<span><span class="co">## x81           1.8639     0.8045   2.317 0.020505 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 74.786  on 53  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 47.537  on 49  degrees of freedom</span></span>
<span><span class="co">## AIC: 57.537</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 5</span></span>
<span></span>
<span><span class="co"># 步进法</span></span>
<span><span class="va">f3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/step.html">step</a></span><span class="op">(</span><span class="va">f</span>, direction <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span></span>
<span><span class="co">## Start:  AIC=64.03</span></span>
<span><span class="co">## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x7    2   40.086 60.086</span></span>
<span><span class="co">## - x1    3   43.933 61.933</span></span>
<span><span class="co">## - x4    1   40.466 62.466</span></span>
<span><span class="co">## - x5    1   40.605 62.605</span></span>
<span><span class="co">## - x2    1   41.600 63.600</span></span>
<span><span class="co">## &lt;none&gt;      40.028 64.028</span></span>
<span><span class="co">## - x3    1   42.196 64.196</span></span>
<span><span class="co">## - x8    1   46.365 68.365</span></span>
<span><span class="co">## - x6    1   50.469 72.469</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=60.09</span></span>
<span><span class="co">## y ~ x1 + x2 + x3 + x4 + x5 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x1    3   44.541 58.541</span></span>
<span><span class="co">## - x5    1   40.611 58.611</span></span>
<span><span class="co">## - x4    1   40.814 58.814</span></span>
<span><span class="co">## - x2    1   41.616 59.616</span></span>
<span><span class="co">## &lt;none&gt;      40.086 60.086</span></span>
<span><span class="co">## - x3    1   42.747 60.747</span></span>
<span><span class="co">## + x7    2   40.028 64.028</span></span>
<span><span class="co">## - x8    1   47.255 65.255</span></span>
<span><span class="co">## - x6    1   51.415 69.415</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=58.54</span></span>
<span><span class="co">## y ~ x2 + x3 + x4 + x5 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x5    1   45.746 57.746</span></span>
<span><span class="co">## - x4    1   45.779 57.779</span></span>
<span><span class="co">## - x3    1   45.853 57.853</span></span>
<span><span class="co">## &lt;none&gt;      44.541 58.541</span></span>
<span><span class="co">## - x2    1   46.763 58.763</span></span>
<span><span class="co">## + x1    3   40.086 60.086</span></span>
<span><span class="co">## + x7    2   43.933 61.933</span></span>
<span><span class="co">## - x8    1   50.136 62.136</span></span>
<span><span class="co">## - x6    1   54.588 66.588</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=57.75</span></span>
<span><span class="co">## y ~ x2 + x3 + x4 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## - x4    1   47.537 57.537</span></span>
<span><span class="co">## &lt;none&gt;      45.746 57.746</span></span>
<span><span class="co">## - x2    1   48.470 58.470</span></span>
<span><span class="co">## + x5    1   44.541 58.541</span></span>
<span><span class="co">## + x1    3   40.611 58.611</span></span>
<span><span class="co">## - x3    1   49.083 59.083</span></span>
<span><span class="co">## + x7    2   44.697 60.697</span></span>
<span><span class="co">## - x8    1   51.976 61.976</span></span>
<span><span class="co">## - x6    1   56.634 66.634</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Step:  AIC=57.54</span></span>
<span><span class="co">## y ~ x2 + x3 + x6 + x8</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        Df Deviance    AIC</span></span>
<span><span class="co">## &lt;none&gt;      47.537 57.537</span></span>
<span><span class="co">## + x1    3   41.625 57.625</span></span>
<span><span class="co">## + x4    1   45.746 57.746</span></span>
<span><span class="co">## + x5    1   45.779 57.779</span></span>
<span><span class="co">## - x3    1   50.276 58.276</span></span>
<span><span class="co">## - x2    1   51.418 59.418</span></span>
<span><span class="co">## + x7    2   46.792 60.792</span></span>
<span><span class="co">## - x8    1   53.869 61.869</span></span>
<span><span class="co">## - x6    1   59.649 67.649</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">f3</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## glm(formula = y ~ x2 + x3 + x6 + x8, family = binomial(), data = df16_2)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Deviance Residuals: </span></span>
<span><span class="co">##     Min       1Q   Median       3Q      Max  </span></span>
<span><span class="co">## -2.2486  -0.7361  -0.3070   0.6264   1.9791  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">## (Intercept)  -3.0314     0.8965  -3.381 0.000722 ***</span></span>
<span><span class="co">## x21           1.4715     0.7656   1.922 0.054617 .  </span></span>
<span><span class="co">## x31           1.2251     0.7543   1.624 0.104359    </span></span>
<span><span class="co">## x61           3.6124     1.3391   2.698 0.006985 ** </span></span>
<span><span class="co">## x81           1.8639     0.8045   2.317 0.020505 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     Null deviance: 74.786  on 53  degrees of freedom</span></span>
<span><span class="co">## Residual deviance: 47.537  on 49  degrees of freedom</span></span>
<span><span class="co">## AIC: 57.537</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>按照步进法最终纳入的自变量是x2,x6,x8。</p>
</div>
<div id="多项逻辑回归" class="section level2" number="18.2">
<h2>
<span class="header-section-number">18.2</span> 多项逻辑回归<a class="anchor" aria-label="anchor" href="#%E5%A4%9A%E9%A1%B9%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><i class="fas fa-link"></i></a>
</h2>
<p>因变量是无序多分类资料（＞2）时，可使用多分类逻辑回归（multinomial logistic regression）。</p>
<p>使用课本<strong>例16-5</strong>的数据，课本电子版及数据已上传到QQ群，自行下载即可。</p>
<p>某研究人员欲了解不同社区和性别之间居民获取健康知识的途径是否相同，对2个社区的314名成人进行了调查，其中X1是社区，社区1用0表示，社区2用1表示；X2是性别，0是男，1是女，Y是获取健康知识途径，1是传统大众传媒，2是网络，3是社区宣传。</p>
<div class="sourceCode" id="cb305"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"datasets/例16-05.csv"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/headtail.html">headtail</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## Warning: headtail is deprecated.  Please use the headTail function</span></span>
<span><span class="co">##      X1  X2   Y</span></span>
<span><span class="co">## 1     0   0   1</span></span>
<span><span class="co">## 2     0   0   1</span></span>
<span><span class="co">## 3     0   0   1</span></span>
<span><span class="co">## 4     0   0   1</span></span>
<span><span class="co">## ... ... ... ...</span></span>
<span><span class="co">## 311   1   1   3</span></span>
<span><span class="co">## 312   1   1   3</span></span>
<span><span class="co">## 313   1   1   3</span></span>
<span><span class="co">## 314   1   1   3</span></span></code></pre></div>
<p>首先变为因子型，无需多分类的logistic回归需要对因变量设置参考，我们这里直接用<code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>函数变为因子，这样在进行无序多分类的logistic时默认是以第一个为参考。也可以使用<code><a href="https://rdrr.io/r/stats/relevel.html">relevel()</a></code>重新设置参考。</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X1</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"社区1"</span>,<span class="st">"社区2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X2</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"男"</span>,<span class="st">"女"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 因变量设置参考，这里选择第1个（传统大众传媒）为参考</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Y</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"传统大众传媒"</span>,<span class="st">"网络"</span>,<span class="st">"社区宣传"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    314 obs. of  3 variables:</span></span>
<span><span class="co">##  $ X1: Factor w/ 2 levels "社区1","社区2": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ X2: Factor w/ 2 levels "男","女": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Y : Factor w/ 3 levels "传统大众传媒",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>使用<code><a href="https://rdrr.io/pkg/nnet/man/multinom.html">nnet::multinom</a></code>进行无序多分类的logistic回归：</p>
<div class="sourceCode" id="cb307"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## # weights:  12 (6 variable)</span></span>
<span><span class="co">## initial  value 344.964259 </span></span>
<span><span class="co">## iter  10 value 316.575399</span></span>
<span><span class="co">## iter  10 value 316.575399</span></span>
<span><span class="co">## iter  10 value 316.575399</span></span>
<span><span class="co">## final  value 316.575399 </span></span>
<span><span class="co">## converged</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## multinom(formula = Y ~ X1 + X2, data = df, model = T)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##          (Intercept)    X1社区2      X2女</span></span>
<span><span class="co">## 网络       0.5484998 -1.3743147 0.4321069</span></span>
<span><span class="co">## 社区宣传   0.3940422 -0.9933526 1.2266459</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Std. Errors:</span></span>
<span><span class="co">##          (Intercept)   X1社区2      X2女</span></span>
<span><span class="co">## 网络       0.2583299 0.3201514 0.3265384</span></span>
<span><span class="co">## 社区宣传   0.2574175 0.2952083 0.2991714</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual Deviance: 633.1508 </span></span>
<span><span class="co">## AIC: 645.1508</span></span></code></pre></div>
<p>可以看到结果比二项逻辑回归的结果简洁多了，少了很多信息，只给出了<code>Coefficients/Std. Errors/Residual Deviance/AIC</code>。</p>
<p>不过也是两个模型的结果，分别是 <em>社区宣传 和 传统大众传媒</em> 比，<em>网络 和 传统大众传媒</em> 比。</p>
<p>自变量的Z值（wald Z, Z-score）和P值需要手动计算:</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z_stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">standard.errors</span></span>
<span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z_stats</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span>
<span></span>
<span><span class="va">p_values</span></span>
<span><span class="co">##          (Intercept)      X1社区2         X2女</span></span>
<span><span class="co">## 网络      0.03373263 1.765117e-05 1.857371e-01</span></span>
<span><span class="co">## 社区宣传  0.12583082 7.656564e-04 4.128929e-05</span></span></code></pre></div>
<p>但其实可以调包解决：</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">## # A tibble: 6 × 6</span></span>
<span><span class="co">##   y.level  term        estimate std.error statistic   p.value</span></span>
<span><span class="co">##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">## 1 网络     (Intercept)    0.548     0.258      2.12 0.0337   </span></span>
<span><span class="co">## 2 网络     X1社区2       -1.37      0.320     -4.29 0.0000177</span></span>
<span><span class="co">## 3 网络     X2女           0.432     0.327      1.32 0.186    </span></span>
<span><span class="co">## 4 社区宣传 (Intercept)    0.394     0.257      1.53 0.126    </span></span>
<span><span class="co">## 5 社区宣传 X1社区2       -0.993     0.295     -3.36 0.000766 </span></span>
<span><span class="co">## 6 社区宣传 X2女           1.23      0.299      4.10 0.0000413</span></span></code></pre></div>
<p>OR值及其95%的可信区间也没有给出来，需要手动计算OR值和可信区间：</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 计算OR值</span></span>
<span><span class="va">OR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">OR</span></span>
<span><span class="co">##          (Intercept)   X1社区2     X2女</span></span>
<span><span class="co">## 网络        1.730655 0.2530129 1.540500</span></span>
<span><span class="co">## 社区宣传    1.482963 0.3703330 3.409774</span></span>
<span></span>
<span><span class="co"># 计算OR值的95%的可信区间</span></span>
<span><span class="va">OR.confi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">OR.confi</span></span>
<span><span class="co">## , , 网络</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 2.5 %    97.5 %</span></span>
<span><span class="co">## (Intercept) 1.0430848 2.8714501</span></span>
<span><span class="co">## X1社区2     0.1350919 0.4738666</span></span>
<span><span class="co">## X2女        0.8122910 2.9215386</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## , , 社区宣传</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##                 2.5 %    97.5 %</span></span>
<span><span class="co">## (Intercept) 0.8953982 2.4560912</span></span>
<span><span class="co">## X1社区2     0.2076398 0.6605021</span></span>
<span><span class="co">## X2女        1.8970133 6.1288742</span></span></code></pre></div>
<p>模型整体的假设检验：</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 先构建一个只有截距的模型</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>, model <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">## # weights:  6 (2 variable)</span></span>
<span><span class="co">## initial  value 344.964259 </span></span>
<span><span class="co">## final  value 338.603448 </span></span>
<span><span class="co">## converged</span></span>
<span></span>
<span><span class="co"># 两个模型比较,Likelihood ratio tests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio tests of Multinomial Models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: Y</span></span>
<span><span class="co">##     Model Resid. df Resid. Dev   Test    Df LR stat.      Pr(Chi)</span></span>
<span><span class="co">## 1       1       626   677.2069                                   </span></span>
<span><span class="co">## 2 X1 + X2       622   633.1508 1 vs 2     4  44.0561 6.245931e-09</span></span></code></pre></div>
<p>P&lt;0.001，模型具有统计学意义。</p>
<p>获取模型预测的类别：</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">df</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">## [1] 网络 网络 网络 网络 网络 网络</span></span>
<span><span class="co">## Levels: 传统大众传媒 网络 社区宣传</span></span></code></pre></div>
<p>获取模型预测的概率：</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">df</span>, type <span class="op">=</span> <span class="st">"probs"</span><span class="op">)</span> <span class="co"># 或者使用 fitted(fit)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">##   传统大众传媒      网络  社区宣传</span></span>
<span><span class="co">## 1    0.2373257 0.4107289 0.3519453</span></span>
<span><span class="co">## 2    0.2373257 0.4107289 0.3519453</span></span>
<span><span class="co">## 3    0.2373257 0.4107289 0.3519453</span></span>
<span><span class="co">## 4    0.2373257 0.4107289 0.3519453</span></span>
<span><span class="co">## 5    0.2373257 0.4107289 0.3519453</span></span>
<span><span class="co">## 6    0.2373257 0.4107289 0.3519453</span></span></code></pre></div>
<p>模型拟合优度的检验，这里使用卡方检验：</p>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Y</span>, <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  df$Y and pred</span></span>
<span><span class="co">## X-squared = 39.521, df = 4, p-value = 5.436e-08</span></span></code></pre></div>
<p>计算伪R^2：</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/PseudoR2.html">PseudoR2</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">##        McFadden     McFaddenAdj        CoxSnell      Nagelkerke   AldrichNelson </span></span>
<span><span class="co">##      0.06505559      0.04733575      0.13090778      0.14803636              NA </span></span>
<span><span class="co">## VeallZimmermann           Efron McKelveyZavoina            Tjur             AIC </span></span>
<span><span class="co">##              NA              NA              NA              NA    645.15079819 </span></span>
<span><span class="co">##             BIC          logLik         logLik0              G2 </span></span>
<span><span class="co">##    667.64715610   -316.57539909   -338.60344772     44.05609725</span></span></code></pre></div>
<p>不仅给出了伪R^2，还给出了超多的值，每一项的意义可以参考下面这张图：</p>
<div class="inline-figure"><img src="figs/Snipaste_2023-04-05_16-05-01.png" width="90%"></div>
<p>结果解读可以参考二项逻辑回归。</p>
</div>
<div id="有序逻辑回归" class="section level2" number="18.3">
<h2>
<span class="header-section-number">18.3</span> 有序逻辑回归<a class="anchor" aria-label="anchor" href="#%E6%9C%89%E5%BA%8F%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><i class="fas fa-link"></i></a>
</h2>
<p>ordinal logistic regression适用于因变量为等级资料。使用课本<strong>例16-4</strong>的数据。</p>
<p>随机选取84例患者做临床试验，探讨性别和治疗方法对该病的影响。变量赋值为：性别（X1，男=0，女=1），治疗方法（X2，传统疗法=0，新型疗法=1），疗效（Y，无效=1，有效=2，痊愈=3）。</p>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">"datasets/例16-04.csv"</span>,header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/headtail.html">headtail</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## Warning: headtail is deprecated.  Please use the headTail function</span></span>
<span><span class="co">##      X1  X2   Y</span></span>
<span><span class="co">## 1     0   0   1</span></span>
<span><span class="co">## 2     0   0   1</span></span>
<span><span class="co">## 3     0   0   1</span></span>
<span><span class="co">## 4     0   0   1</span></span>
<span><span class="co">## ... ... ... ...</span></span>
<span><span class="co">## 81    1   1   3</span></span>
<span><span class="co">## 82    1   1   3</span></span>
<span><span class="co">## 83    1   1   3</span></span>
<span><span class="co">## 84    1   1   3</span></span></code></pre></div>
<p>变为因子型：</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 因变量变为有序因子</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Y</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>               labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"无效"</span>,<span class="st">"有效"</span>,<span class="st">"痊愈"</span><span class="op">)</span>,</span>
<span>               ordered <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 自变量变为无序因子</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X1</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"男"</span>,<span class="st">"女"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">X2</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"传统疗法"</span>,<span class="st">"新型疗法"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    84 obs. of  3 variables:</span></span>
<span><span class="co">##  $ X1: Factor w/ 2 levels "男","女": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ X2: Factor w/ 2 levels "传统疗法","新型疗法": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ Y : Ord.factor w/ 3 levels "无效"&lt;"有效"&lt;..: 1 1 1 1 1 1 1 1 1 1 ...</span></span></code></pre></div>
<p>使用<code><a href="https://rdrr.io/pkg/MASS/man/polr.html">MASS::polr</a></code>拟合有序逻辑回归：</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">df</span>,Hess <span class="op">=</span> <span class="cn">TRUE</span>,method <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## polr(formula = Y ~ X1 + X2, data = df, Hess = TRUE, method = "logistic")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##            Value Std. Error t value</span></span>
<span><span class="co">## X1女       1.319     0.5381   2.451</span></span>
<span><span class="co">## X2新型疗法 1.797     0.4718   3.809</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Intercepts:</span></span>
<span><span class="co">##           Value  Std. Error t value</span></span>
<span><span class="co">## 无效|有效 1.8128 0.5654     3.2061 </span></span>
<span><span class="co">## 有效|痊愈 2.6672 0.6065     4.3979 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual Deviance: 150.0294 </span></span>
<span><span class="co">## AIC: 158.0294</span></span></code></pre></div>
<p>结果也是没有给出P值，手动计算P值：</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="st">"t value"</span><span class="op">]</span><span class="op">)</span>,lower.tail <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">*</span><span class="fl">2</span></span>
<span><span class="va">p</span></span>
<span><span class="co">##         X1女   X2新型疗法    无效|有效    有效|痊愈 </span></span>
<span><span class="co">## 1.425572e-02 1.392807e-04 1.345300e-03 1.092866e-05</span></span></code></pre></div>
<p>这次<code>broom::tidy(fit)</code>并没有直接给出P值：</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 4 × 5</span></span>
<span><span class="co">##   term       estimate std.error statistic coef.type  </span></span>
<span><span class="co">##   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;      </span></span>
<span><span class="co">## 1 X1女           1.32     0.538      2.45 coefficient</span></span>
<span><span class="co">## 2 X2新型疗法     1.80     0.472      3.81 coefficient</span></span>
<span><span class="co">## 3 无效|有效      1.81     0.565      3.21 scale      </span></span>
<span><span class="co">## 4 有效|痊愈      2.67     0.606      4.40 scale</span></span></code></pre></div>
<p>OR值：</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">OR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">OR</span></span>
<span><span class="co">##       X1女 X2新型疗法 </span></span>
<span><span class="co">##   3.738765   6.033338</span></span></code></pre></div>
<p>平行线检验(Brant-Wald test)：</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">brant</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brant/man/brant.html">brant</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## -------------------------------------------- </span></span>
<span><span class="co">## Test for X2  df  probability </span></span>
<span><span class="co">## -------------------------------------------- </span></span>
<span><span class="co">## Omnibus      1.83    2   0.4</span></span>
<span><span class="co">## X1女      1.59    1   0.21</span></span>
<span><span class="co">## X2新型疗法       0.01    1   0.94</span></span>
<span><span class="co">## -------------------------------------------- </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## H0: Parallel Regression Assumption holds</span></span>
<span><span class="co">## Warning in brant::brant(fit): 1 combinations in table(dv,ivs) do not occur.</span></span>
<span><span class="co">## Because of that, the test results might be invalid.</span></span></code></pre></div>
<p>P值&gt;0.05，平行线检验通过，可以使用有序逻辑回归。</p>
<p>模型整体的显著性检验：</p>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 先构建一个只有截距的模型</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/polr.html">polr</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">df</span>,Hess <span class="op">=</span> <span class="cn">TRUE</span>,method <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 两个模型比较</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">fit0</span>, <span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## Likelihood ratio tests of ordinal regression models</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Response: Y</span></span>
<span><span class="co">##     Model Resid. df Resid. Dev   Test    Df LR stat.     Pr(Chi)</span></span>
<span><span class="co">## 1       1        82   169.9159                                  </span></span>
<span><span class="co">## 2 X1 + X2        80   150.0294 1 vs 2     2  19.8865 4.80508e-05</span></span></code></pre></div>
<p>P值＜0.01，模型是有意义的。</p>
<p>获取模型预测的类别：</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">df</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">## [1] 无效 无效 无效 无效 无效 无效</span></span>
<span><span class="co">## Levels: 无效 有效 痊愈</span></span></code></pre></div>
<p>获取模型预测的概率：</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">df</span>, type <span class="op">=</span> <span class="st">"probs"</span><span class="op">)</span> <span class="co"># 或者使用 fitted(fit)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">prob</span><span class="op">)</span></span>
<span><span class="co">##        无效       有效       痊愈</span></span>
<span><span class="co">## 1 0.8597003 0.07536263 0.06493706</span></span>
<span><span class="co">## 2 0.8597003 0.07536263 0.06493706</span></span>
<span><span class="co">## 3 0.8597003 0.07536263 0.06493706</span></span>
<span><span class="co">## 4 0.8597003 0.07536263 0.06493706</span></span>
<span><span class="co">## 5 0.8597003 0.07536263 0.06493706</span></span>
<span><span class="co">## 6 0.8597003 0.07536263 0.06493706</span></span></code></pre></div>
<p>模型拟合优度的检验，这里使用卡方检验：</p>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Y</span>, <span class="va">pred</span><span class="op">)</span></span>
<span><span class="co">## Warning in chisq.test(df$Y, pred): Chi-squared approximation may be incorrect</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##  Pearson's Chi-squared test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  df$Y and pred</span></span>
<span><span class="co">## X-squared = 14.246, df = 2, p-value = 0.0008065</span></span></code></pre></div>
<p>计算伪R2：</p>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DescTools</span><span class="fu">::</span><span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/PseudoR2.html">PseudoR2</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span>
<span><span class="co">##        McFadden        CoxSnell      Nagelkerke   AldrichNelson VeallZimmermann </span></span>
<span><span class="co">##       0.1170373       0.2108068       0.2429443              NA              NA </span></span>
<span><span class="co">##           Efron McKelveyZavoina            Tjur             AIC             BIC </span></span>
<span><span class="co">##              NA              NA              NA     158.0294131     167.7526803 </span></span>
<span><span class="co">##          logLik         logLik0              G2 </span></span>
<span><span class="co">##     -75.0147065     -84.9579583      19.8865036</span></span></code></pre></div>
</div>
<div id="条件逻辑回归" class="section level2" number="18.4">
<h2>
<span class="header-section-number">18.4</span> 条件逻辑回归<a class="anchor" aria-label="anchor" href="#%E6%9D%A1%E4%BB%B6%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><i class="fas fa-link"></i></a>
</h2>
<p>conditional logistic regression是针对配对数据资料分析的一种方法。在一些病例-对照研究中，把病例和对照按照年龄、性别等进行配对，形成多个匹配组，各匹配组的病例数和对照数是任意的，并不是1个对1个，常用的是每组中有一个病例和多个对照，即1：M配对研究。</p>
<p>使用课本<strong>例16-3</strong>的数据。某北方城市研究喉癌发病的危险因素，用1:2配对研究，现选取了6个可能的危险因素并记录了25对数据，试做条件logistic回归。</p>
<div class="inline-figure"><img src="figs/Snipaste_2023-04-05_16-07-01.png" width="90%"></div>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">foreign</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreign/man/read.spss.html">read.spss</a></span><span class="op">(</span><span class="st">"datasets/例16-03.sav"</span>,to.data.frame <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/psych/man/headtail.html">headtail</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## Warning: headtail is deprecated.  Please use the headTail function</span></span>
<span><span class="co">##       i   y  x1  x2  x3  x4  x5  x6</span></span>
<span><span class="co">## 1     1   1   3   5   1   1   1   0</span></span>
<span><span class="co">## 2     1   0   1   1   1   3   3   0</span></span>
<span><span class="co">## 3     1   0   1   1   1   3   3   0</span></span>
<span><span class="co">## 4     2   1   1   3   1   1   3   0</span></span>
<span><span class="co">## ... ... ... ... ... ... ... ... ...</span></span>
<span><span class="co">## 72   24   0   1   1   2   3   2   0</span></span>
<span><span class="co">## 73   25   1   1   4   1   1   1   1</span></span>
<span><span class="co">## 74   25   0   1   1   1   3   2   0</span></span>
<span><span class="co">## 75   25   0   1   1   1   3   3   0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">## 'data.frame':    75 obs. of  8 variables:</span></span>
<span><span class="co">##  $ i : num  1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span><span class="co">##  $ y : num  1 0 0 1 0 0 1 0 0 1 ...</span></span>
<span><span class="co">##  $ x1: num  3 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x2: num  5 1 1 3 1 2 4 5 4 4 ...</span></span>
<span><span class="co">##  $ x3: num  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">##  $ x4: num  1 3 3 1 3 3 3 3 3 2 ...</span></span>
<span><span class="co">##  $ x5: num  1 3 3 3 2 2 2 2 2 1 ...</span></span>
<span><span class="co">##  $ x6: num  0 0 0 0 0 0 0 0 0 1 ...</span></span></code></pre></div>
<p><code>i</code>是配对的对子数。</p>
<p>不需要变成因子型。</p>
<p>使用<code><a href="https://rdrr.io/pkg/survival/man/clogit.html">survival::clogit</a></code>进行条件逻辑回归：</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/clogit.html">clogit</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span><span class="op">+</span><span class="va">x2</span><span class="op">+</span><span class="va">x3</span><span class="op">+</span><span class="va">x4</span><span class="op">+</span><span class="va">x5</span><span class="op">+</span><span class="va">x6</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/strata.html">strata</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span>, method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## coxph(formula = Surv(rep(1, 75L), y) ~ x1 + x2 + x3 + x4 + x5 + </span></span>
<span><span class="co">##     x6 + strata(i), data = df, method = "exact")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   n= 75, number of events= 25 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##        coef exp(coef) se(coef)      z Pr(&gt;|z|)  </span></span>
<span><span class="co">## x1  2.58880  13.31380  2.50172  1.035   0.3008  </span></span>
<span><span class="co">## x2  1.68796   5.40843  0.68545  2.463   0.0138 *</span></span>
<span><span class="co">## x3  2.31944  10.16995  1.26096  1.839   0.0659 .</span></span>
<span><span class="co">## x4 -3.88886   0.02047  1.90656 -2.040   0.0414 *</span></span>
<span><span class="co">## x5 -0.49102   0.61200  1.19020 -0.413   0.6799  </span></span>
<span><span class="co">## x6  3.50899  33.41447  2.13723  1.642   0.1006  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span><span class="co">## x1  13.31380    0.07511 0.0988170 1793.7921</span></span>
<span><span class="co">## x2   5.40843    0.18490 1.4112830   20.7266</span></span>
<span><span class="co">## x3  10.16995    0.09833 0.8589963  120.4056</span></span>
<span><span class="co">## x4   0.02047   48.85506 0.0004878    0.8589</span></span>
<span><span class="co">## x5   0.61200    1.63399 0.0593818    6.3074</span></span>
<span><span class="co">## x6  33.41447    0.02993 0.5066653 2203.6771</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Concordance= 0.91  (se = 0.064 )</span></span>
<span><span class="co">## Likelihood ratio test= 42.21  on 6 df,   p=2e-07</span></span>
<span><span class="co">## Wald test            = 7.71  on 6 df,   p=0.3</span></span>
<span><span class="co">## Score (logrank) test = 29.13  on 6 df,   p=6e-05</span></span></code></pre></div>
<p>结果非常齐全，β值，OR值，P值等信息都有了。</p>
</div>
<div id="参考资料" class="section level2" number="18.5">
<h2>
<span class="header-section-number">18.5</span> 参考资料<a class="anchor" aria-label="anchor" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="https://blog.csdn.net/weixin_41744624/article/details/105506951" class="uri">https://blog.csdn.net/weixin_41744624/article/details/105506951</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/113403422" class="uri">https://zhuanlan.zhihu.com/p/113403422</a></li>
<li><a href="https://duanku.pai-hang-bang.cn/kuzi_1046977453210716059" class="uri">https://duanku.pai-hang-bang.cn/kuzi_1046977453210716059</a></li>
<li><a href="https://bookdown.org/chua/ber642_advanced_regression/" class="uri">https://bookdown.org/chua/ber642_advanced_regression/</a></li>
<li><a href="https://peopleanalytics-regression-book.org/" class="uri">https://peopleanalytics-regression-book.org/</a></li>
</ol>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="raljflksdj.html"><span class="header-section-number">17</span> 多元线性回归</a></div>
<div class="next"><a href="tuishgh.html"><span class="header-section-number">19</span> 分类变量进行回归分析时的编码方案</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#rlkdfjj"><span class="header-section-number">18</span> Logistic回归</a></li>
<li><a class="nav-link" href="#%E4%BA%8C%E9%A1%B9logistic%E5%9B%9E%E5%BD%92"><span class="header-section-number">18.1</span> 二项logistic回归</a></li>
<li><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="header-section-number">18.2</span> 多项逻辑回归</a></li>
<li><a class="nav-link" href="#%E6%9C%89%E5%BA%8F%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="header-section-number">18.3</span> 有序逻辑回归</a></li>
<li><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="header-section-number">18.4</span> 条件逻辑回归</a></li>
<li><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="header-section-number">18.5</span> 参考资料</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/ayueme/ayueme.github.io/blob/main/1018-logistic.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/ayueme/ayueme.github.io/edit/main/1018-logistic.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>R语言实战医学统计</strong>" was written by 阿越就是我. It was last built on 2023-09-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
